This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2025-05-14T03:46:51.883Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

================================================================
Directory Structure
================================================================
docs/
  fe-prd.txt
  overview.md
public/
  vite.svg
src/
  components/
    home/
      hero.tsx
    shared/
      container.tsx
      navbar.tsx
    ui/
      accordion.tsx
      alert-dialog.tsx
      alert.tsx
      aspect-ratio.tsx
      avatar.tsx
      badge.tsx
      breadcrumb.tsx
      button.tsx
      calendar.tsx
      card.tsx
      carousel.tsx
      chart.tsx
      checkbox.tsx
      collapsible.tsx
      combo-box.tsx
      command.tsx
      context-menu.tsx
      date-picker.tsx
      dialog.tsx
      drawer.tsx
      dropdown-menu.tsx
      dropzone.test.tsx
      dropzone.tsx
      form.tsx
      hover-card.tsx
      input-otp.tsx
      input.tsx
      label.tsx
      menubar.tsx
      navigation-menu.tsx
      pagination.tsx
      popover.tsx
      progress-steps.tsx
      progress.tsx
      radio-group.tsx
      resizable.tsx
      scroll-area.tsx
      select.tsx
      separator.tsx
      sheet.tsx
      sidebar.tsx
      skeleton.tsx
      slider.tsx
      sonner.tsx
      switch.tsx
      table.tsx
      tabs.tsx
      textarea.tsx
      toast.tsx
      toaster.tsx
      toggle-group.tsx
      toggle.tsx
      tooltip.tsx
      use-toast.tsx
    video/
      content-editor.tsx
      processing-dashboard.tsx
      processing-steps.ts
      thumbnail-gallery.tsx
      title-selector.tsx
      video-detail.tsx
      video-progress-card.tsx
    auth.tsx
    default-catch-boundary.tsx
    login.tsx
    not-found.tsx
    post-error.tsx
    user-error.tsx
  hooks/
    use-mobile.ts
    useMutation.ts
  lib/
    utils.ts
  routes/
    _authed/
      posts.$postId.tsx
      posts.index.tsx
      posts.tsx
    _pathlessLayout/
      _nested-layout/
        route-a.tsx
        route-b.tsx
      _nested-layout.tsx
    api/
      users.$id.ts
      users.ts
    __root.tsx
    _authed.tsx
    _pathlessLayout.tsx
    dashboard.tsx
    deferred.tsx
    index.tsx
    login.tsx
    logout.tsx
    redirect.tsx
    settings.tsx
    signup.tsx
    users.route.tsx
    video.$videoId.tsx
  services/
    gcs-content.ts
  styles/
    app.css
  utils/
    loggingMiddleware.ts
    posts.tsx
    seo.ts
    supabase.ts
    users.tsx
  api.ts
  client.tsx
  global-middleware.ts
  router.tsx
  routeTree.gen.ts
  ssr.tsx
web-memory-bank/
  examples/
    posts_.$postId.deep.tsx
    posts.$postId.tsx
    posts.index.tsx
    posts.route.tsx
    users.$userId.tsx
    users.index.tsx
  active-context.md
  error-handling.md
  file-trees.md
  overview.md
  prd.txt
  product-context.md
  progress.md
  project-brief.md
  system-patterns.md
  tasks.md
  tech-context.md
  websocket-messages.md
.gitignore
biome.json
components.json
Dockerfile
firebase.ts
package.json
postcss.config.mjs
README.md
tsconfig.json
vite.config.ts
vitest.config.ts

================================================================
Files
================================================================

================
File: docs/fe-prd.txt
================
# FRONTEND - PRODUCT REQUIREMENTS DOCUMENT (PRD)

## 1. Overview

This Product Requirements Document (PRD) outlines the specifications for the frontend application of the Video Processing Pipeline system. The frontend provides users (Content Creators, Administrators) with an interface to upload videos, monitor processing progress in real-time, review and edit AI-generated metadata, and manage the overall system. This document focuses on the core requirements for the application, which uses FastAPI WebSockets for real-time integration.

## 2. Project Goals

### 2.1 Primary Goals

-   Provide an intuitive user interface for interacting with the video processing pipeline.
-   Display real-time updates on video processing status using WebSockets.
-   Allow users to review and edit generated video metadata before publishing.
-   Integrate seamlessly with the backend FastAPI API.
-   Utilize FastAPI WebSocket connections for real-time features.
-   Maintain a responsive and modern user experience using React, TanStack Router, and shadcn/ui.
-   Ensure secure communication with the backend API, including authentication.

### 2.2 Success Metrics

-   Real-time status updates appear promptly after backend events.
-   Fast latency for typical API interactions.
-   High user satisfaction with the interface usability.
-   Successful implementation of WebSocket-based real-time features.
-   Successful integration with backend authentication (REQ-API-004).
-   No data inconsistencies related to real-time updates.

## 3. Frontend Architecture

The frontend is built using:

-   **Framework:** React (with Vite)
-   **Routing:** TanStack Router
-   **UI Components:** shadcn/ui & custom components
-   **API Communication:** Custom API client wrapper
-   **Real-time:** FastAPI WebSockets (Migration in progress from legacy Firebase)
-   **State Management:** To be determined/refined (e.g., Zustand, Jotai, TanStack Query)

## 4. Proposed Frontend Architecture Features

-   **Real-time Communication:**
    -   Establish a WebSocket connection to the backend FastAPI server upon user authentication.
    -   Subscribe to relevant topics/events for video processing jobs.
    -   Handle incoming WebSocket messages to update UI state.
    -   Implement robust connection management (reconnection logic).
-   **API Communication:**
    -   Utilize the API client for standard RESTful calls (uploading, fetching initial data, submitting edits).
    -   Integrate with backend JWT-based authentication.
-   **State Management:**
    -   Employ a suitable state management solution to handle asynchronous data (API & WebSocket) and synchronize UI state.

## 5. Key Features & Requirements

### 5.1 Core User Interface

**REQ-FE-001: Video Upload Interface**
-   Allow users to select and upload video files.
-   Provide feedback on upload progress.
-   Trigger backend processing via API call upon successful upload.

**REQ-FE-002: Processing Dashboard**
-   Display a list/grid of video processing jobs.
-   Show key information: thumbnail (if available), title, status, timestamp.
-   Update job statuses in real-time via WebSocket connection.
-   Allow navigation to individual video detail pages.

**REQ-FE-003: Video Detail View**
-   Display detailed information for a specific video processing job.
-   Show processing stages and their real-time status (pending, processing, completed, failed) via WebSockets.
-   Display generated metadata (transcript, title suggestions, etc.) as available.
-   Provide an interface for editing metadata (REQ-FE-004).

**REQ-FE-004: Metadata Editor**
-   Allow users to review and edit AI-generated metadata (title, description, tags).
-   Provide an interface to view/copy transcripts/subtitles.
-   Allow selection of the final thumbnail.
-   Save changes via API calls to the backend.

**REQ-FE-005: Real-time Updates**
-   Establish WebSocket connection upon login/load.
-   Receive and process real-time updates for job status and generated metadata.
-   Update relevant UI components without page reloads.
-   Handle connection errors and implement reconnection logic.

**REQ-FE-006: Authentication Interface**
-   Provide login/signup forms.
-   Handle authentication flow using backend API endpoints (REQ-API-004).
-   Manage user session (e.g., storing JWT tokens).
-   Protect authenticated routes.

### 5.2 Technical Requirements

**REQ-FE-TECH-001: WebSocket Integration**
-   Implement a robust WebSocket client service/hook.
-   Manage connection lifecycle (connect, disconnect, reconnect).
-   Handle message serialization/deserialization.
-   Subscribe/unsubscribe to relevant job updates.

**REQ-FE-TECH-002: Firebase Removal**
-   Identify and refactor components using legacy Firebase listeners.
-   Remove Firebase dependencies completely.

**REQ-FE-TECH-003: API Client Enhancement**
-   Update the API client to handle backend authentication (sending JWT tokens).
-   Ensure proper error handling.

**REQ-FE-TECH-004: State Management for Real-time Data**
-   Implement/refine a state management solution for real-time updates and API data synchronization.

**REQ-FE-TECH-005: Responsive Design**
-   Ensure the UI is responsive across major screen sizes.

**REQ-FE-TECH-006: Testing**
-   Implement unit, integration, and end-to-end tests covering core functionality, API interactions, and WebSocket updates.

## 6. User Stories (Frontend Focus)

*(Corresponds to backend User Stories where applicable)*

**US-FE-001: Video Upload** (Refines US-001)
-   As a content creator, I want a simple interface to upload my videos to start the processing workflow.
-   *Acceptance criteria:* UI allows file selection/drop; upload progress shown; notification on success.

**US-FE-002: Real-time Status Tracking** (Refines US-002)
-   As a content creator, I want to see the status of my video update automatically without refreshing.
-   *Acceptance criteria:* Status indicators change in real-time via WebSockets; progress reflects completed stages.

**US-FE-003: Metadata Review Interface** (Refines US-003)
-   As a content creator, I want a clear interface to review all generated metadata.
-   *Acceptance criteria:* Separate sections for metadata types; easy navigation; efficient data loading.

**US-FE-004: Metadata Editing Interface** (Refines US-003)
-   As a content creator, I want intuitive tools to modify generated metadata.
-   *Acceptance criteria:* Standard editing inputs; save triggers API call; feedback on save/error.

**US-FE-005: Publishing Trigger** (Refines US-004)
-   As a content creator, I want a "Publish" button to easily send the final video and metadata.
-   *Acceptance criteria:* Button enabled when processing complete; click triggers backend publishing API; UI feedback provided.

## 7. Migration Plan (Frontend)

A migration from Firebase real-time features to FastAPI WebSockets is currently underway. Detailed steps are outlined in `frontend/docs/fe-implementation-tasks.md`. The core process involves:
1.  Implementing a WebSocket client.
2.  Refactoring components to use WebSockets and the backend API instead of Firebase.
3.  Enhancing API client for authentication.
4.  Thorough testing.
5.  Removing Firebase dependencies.

## 8. Risks and Mitigations (Frontend)

**Risk: WebSocket Scalability/Reliability**
-   *Mitigation:* Robust client-side reconnection logic; scalable backend implementation; consider API polling fallback.

**Risk: State Management Complexity**
-   *Mitigation:* Choose appropriate library; careful state design; thorough testing.

**Risk: Backend API Changes**
-   *Mitigation:* Clear API contracts/versioning; integration tests.

**Risk: Cross-Browser WebSocket Issues**
-   *Mitigation:* Cross-browser testing; use standard APIs/compatible libraries.

================
File: docs/overview.md
================
# Frontend Overview

This document provides a high-level overview of the frontend application for the Video Processing Pipeline project.

## Purpose

The frontend serves as the user interface for content creators and administrators to:
*   Upload video files for processing.
*   Monitor the real-time progress of video analysis and metadata generation.
*   Review, edit, and approve AI-generated metadata (titles, descriptions, tags, transcripts, chapters).
*   Trigger the final publishing process (e.g., to YouTube).

## Technology Stack

*   **Framework:** React (using Vite for development and build)
*   **Language:** TypeScript
*   **Routing:** TanStack Router
*   **UI Components:** shadcn/ui library, supplemented with custom components.
*   **API Communication:** A custom client wrapper (`src/api.ts`) interacts with the backend FastAPI.
*   **Real-time:** FastAPI WebSockets (currently migrating away from a legacy Firebase implementation).
*   **State Management:** To be defined/implemented (potential candidates: Zustand, Jotai, TanStack Query).
*   **Package Management:** PNPM

## Project Structure Highlights

*   `src/`: Contains all source code.
    *   `components/`: Reusable React components, including UI elements (`ui/`) and feature-specific components (`video/`, `home/`, `shared/`).
    *   `routes/`: Defines application routes using TanStack Router's file-based routing convention. Includes authentication layout (`_authed/`) and placeholder routes.
    *   `lib/`: Utility functions (`utils.ts`).
    *   `hooks/`: Custom React hooks.
    *   `services/`: Potential location for business logic services (e.g., WebSocket client, GCS interactions).
    *   `api.ts`: Wrapper for making backend API calls.
    *   `router.tsx`: TanStack Router setup.
    *   `client.tsx`/`ssr.tsx`: Application entry points for client/server.
*   `public/`: Static assets.
*   `docs/`: Project documentation, including this overview, PRD (`fe-prd.txt`), and implementation tasks (`fe-implementation-tasks.md`).
*   `firebase.ts`: Legacy Firebase configuration (to be removed).

## Current Status

The frontend is undergoing a migration from Firebase-based real-time updates to a FastAPI WebSocket architecture, integrating with a new backend API. Many core components and routes exist, but some are placeholders or require refactoring to align with the new architecture as detailed in `fe-implementation-tasks.md`.

================
File: public/vite.svg
================
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>

================
File: src/components/home/hero.tsx
================
import Container from "../shared/container";
import {
	Tabs,
	TabsContent,
	TabsList,
	TabsTrigger,
} from "../ui/tabs";

// Props interface currently empty, update if needed for future enhancements.
type Props = {};

export default function Hero({}: Props) {
	return (
		<Container spacer={true}>
			{/* Main container using flexbox for vertical stacking */}
			<div className="flex flex-col items-center text-center py-16">
				{/* Title Section */}
				<div className="flex items-center justify-center bg-[var(--accent-blue)] text-white h-24 w-24 rounded-full mb-6">
					<span className="text-2xl font-bold">VIDEO</span>
				</div>

				{/* Main Heading */}
				<h1 className="text-7xl text-[var(--accent-blue)] lg:text-6xl md:text-5xl sm:text-4xl">
					VIDEO AI PIPELINE
				</h1>

				{/* Tagline */}
				<p className="text-xl text-[var(--foreground)] mt-4 md:text-lg sm:text-base max-w-2xl">
					Automate your video publishing workflow with AI-powered metadata
					generation and YouTube integration
				</p>

				{/* Feature Icons as Text */}
				<div className="my-8 flex items-center justify-center gap-8">
					<div className="flex flex-col items-center">
						<div className="bg-[var(--accent-blue)] text-white h-12 w-12 rounded-full flex items-center justify-center">
							<span className="font-bold">AI</span>
						</div>
						<span className="text-sm mt-1">Gemini</span>
					</div>
					<div className="flex flex-col items-center">
						<div className="bg-red-600 text-white h-12 w-12 rounded-full flex items-center justify-center">
							<span className="font-bold">YT</span>
						</div>
						<span className="text-sm mt-1">YouTube</span>
					</div>
					<div className="flex flex-col items-center">
						<div className="bg-gray-700 text-white h-12 w-12 rounded-full flex items-center justify-center">
							<span className="font-bold">GCP</span>
						</div>
						<span className="text-sm mt-1">Cloud</span>
					</div>
				</div>

				{/* Separator */}
				<hr className="my-6 w-1/5 border-[var(--accent-blue)] border-t-2" />

				{/* Feature Tabs Section */}
				<div className="w-full max-w-2xl mt-8">
					<Tabs defaultValue="upload" className="w-full">
						<TabsList className="grid w-full grid-cols-4">
							<TabsTrigger value="upload">Upload</TabsTrigger>
							<TabsTrigger value="process">Process</TabsTrigger>
							<TabsTrigger value="metadata">Metadata</TabsTrigger>
							<TabsTrigger value="publish">Publish</TabsTrigger>
						</TabsList>
						<TabsContent value="upload" className="mt-4 text-left space-y-2">
							<p>
								<strong>Drag & Drop:</strong> Simple video upload interface
							</p>
							<p>
								<strong>Multi-Channel:</strong> Support for both daily and main
								channels
							</p>
							<p>
								<strong>Cloud Storage:</strong> Videos stored securely in Google
								Cloud Storage
							</p>
							<p>
								<strong>Real-time:</strong> Live status updates as your video
								moves through the pipeline
							</p>
						</TabsContent>
						<TabsContent value="process" className="mt-4 text-left space-y-2">
							<p>
								<strong>Automatic:</strong> Hands-off video processing workflow
							</p>
							<p>
								<strong>AI-Powered:</strong> Gemini 2.5 Pro generates
								high-quality metadata
							</p>
							<p>
								<strong>Transcription:</strong> Accurate speech-to-text for your
								entire video
							</p>
							<p>
								<strong>Chapters:</strong> Smart chapter markers generated from
								video content
							</p>
						</TabsContent>
						<TabsContent value="metadata" className="mt-4 text-left space-y-2">
							<p>
								<strong>Title Generation:</strong> AI creates engaging,
								SEO-friendly titles
							</p>
							<p>
								<strong>Description:</strong> Comprehensive video descriptions
								with keywords
							</p>
							<p>
								<strong>Thumbnails:</strong> Generate 10 thumbnails with Imagen3
								+ Pillow
							</p>
							<p>
								<strong>Editable:</strong> Review and customize all metadata
								before publishing
							</p>
						</TabsContent>
						<TabsContent value="publish" className="mt-4 text-left space-y-2">
							<p>
								<strong>YouTube Integration:</strong> Direct upload to your
								YouTube channel
							</p>
							<p>
								<strong>Scheduling:</strong> Set publication dates and times
							</p>
							<p>
								<strong>Status Tracking:</strong> Monitor progress from
								processing to published
							</p>
							<p>
								<strong>Error Handling:</strong> Robust error recovery and
								notification
							</p>
						</TabsContent>
					</Tabs>
				</div>

				{/* Key Benefits Section */}
				<div className="w-full max-w-2xl mt-16">
					<h2 className="font-bold text-3xl text-[var(--accent-blue)] md:text-2xl sm:text-xl mb-6">
						KEY BENEFITS
					</h2>
					<ul className="grid grid-cols-2 gap-4 text-base text-[var(--foreground)]">
						<li className="flex items-center gap-2">
							<span className="text-[var(--accent-blue)]">✓</span> Save hours on
							video publishing
						</li>
						<li className="flex items-center gap-2">
							<span className="text-[var(--accent-blue)]">✓</span> Consistent,
							high-quality metadata
						</li>
						<li className="flex items-center gap-2">
							<span className="text-[var(--accent-blue)]">✓</span> AI-generated
							thumbnails
						</li>
						<li className="flex items-center gap-2">
							<span className="text-[var(--accent-blue)]">✓</span> Real-time
							status tracking
						</li>
						<li className="flex items-center gap-2">
							<span className="text-[var(--accent-blue)]">✓</span> Full editing
							control
						</li>
						<li className="flex items-center gap-2">
							<span className="text-[var(--accent-blue)]">✓</span> Cloud-native
							architecture
						</li>
					</ul>
				</div>

				{/* CTA Button */}
				<div className="mt-12">
					<a
						href="/dashboard"
						className="bg-[var(--accent-blue)] text-white px-8 py-3 rounded-md text-lg hover:bg-opacity-90 transition-all"
					>
						Get Started
					</a>
				</div>
			</div>
		</Container>
	);
}

================
File: src/components/shared/container.tsx
================
import { cn } from "@/lib/utils";

type Props = {
	children: React.ReactNode;
	tag?: "div" | "section" | "header" | "footer";
	className?: string;
	id?: string;
	spacer?: boolean;
	padding?: boolean;
};

export default function Container({
	children,
	tag = "div",
	className,
	id,
	spacer = false,
	padding = true,
}: Props) {
	const Tag = tag;
	return (
		<Tag
			className={cn(
				"w-full flex flex-col",
				spacer ? "mt-19" : "",
				padding ? "px-6 md:px-8 lg:px-10" : "",
				className,
			)}
			id={id}
		>
			{children}
		</Tag>
	);
}

================
File: src/components/shared/navbar.tsx
================
import { cn } from "@/lib/utils";
import { Link } from "@tanstack/react-router";
import { Home, Menu, Search, X } from "lucide-react";
import { useState } from "react";
import { Button } from "../ui/button";
import Container from "./container";

type Props = {};

export default function Navbar({}: Props) {
	const [isMenuOpen, setIsMenuOpen] = useState(false);

	const navItems = [
		{
			label: "Home",
			href: "/",
		},
		{
			label: "Upload",
			href: "/upload",
		},
		{
			label: "Dashboard",
			href: "/dashboard",
		},
		{
			label: "Settings",
			href: "/settings",
		},
	];

	return (
		<div className="w-full bg-background/90 backdrop-blur-sm border-b border-border/40 sticky top-0 z-50">
			<Container className="flex h-16 items-center justify-between">
				{/* Logo */}
				<div className="flex items-center">
					<Link to="/" className="flex items-center space-x-2">
						<div className="flex h-8 w-8 items-center justify-center rounded-md bg-primary">
							<Home className="h-4 w-4 text-primary-foreground" />
						</div>
						<span className="font-bold text-lg tracking-tight">UrcKe</span>
					</Link>
				</div>

				{/* Desktop navigation */}
				<nav className="hidden md:flex">
					<ul className="flex items-center space-x-8">
						{navItems.map((item) => (
							<li key={item.href}>
								<Link
									to={item.href}
									className={
										"text-sm font-medium transition-colors hover:text-primary"
									}
									activeOptions={{ exact: true }}
									activeProps={{
										className: "text-primary font-semibold",
									}}
								>
									{item.label}
								</Link>
							</li>
						))}
					</ul>
				</nav>

				{/* Actions */}
				<div className="flex items-center space-x-4">
					<Button variant="ghost" size="icon" className="hidden md:flex">
						<Search className="h-4 w-4" />
						<span className="sr-only">Search</span>
					</Button>
					<Button className="hidden md:flex">Get Started</Button>

					{/* Mobile menu button */}
					<Button
						variant="ghost"
						size="icon"
						className="md:hidden"
						onClick={() => setIsMenuOpen(!isMenuOpen)}
					>
						{isMenuOpen ? (
							<X className="h-5 w-5" />
						) : (
							<Menu className="h-5 w-5" />
						)}
						<span className="sr-only">Toggle menu</span>
					</Button>
				</div>
			</Container>

			{/* Mobile navigation */}
			<div
				className={cn(
					"md:hidden border-t border-border/40",
					isMenuOpen ? "block" : "hidden",
				)}
			>
				<Container className="py-4 px-6 space-y-4">
					<nav>
						<ul className="space-y-4">
							{navItems.map((item) => (
								<li key={item.href}>
									<Link
										to={item.href}
										className="block text-sm font-medium transition-colors hover:text-primary"
										activeOptions={{ exact: true }}
										activeProps={{
											className: "text-primary font-semibold",
										}}
										onClick={() => setIsMenuOpen(false)}
									>
										{item.label}
									</Link>
								</li>
							))}
						</ul>
					</nav>
					<div className="flex flex-col space-y-3 pt-3 border-t border-border/40">
						<Button
							variant="outline"
							className="w-full justify-start"
							size="sm"
						>
							<Search className="mr-2 h-4 w-4" />
							Search
						</Button>
						<Button className="w-full" size="sm">
							Get Started
						</Button>
					</div>
				</Container>
			</div>
		</div>
	);
}

================
File: src/components/ui/accordion.tsx
================
import * as AccordionPrimitive from "@radix-ui/react-accordion";
import { ChevronDownIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Accordion({
	...props
}: React.ComponentProps<typeof AccordionPrimitive.Root>) {
	return <AccordionPrimitive.Root data-slot="accordion" {...props} />;
}

function AccordionItem({
	className,
	...props
}: React.ComponentProps<typeof AccordionPrimitive.Item>) {
	return (
		<AccordionPrimitive.Item
			data-slot="accordion-item"
			className={cn("border-b last:border-b-0", className)}
			{...props}
		/>
	);
}

function AccordionTrigger({
	className,
	children,
	...props
}: React.ComponentProps<typeof AccordionPrimitive.Trigger>) {
	return (
		<AccordionPrimitive.Header className="flex">
			<AccordionPrimitive.Trigger
				data-slot="accordion-trigger"
				className={cn(
					"focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",
					className,
				)}
				{...props}
			>
				{children}
				<ChevronDownIcon className="text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200" />
			</AccordionPrimitive.Trigger>
		</AccordionPrimitive.Header>
	);
}

function AccordionContent({
	className,
	children,
	...props
}: React.ComponentProps<typeof AccordionPrimitive.Content>) {
	return (
		<AccordionPrimitive.Content
			data-slot="accordion-content"
			className="data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm"
			{...props}
		>
			<div className={cn("pt-0 pb-4", className)}>{children}</div>
		</AccordionPrimitive.Content>
	);
}

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };

================
File: src/components/ui/alert-dialog.tsx
================
"use client";

import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog";
import type * as React from "react";

import { buttonVariants } from "@/components/ui/button";
import { cn } from "@/lib/utils";

function AlertDialog({
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {
	return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />;
}

function AlertDialogTrigger({
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {
	return (
		<AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />
	);
}

function AlertDialogPortal({
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {
	return (
		<AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />
	);
}

function AlertDialogOverlay({
	className,
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {
	return (
		<AlertDialogPrimitive.Overlay
			data-slot="alert-dialog-overlay"
			className={cn(
				"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
				className,
			)}
			{...props}
		/>
	);
}

function AlertDialogContent({
	className,
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {
	return (
		<AlertDialogPortal>
			<AlertDialogOverlay />
			<AlertDialogPrimitive.Content
				data-slot="alert-dialog-content"
				className={cn(
					"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
					className,
				)}
				{...props}
			/>
		</AlertDialogPortal>
	);
}

function AlertDialogHeader({
	className,
	...props
}: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="alert-dialog-header"
			className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
			{...props}
		/>
	);
}

function AlertDialogFooter({
	className,
	...props
}: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="alert-dialog-footer"
			className={cn(
				"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
				className,
			)}
			{...props}
		/>
	);
}

function AlertDialogTitle({
	className,
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
	return (
		<AlertDialogPrimitive.Title
			data-slot="alert-dialog-title"
			className={cn("text-lg font-semibold", className)}
			{...props}
		/>
	);
}

function AlertDialogDescription({
	className,
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
	return (
		<AlertDialogPrimitive.Description
			data-slot="alert-dialog-description"
			className={cn("text-muted-foreground text-sm", className)}
			{...props}
		/>
	);
}

function AlertDialogAction({
	className,
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {
	return (
		<AlertDialogPrimitive.Action
			className={cn(buttonVariants(), className)}
			{...props}
		/>
	);
}

function AlertDialogCancel({
	className,
	...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {
	return (
		<AlertDialogPrimitive.Cancel
			className={cn(buttonVariants({ variant: "outline" }), className)}
			{...props}
		/>
	);
}

export {
	AlertDialog,
	AlertDialogPortal,
	AlertDialogOverlay,
	AlertDialogTrigger,
	AlertDialogContent,
	AlertDialogHeader,
	AlertDialogFooter,
	AlertDialogTitle,
	AlertDialogDescription,
	AlertDialogAction,
	AlertDialogCancel,
};

================
File: src/components/ui/alert.tsx
================
import { type VariantProps, cva } from "class-variance-authority";
import type * as React from "react";

import { cn } from "@/lib/utils";

const alertVariants = cva(
	"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
	{
		variants: {
			variant: {
				default: "bg-card text-card-foreground",
				destructive:
					"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
			},
		},
		defaultVariants: {
			variant: "default",
		},
	},
);

function Alert({
	className,
	variant,
	...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
	return (
		<div
			data-slot="alert"
			role="alert"
			className={cn(alertVariants({ variant }), className)}
			{...props}
		/>
	);
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="alert-title"
			className={cn(
				"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
				className,
			)}
			{...props}
		/>
	);
}

function AlertDescription({
	className,
	...props
}: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="alert-description"
			className={cn(
				"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
				className,
			)}
			{...props}
		/>
	);
}

export { Alert, AlertTitle, AlertDescription };

================
File: src/components/ui/aspect-ratio.tsx
================
import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio";

function AspectRatio({
	...props
}: React.ComponentProps<typeof AspectRatioPrimitive.Root>) {
	return <AspectRatioPrimitive.Root data-slot="aspect-ratio" {...props} />;
}

export { AspectRatio };

================
File: src/components/ui/avatar.tsx
================
"use client";

import * as AvatarPrimitive from "@radix-ui/react-avatar";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Avatar({
	className,
	...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
	return (
		<AvatarPrimitive.Root
			data-slot="avatar"
			className={cn(
				"relative flex size-8 shrink-0 overflow-hidden rounded-full",
				className,
			)}
			{...props}
		/>
	);
}

function AvatarImage({
	className,
	...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
	return (
		<AvatarPrimitive.Image
			data-slot="avatar-image"
			className={cn("aspect-square size-full", className)}
			{...props}
		/>
	);
}

function AvatarFallback({
	className,
	...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
	return (
		<AvatarPrimitive.Fallback
			data-slot="avatar-fallback"
			className={cn(
				"bg-muted flex size-full items-center justify-center rounded-full",
				className,
			)}
			{...props}
		/>
	);
}

export { Avatar, AvatarImage, AvatarFallback };

================
File: src/components/ui/badge.tsx
================
import { Slot } from "@radix-ui/react-slot";
import { type VariantProps, cva } from "class-variance-authority";
import type * as React from "react";

import { cn } from "@/lib/utils";

const badgeVariants = cva(
	"inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
	{
		variants: {
			variant: {
				default:
					"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
				secondary:
					"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
				destructive:
					"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
				outline:
					"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
			},
		},
		defaultVariants: {
			variant: "default",
		},
	},
);

function Badge({
	className,
	variant,
	asChild = false,
	...props
}: React.ComponentProps<"span"> &
	VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
	const Comp = asChild ? Slot : "span";

	return (
		<Comp
			data-slot="badge"
			className={cn(badgeVariants({ variant }), className)}
			{...props}
		/>
	);
}

export { Badge, badgeVariants };

================
File: src/components/ui/breadcrumb.tsx
================
import { Slot } from "@radix-ui/react-slot";
import { ChevronRight, MoreHorizontal } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Breadcrumb({ ...props }: React.ComponentProps<"nav">) {
	return <nav aria-label="breadcrumb" data-slot="breadcrumb" {...props} />;
}

function BreadcrumbList({ className, ...props }: React.ComponentProps<"ol">) {
	return (
		<ol
			data-slot="breadcrumb-list"
			className={cn(
				"text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",
				className,
			)}
			{...props}
		/>
	);
}

function BreadcrumbItem({ className, ...props }: React.ComponentProps<"li">) {
	return (
		<li
			data-slot="breadcrumb-item"
			className={cn("inline-flex items-center gap-1.5", className)}
			{...props}
		/>
	);
}

function BreadcrumbLink({
	asChild,
	className,
	...props
}: React.ComponentProps<"a"> & {
	asChild?: boolean;
}) {
	const Comp = asChild ? Slot : "a";

	return (
		<Comp
			data-slot="breadcrumb-link"
			className={cn("hover:text-foreground transition-colors", className)}
			{...props}
		/>
	);
}

function BreadcrumbPage({ className, ...props }: React.ComponentProps<"span">) {
	return (
		<span
			data-slot="breadcrumb-page"
			role="link"
			aria-disabled="true"
			aria-current="page"
			className={cn("text-foreground font-normal", className)}
			{...props}
		/>
	);
}

function BreadcrumbSeparator({
	children,
	className,
	...props
}: React.ComponentProps<"li">) {
	return (
		<li
			data-slot="breadcrumb-separator"
			role="presentation"
			aria-hidden="true"
			className={cn("[&>svg]:size-3.5", className)}
			{...props}
		>
			{children ?? <ChevronRight />}
		</li>
	);
}

function BreadcrumbEllipsis({
	className,
	...props
}: React.ComponentProps<"span">) {
	return (
		<span
			data-slot="breadcrumb-ellipsis"
			role="presentation"
			aria-hidden="true"
			className={cn("flex size-9 items-center justify-center", className)}
			{...props}
		>
			<MoreHorizontal className="size-4" />
			<span className="sr-only">More</span>
		</span>
	);
}

export {
	Breadcrumb,
	BreadcrumbList,
	BreadcrumbItem,
	BreadcrumbLink,
	BreadcrumbPage,
	BreadcrumbSeparator,
	BreadcrumbEllipsis,
};

================
File: src/components/ui/button.tsx
================
import { Slot } from "@radix-ui/react-slot";
import { type VariantProps, cva } from "class-variance-authority";
import type * as React from "react";

import { cn } from "@/lib/utils";

const buttonVariants = cva(
	"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
	{
		variants: {
			variant: {
				default:
					"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",
				destructive:
					"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
				outline:
					"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
				secondary:
					"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",
				ghost:
					"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
				link: "text-primary underline-offset-4 hover:underline",
			},
			size: {
				default: "h-9 px-4 py-2 has-[>svg]:px-3",
				sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
				lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
				icon: "size-9",
			},
		},
		defaultVariants: {
			variant: "default",
			size: "default",
		},
	},
);

function Button({
	className,
	variant,
	size,
	asChild = false,
	...props
}: React.ComponentProps<"button"> &
	VariantProps<typeof buttonVariants> & {
		asChild?: boolean;
	}) {
	const Comp = asChild ? Slot : "button";

	return (
		<Comp
			data-slot="button"
			className={cn(buttonVariants({ variant, size, className }))}
			{...props}
		/>
	);
}

export { Button, buttonVariants };

================
File: src/components/ui/calendar.tsx
================
import { ChevronLeft, ChevronRight } from "lucide-react";
import type * as React from "react";
import { DayPicker } from "react-day-picker";

import { buttonVariants } from "@/components/ui/button";
import { cn } from "@/lib/utils";

function Calendar({
	className,
	classNames,
	showOutsideDays = true,
	...props
}: React.ComponentProps<typeof DayPicker>) {
	return (
		<DayPicker
			showOutsideDays={showOutsideDays}
			className={cn("p-3", className)}
			classNames={{
				months: "flex flex-col sm:flex-row gap-2",
				month: "flex flex-col gap-4",
				caption: "flex justify-center pt-1 relative items-center w-full",
				caption_label: "text-sm font-medium",
				nav: "flex items-center gap-1",
				nav_button: cn(
					buttonVariants({ variant: "outline" }),
					"size-7 bg-transparent p-0 opacity-50 hover:opacity-100",
				),
				nav_button_previous: "absolute left-1",
				nav_button_next: "absolute right-1",
				table: "w-full border-collapse space-x-1",
				head_row: "flex",
				head_cell:
					"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",
				row: "flex w-full mt-2",
				cell: cn(
					"relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",
					props.mode === "range"
						? "[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md"
						: "[&:has([aria-selected])]:rounded-md",
				),
				day: cn(
					buttonVariants({ variant: "ghost" }),
					"size-8 p-0 font-normal aria-selected:opacity-100",
				),
				day_range_start:
					"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",
				day_range_end:
					"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",
				day_selected:
					"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
				day_today: "bg-accent text-accent-foreground",
				day_outside:
					"day-outside text-muted-foreground aria-selected:text-muted-foreground",
				day_disabled: "text-muted-foreground opacity-50",
				day_range_middle:
					"aria-selected:bg-accent aria-selected:text-accent-foreground",
				day_hidden: "invisible",
				...classNames,
			}}
			components={{
				IconLeft: ({ className, ...props }) => (
					<ChevronLeft className={cn("size-4", className)} {...props} />
				),
				IconRight: ({ className, ...props }) => (
					<ChevronRight className={cn("size-4", className)} {...props} />
				),
			}}
			{...props}
		/>
	);
}

export { Calendar };

================
File: src/components/ui/card.tsx
================
import type * as React from "react";

import { cn } from "@/lib/utils";

function Card({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card"
			className={cn(
				"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
				className,
			)}
			{...props}
		/>
	);
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card-header"
			className={cn(
				"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
				className,
			)}
			{...props}
		/>
	);
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card-title"
			className={cn("leading-none font-semibold", className)}
			{...props}
		/>
	);
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card-description"
			className={cn("text-muted-foreground text-sm", className)}
			{...props}
		/>
	);
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card-action"
			className={cn(
				"col-start-2 row-span-2 row-start-1 self-start justify-self-end",
				className,
			)}
			{...props}
		/>
	);
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card-content"
			className={cn("px-6", className)}
			{...props}
		/>
	);
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="card-footer"
			className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
			{...props}
		/>
	);
}

export {
	Card,
	CardHeader,
	CardFooter,
	CardTitle,
	CardAction,
	CardDescription,
	CardContent,
};

================
File: src/components/ui/carousel.tsx
================
"use client";

import useEmblaCarousel, {
	type UseEmblaCarouselType,
} from "embla-carousel-react";
import { ArrowLeft, ArrowRight } from "lucide-react";
import * as React from "react";

import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
	opts?: CarouselOptions;
	plugins?: CarouselPlugin;
	orientation?: "horizontal" | "vertical";
	setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
	carouselRef: ReturnType<typeof useEmblaCarousel>[0];
	api: ReturnType<typeof useEmblaCarousel>[1];
	scrollPrev: () => void;
	scrollNext: () => void;
	canScrollPrev: boolean;
	canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
	const context = React.useContext(CarouselContext);

	if (!context) {
		throw new Error("useCarousel must be used within a <Carousel />");
	}

	return context;
}

function Carousel({
	orientation = "horizontal",
	opts,
	setApi,
	plugins,
	className,
	children,
	...props
}: React.ComponentProps<"div"> & CarouselProps) {
	const [carouselRef, api] = useEmblaCarousel(
		{
			...opts,
			axis: orientation === "horizontal" ? "x" : "y",
		},
		plugins,
	);
	const [canScrollPrev, setCanScrollPrev] = React.useState(false);
	const [canScrollNext, setCanScrollNext] = React.useState(false);

	const onSelect = React.useCallback((api: CarouselApi) => {
		if (!api) return;
		setCanScrollPrev(api.canScrollPrev());
		setCanScrollNext(api.canScrollNext());
	}, []);

	const scrollPrev = React.useCallback(() => {
		api?.scrollPrev();
	}, [api]);

	const scrollNext = React.useCallback(() => {
		api?.scrollNext();
	}, [api]);

	const handleKeyDown = React.useCallback(
		(event: React.KeyboardEvent<HTMLDivElement>) => {
			if (event.key === "ArrowLeft") {
				event.preventDefault();
				scrollPrev();
			} else if (event.key === "ArrowRight") {
				event.preventDefault();
				scrollNext();
			}
		},
		[scrollPrev, scrollNext],
	);

	React.useEffect(() => {
		if (!api || !setApi) return;
		setApi(api);
	}, [api, setApi]);

	React.useEffect(() => {
		if (!api) return;
		onSelect(api);
		api.on("reInit", onSelect);
		api.on("select", onSelect);

		return () => {
			api?.off("select", onSelect);
		};
	}, [api, onSelect]);

	return (
		<CarouselContext.Provider
			value={{
				carouselRef,
				api: api,
				opts,
				orientation:
					orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
				scrollPrev,
				scrollNext,
				canScrollPrev,
				canScrollNext,
			}}
		>
			<div
				onKeyDownCapture={handleKeyDown}
				className={cn("relative", className)}
				role="region"
				aria-roledescription="carousel"
				data-slot="carousel"
				{...props}
			>
				{children}
			</div>
		</CarouselContext.Provider>
	);
}

function CarouselContent({ className, ...props }: React.ComponentProps<"div">) {
	const { carouselRef, orientation } = useCarousel();

	return (
		<div
			ref={carouselRef}
			className="overflow-hidden"
			data-slot="carousel-content"
		>
			<div
				className={cn(
					"flex",
					orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",
					className,
				)}
				{...props}
			/>
		</div>
	);
}

function CarouselItem({ className, ...props }: React.ComponentProps<"div">) {
	const { orientation } = useCarousel();

	return (
		<div
			role="group"
			aria-roledescription="slide"
			data-slot="carousel-item"
			className={cn(
				"min-w-0 shrink-0 grow-0 basis-full",
				orientation === "horizontal" ? "pl-4" : "pt-4",
				className,
			)}
			{...props}
		/>
	);
}

function CarouselPrevious({
	className,
	variant = "outline",
	size = "icon",
	...props
}: React.ComponentProps<typeof Button>) {
	const { orientation, scrollPrev, canScrollPrev } = useCarousel();

	return (
		<Button
			data-slot="carousel-previous"
			variant={variant}
			size={size}
			className={cn(
				"absolute size-8 rounded-full",
				orientation === "horizontal"
					? "top-1/2 -left-12 -translate-y-1/2"
					: "-top-12 left-1/2 -translate-x-1/2 rotate-90",
				className,
			)}
			disabled={!canScrollPrev}
			onClick={scrollPrev}
			{...props}
		>
			<ArrowLeft />
			<span className="sr-only">Previous slide</span>
		</Button>
	);
}

function CarouselNext({
	className,
	variant = "outline",
	size = "icon",
	...props
}: React.ComponentProps<typeof Button>) {
	const { orientation, scrollNext, canScrollNext } = useCarousel();

	return (
		<Button
			data-slot="carousel-next"
			variant={variant}
			size={size}
			className={cn(
				"absolute size-8 rounded-full",
				orientation === "horizontal"
					? "top-1/2 -right-12 -translate-y-1/2"
					: "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
				className,
			)}
			disabled={!canScrollNext}
			onClick={scrollNext}
			{...props}
		>
			<ArrowRight />
			<span className="sr-only">Next slide</span>
		</Button>
	);
}

export {
	type CarouselApi,
	Carousel,
	CarouselContent,
	CarouselItem,
	CarouselPrevious,
	CarouselNext,
};

================
File: src/components/ui/chart.tsx
================
import * as React from "react";
import * as RechartsPrimitive from "recharts";

import { cn } from "@/lib/utils";

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const;

export type ChartConfig = {
	[k in string]: {
		label?: React.ReactNode;
		icon?: React.ComponentType;
	} & (
		| { color?: string; theme?: never }
		| { color?: never; theme: Record<keyof typeof THEMES, string> }
	);
};

type ChartContextProps = {
	config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

function useChart() {
	const context = React.useContext(ChartContext);

	if (!context) {
		throw new Error("useChart must be used within a <ChartContainer />");
	}

	return context;
}

function ChartContainer({
	id,
	className,
	children,
	config,
	...props
}: React.ComponentProps<"div"> & {
	config: ChartConfig;
	children: React.ComponentProps<
		typeof RechartsPrimitive.ResponsiveContainer
	>["children"];
}) {
	const uniqueId = React.useId();
	const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`;

	return (
		<ChartContext.Provider value={{ config }}>
			<div
				data-slot="chart"
				data-chart={chartId}
				className={cn(
					"[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",
					className,
				)}
				{...props}
			>
				<ChartStyle id={chartId} config={config} />
				<RechartsPrimitive.ResponsiveContainer>
					{children}
				</RechartsPrimitive.ResponsiveContainer>
			</div>
		</ChartContext.Provider>
	);
}

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
	const colorConfig = Object.entries(config).filter(
		([, config]) => config.theme || config.color,
	);

	if (!colorConfig.length) {
		return null;
	}

	return (
		<style
			dangerouslySetInnerHTML={{
				__html: Object.entries(THEMES)
					.map(
						([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
	.map(([key, itemConfig]) => {
		const color =
			itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
			itemConfig.color;
		return color ? `  --color-${key}: ${color};` : null;
	})
	.join("\n")}
}
`,
					)
					.join("\n"),
			}}
		/>
	);
};

const ChartTooltip = RechartsPrimitive.Tooltip;

function ChartTooltipContent({
	active,
	payload,
	className,
	indicator = "dot",
	hideLabel = false,
	hideIndicator = false,
	label,
	labelFormatter,
	labelClassName,
	formatter,
	color,
	nameKey,
	labelKey,
}: React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
	React.ComponentProps<"div"> & {
		hideLabel?: boolean;
		hideIndicator?: boolean;
		indicator?: "line" | "dot" | "dashed";
		nameKey?: string;
		labelKey?: string;
	}) {
	const { config } = useChart();

	const tooltipLabel = React.useMemo(() => {
		if (hideLabel || !payload?.length) {
			return null;
		}

		const [item] = payload;
		const key = `${labelKey || item?.dataKey || item?.name || "value"}`;
		const itemConfig = getPayloadConfigFromPayload(config, item, key);
		const value =
			!labelKey && typeof label === "string"
				? config[label as keyof typeof config]?.label || label
				: itemConfig?.label;

		if (labelFormatter) {
			return (
				<div className={cn("font-medium", labelClassName)}>
					{labelFormatter(value, payload)}
				</div>
			);
		}

		if (!value) {
			return null;
		}

		return <div className={cn("font-medium", labelClassName)}>{value}</div>;
	}, [
		label,
		labelFormatter,
		payload,
		hideLabel,
		labelClassName,
		config,
		labelKey,
	]);

	if (!active || !payload?.length) {
		return null;
	}

	const nestLabel = payload.length === 1 && indicator !== "dot";

	return (
		<div
			className={cn(
				"border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",
				className,
			)}
		>
			{!nestLabel ? tooltipLabel : null}
			<div className="grid gap-1.5">
				{payload.map((item, index) => {
					const key = `${nameKey || item.name || item.dataKey || "value"}`;
					const itemConfig = getPayloadConfigFromPayload(config, item, key);
					const indicatorColor = color || item.payload.fill || item.color;

					return (
						<div
							key={item.dataKey}
							className={cn(
								"[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5",
								indicator === "dot" && "items-center",
							)}
						>
							{formatter && item?.value !== undefined && item.name ? (
								formatter(item.value, item.name, item, index, item.payload)
							) : (
								<>
									{itemConfig?.icon ? (
										<itemConfig.icon />
									) : (
										!hideIndicator && (
											<div
												className={cn(
													"shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",
													{
														"h-2.5 w-2.5": indicator === "dot",
														"w-1": indicator === "line",
														"w-0 border-[1.5px] border-dashed bg-transparent":
															indicator === "dashed",
														"my-0.5": nestLabel && indicator === "dashed",
													},
												)}
												style={
													{
														"--color-bg": indicatorColor,
														"--color-border": indicatorColor,
													} as React.CSSProperties
												}
											/>
										)
									)}
									<div
										className={cn(
											"flex flex-1 justify-between leading-none",
											nestLabel ? "items-end" : "items-center",
										)}
									>
										<div className="grid gap-1.5">
											{nestLabel ? tooltipLabel : null}
											<span className="text-muted-foreground">
												{itemConfig?.label || item.name}
											</span>
										</div>
										{item.value && (
											<span className="text-foreground font-mono font-medium tabular-nums">
												{item.value.toLocaleString()}
											</span>
										)}
									</div>
								</>
							)}
						</div>
					);
				})}
			</div>
		</div>
	);
}

const ChartLegend = RechartsPrimitive.Legend;

function ChartLegendContent({
	className,
	hideIcon = false,
	payload,
	verticalAlign = "bottom",
	nameKey,
}: React.ComponentProps<"div"> &
	Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
		hideIcon?: boolean;
		nameKey?: string;
	}) {
	const { config } = useChart();

	if (!payload?.length) {
		return null;
	}

	return (
		<div
			className={cn(
				"flex items-center justify-center gap-4",
				verticalAlign === "top" ? "pb-3" : "pt-3",
				className,
			)}
		>
			{payload.map((item) => {
				const key = `${nameKey || item.dataKey || "value"}`;
				const itemConfig = getPayloadConfigFromPayload(config, item, key);

				return (
					<div
						key={item.value}
						className={cn(
							"[&>svg]:text-muted-foreground flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3",
						)}
					>
						{itemConfig?.icon && !hideIcon ? (
							<itemConfig.icon />
						) : (
							<div
								className="h-2 w-2 shrink-0 rounded-[2px]"
								style={{
									backgroundColor: item.color,
								}}
							/>
						)}
						{itemConfig?.label}
					</div>
				);
			})}
		</div>
	);
}

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
	config: ChartConfig,
	payload: unknown,
	key: string,
) {
	if (typeof payload !== "object" || payload === null) {
		return undefined;
	}

	const payloadPayload =
		"payload" in payload &&
		typeof payload.payload === "object" &&
		payload.payload !== null
			? payload.payload
			: undefined;

	let configLabelKey: string = key;

	if (
		key in payload &&
		typeof payload[key as keyof typeof payload] === "string"
	) {
		configLabelKey = payload[key as keyof typeof payload] as string;
	} else if (
		payloadPayload &&
		key in payloadPayload &&
		typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
	) {
		configLabelKey = payloadPayload[
			key as keyof typeof payloadPayload
		] as string;
	}

	return configLabelKey in config
		? config[configLabelKey]
		: config[key as keyof typeof config];
}

export {
	ChartContainer,
	ChartTooltip,
	ChartTooltipContent,
	ChartLegend,
	ChartLegendContent,
	ChartStyle,
};

================
File: src/components/ui/checkbox.tsx
================
"use client";

import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { CheckIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Checkbox({
	className,
	...props
}: React.ComponentProps<typeof CheckboxPrimitive.Root>) {
	return (
		<CheckboxPrimitive.Root
			data-slot="checkbox"
			className={cn(
				"peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
				className,
			)}
			{...props}
		>
			<CheckboxPrimitive.Indicator
				data-slot="checkbox-indicator"
				className="flex items-center justify-center text-current transition-none"
			>
				<CheckIcon className="size-3.5" />
			</CheckboxPrimitive.Indicator>
		</CheckboxPrimitive.Root>
	);
}

export { Checkbox };

================
File: src/components/ui/collapsible.tsx
================
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible";

function Collapsible({
	...props
}: React.ComponentProps<typeof CollapsiblePrimitive.Root>) {
	return <CollapsiblePrimitive.Root data-slot="collapsible" {...props} />;
}

function CollapsibleTrigger({
	...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleTrigger>) {
	return (
		<CollapsiblePrimitive.CollapsibleTrigger
			data-slot="collapsible-trigger"
			{...props}
		/>
	);
}

function CollapsibleContent({
	...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleContent>) {
	return (
		<CollapsiblePrimitive.CollapsibleContent
			data-slot="collapsible-content"
			{...props}
		/>
	);
}

export { Collapsible, CollapsibleTrigger, CollapsibleContent };

================
File: src/components/ui/combo-box.tsx
================
"use client";

import { Check, ChevronsUpDown } from "lucide-react";
import * as React from "react";

import { Button } from "@/components/ui/button";
import {
	Command,
	CommandEmpty,
	CommandGroup,
	CommandInput,
	CommandItem,
	CommandList,
} from "@/components/ui/command";
import {
	Popover,
	PopoverContent,
	PopoverTrigger,
} from "@/components/ui/popover";
import { cn } from "@/lib/utils";

const frameworks = [
	{
		value: "next.js",
		label: "Next.js",
	},
	{
		value: "sveltekit",
		label: "SvelteKit",
	},
	{
		value: "nuxt.js",
		label: "Nuxt.js",
	},
	{
		value: "remix",
		label: "Remix",
	},
	{
		value: "astro",
		label: "Astro",
	},
];

export function ComboboxDemo() {
	const [open, setOpen] = React.useState(false);
	const [value, setValue] = React.useState("");

	return (
		<Popover open={open} onOpenChange={setOpen}>
			<PopoverTrigger asChild>
				<Button
					variant="outline"
					role="combobox"
					aria-expanded={open}
					className="w-[200px] justify-between"
				>
					{value
						? frameworks.find((framework) => framework.value === value)?.label
						: "Select framework..."}
					<ChevronsUpDown className="opacity-50" />
				</Button>
			</PopoverTrigger>
			<PopoverContent className="w-[200px] p-0">
				<Command>
					<CommandInput placeholder="Search framework..." className="h-9" />
					<CommandList>
						<CommandEmpty>No framework found.</CommandEmpty>
						<CommandGroup>
							{frameworks.map((framework) => (
								<CommandItem
									key={framework.value}
									value={framework.value}
									onSelect={(currentValue) => {
										setValue(currentValue === value ? "" : currentValue);
										setOpen(false);
									}}
								>
									{framework.label}
									<Check
										className={cn(
											"ml-auto",
											value === framework.value ? "opacity-100" : "opacity-0",
										)}
									/>
								</CommandItem>
							))}
						</CommandGroup>
					</CommandList>
				</Command>
			</PopoverContent>
		</Popover>
	);
}

================
File: src/components/ui/command.tsx
================
"use client";

import { Command as CommandPrimitive } from "cmdk";
import { SearchIcon } from "lucide-react";
import type * as React from "react";

import {
	Dialog,
	DialogContent,
	DialogDescription,
	DialogHeader,
	DialogTitle,
} from "@/components/ui/dialog";
import { cn } from "@/lib/utils";

function Command({
	className,
	...props
}: React.ComponentProps<typeof CommandPrimitive>) {
	return (
		<CommandPrimitive
			data-slot="command"
			className={cn(
				"bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",
				className,
			)}
			{...props}
		/>
	);
}

function CommandDialog({
	title = "Command Palette",
	description = "Search for a command to run...",
	children,
	...props
}: React.ComponentProps<typeof Dialog> & {
	title?: string;
	description?: string;
}) {
	return (
		<Dialog {...props}>
			<DialogHeader className="sr-only">
				<DialogTitle>{title}</DialogTitle>
				<DialogDescription>{description}</DialogDescription>
			</DialogHeader>
			<DialogContent className="overflow-hidden p-0">
				<Command className="[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
					{children}
				</Command>
			</DialogContent>
		</Dialog>
	);
}

function CommandInput({
	className,
	...props
}: React.ComponentProps<typeof CommandPrimitive.Input>) {
	return (
		<div
			data-slot="command-input-wrapper"
			className="flex h-9 items-center gap-2 border-b px-3"
		>
			<SearchIcon className="size-4 shrink-0 opacity-50" />
			<CommandPrimitive.Input
				data-slot="command-input"
				className={cn(
					"placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",
					className,
				)}
				{...props}
			/>
		</div>
	);
}

function CommandList({
	className,
	...props
}: React.ComponentProps<typeof CommandPrimitive.List>) {
	return (
		<CommandPrimitive.List
			data-slot="command-list"
			className={cn(
				"max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",
				className,
			)}
			{...props}
		/>
	);
}

function CommandEmpty({
	...props
}: React.ComponentProps<typeof CommandPrimitive.Empty>) {
	return (
		<CommandPrimitive.Empty
			data-slot="command-empty"
			className="py-6 text-center text-sm"
			{...props}
		/>
	);
}

function CommandGroup({
	className,
	...props
}: React.ComponentProps<typeof CommandPrimitive.Group>) {
	return (
		<CommandPrimitive.Group
			data-slot="command-group"
			className={cn(
				"text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",
				className,
			)}
			{...props}
		/>
	);
}

function CommandSeparator({
	className,
	...props
}: React.ComponentProps<typeof CommandPrimitive.Separator>) {
	return (
		<CommandPrimitive.Separator
			data-slot="command-separator"
			className={cn("bg-border -mx-1 h-px", className)}
			{...props}
		/>
	);
}

function CommandItem({
	className,
	...props
}: React.ComponentProps<typeof CommandPrimitive.Item>) {
	return (
		<CommandPrimitive.Item
			data-slot="command-item"
			className={cn(
				"data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		/>
	);
}

function CommandShortcut({
	className,
	...props
}: React.ComponentProps<"span">) {
	return (
		<span
			data-slot="command-shortcut"
			className={cn(
				"text-muted-foreground ml-auto text-xs tracking-widest",
				className,
			)}
			{...props}
		/>
	);
}

export {
	Command,
	CommandDialog,
	CommandInput,
	CommandList,
	CommandEmpty,
	CommandGroup,
	CommandItem,
	CommandShortcut,
	CommandSeparator,
};

================
File: src/components/ui/context-menu.tsx
================
"use client";

import * as ContextMenuPrimitive from "@radix-ui/react-context-menu";
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function ContextMenu({
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Root>) {
	return <ContextMenuPrimitive.Root data-slot="context-menu" {...props} />;
}

function ContextMenuTrigger({
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Trigger>) {
	return (
		<ContextMenuPrimitive.Trigger data-slot="context-menu-trigger" {...props} />
	);
}

function ContextMenuGroup({
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Group>) {
	return (
		<ContextMenuPrimitive.Group data-slot="context-menu-group" {...props} />
	);
}

function ContextMenuPortal({
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Portal>) {
	return (
		<ContextMenuPrimitive.Portal data-slot="context-menu-portal" {...props} />
	);
}

function ContextMenuSub({
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Sub>) {
	return <ContextMenuPrimitive.Sub data-slot="context-menu-sub" {...props} />;
}

function ContextMenuRadioGroup({
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.RadioGroup>) {
	return (
		<ContextMenuPrimitive.RadioGroup
			data-slot="context-menu-radio-group"
			{...props}
		/>
	);
}

function ContextMenuSubTrigger({
	className,
	inset,
	children,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.SubTrigger> & {
	inset?: boolean;
}) {
	return (
		<ContextMenuPrimitive.SubTrigger
			data-slot="context-menu-sub-trigger"
			data-inset={inset}
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		>
			{children}
			<ChevronRightIcon className="ml-auto" />
		</ContextMenuPrimitive.SubTrigger>
	);
}

function ContextMenuSubContent({
	className,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.SubContent>) {
	return (
		<ContextMenuPrimitive.SubContent
			data-slot="context-menu-sub-content"
			className={cn(
				"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
				className,
			)}
			{...props}
		/>
	);
}

function ContextMenuContent({
	className,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Content>) {
	return (
		<ContextMenuPrimitive.Portal>
			<ContextMenuPrimitive.Content
				data-slot="context-menu-content"
				className={cn(
					"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
					className,
				)}
				{...props}
			/>
		</ContextMenuPrimitive.Portal>
	);
}

function ContextMenuItem({
	className,
	inset,
	variant = "default",
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Item> & {
	inset?: boolean;
	variant?: "default" | "destructive";
}) {
	return (
		<ContextMenuPrimitive.Item
			data-slot="context-menu-item"
			data-inset={inset}
			data-variant={variant}
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		/>
	);
}

function ContextMenuCheckboxItem({
	className,
	children,
	checked,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.CheckboxItem>) {
	return (
		<ContextMenuPrimitive.CheckboxItem
			data-slot="context-menu-checkbox-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			checked={checked}
			{...props}
		>
			<span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
				<ContextMenuPrimitive.ItemIndicator>
					<CheckIcon className="size-4" />
				</ContextMenuPrimitive.ItemIndicator>
			</span>
			{children}
		</ContextMenuPrimitive.CheckboxItem>
	);
}

function ContextMenuRadioItem({
	className,
	children,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.RadioItem>) {
	return (
		<ContextMenuPrimitive.RadioItem
			data-slot="context-menu-radio-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		>
			<span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
				<ContextMenuPrimitive.ItemIndicator>
					<CircleIcon className="size-2 fill-current" />
				</ContextMenuPrimitive.ItemIndicator>
			</span>
			{children}
		</ContextMenuPrimitive.RadioItem>
	);
}

function ContextMenuLabel({
	className,
	inset,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Label> & {
	inset?: boolean;
}) {
	return (
		<ContextMenuPrimitive.Label
			data-slot="context-menu-label"
			data-inset={inset}
			className={cn(
				"text-foreground px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
				className,
			)}
			{...props}
		/>
	);
}

function ContextMenuSeparator({
	className,
	...props
}: React.ComponentProps<typeof ContextMenuPrimitive.Separator>) {
	return (
		<ContextMenuPrimitive.Separator
			data-slot="context-menu-separator"
			className={cn("bg-border -mx-1 my-1 h-px", className)}
			{...props}
		/>
	);
}

function ContextMenuShortcut({
	className,
	...props
}: React.ComponentProps<"span">) {
	return (
		<span
			data-slot="context-menu-shortcut"
			className={cn(
				"text-muted-foreground ml-auto text-xs tracking-widest",
				className,
			)}
			{...props}
		/>
	);
}

export {
	ContextMenu,
	ContextMenuTrigger,
	ContextMenuContent,
	ContextMenuItem,
	ContextMenuCheckboxItem,
	ContextMenuRadioItem,
	ContextMenuLabel,
	ContextMenuSeparator,
	ContextMenuShortcut,
	ContextMenuGroup,
	ContextMenuPortal,
	ContextMenuSub,
	ContextMenuSubContent,
	ContextMenuSubTrigger,
	ContextMenuRadioGroup,
};

================
File: src/components/ui/date-picker.tsx
================
"use client";

import { format } from "date-fns";
import { Calendar as CalendarIcon } from "lucide-react";
import * as React from "react";

import { Button } from "@/components/ui/button";
import { Calendar } from "@/components/ui/calendar";
import {
	Popover,
	PopoverContent,
	PopoverTrigger,
} from "@/components/ui/popover";
import { cn } from "@/lib/utils";

export function DatePickerDemo() {
	const [date, setDate] = React.useState<Date>();

	return (
		<Popover>
			<PopoverTrigger asChild>
				<Button
					variant={"outline"}
					className={cn(
						"w-[280px] justify-start text-left font-normal",
						!date && "text-muted-foreground",
					)}
				>
					<CalendarIcon className="mr-2 h-4 w-4" />
					{date ? format(date, "PPP") : <span>Pick a date</span>}
				</Button>
			</PopoverTrigger>
			<PopoverContent className="w-auto p-0">
				<Calendar
					mode="single"
					selected={date}
					onSelect={setDate}
					initialFocus
				/>
			</PopoverContent>
		</Popover>
	);
}

================
File: src/components/ui/dialog.tsx
================
import * as DialogPrimitive from "@radix-ui/react-dialog";
import { XIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Dialog({
	...props
}: React.ComponentProps<typeof DialogPrimitive.Root>) {
	return <DialogPrimitive.Root data-slot="dialog" {...props} />;
}

function DialogTrigger({
	...props
}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
	return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />;
}

function DialogPortal({
	...props
}: React.ComponentProps<typeof DialogPrimitive.Portal>) {
	return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />;
}

function DialogClose({
	...props
}: React.ComponentProps<typeof DialogPrimitive.Close>) {
	return <DialogPrimitive.Close data-slot="dialog-close" {...props} />;
}

function DialogOverlay({
	className,
	...props
}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {
	return (
		<DialogPrimitive.Overlay
			data-slot="dialog-overlay"
			className={cn(
				"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
				className,
			)}
			{...props}
		/>
	);
}

function DialogContent({
	className,
	children,
	...props
}: React.ComponentProps<typeof DialogPrimitive.Content>) {
	return (
		<DialogPortal data-slot="dialog-portal">
			<DialogOverlay />
			<DialogPrimitive.Content
				data-slot="dialog-content"
				className={cn(
					"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
					className,
				)}
				{...props}
			>
				{children}
				<DialogPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4">
					<XIcon />
					<span className="sr-only">Close</span>
				</DialogPrimitive.Close>
			</DialogPrimitive.Content>
		</DialogPortal>
	);
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="dialog-header"
			className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
			{...props}
		/>
	);
}

function DialogFooter({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="dialog-footer"
			className={cn(
				"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
				className,
			)}
			{...props}
		/>
	);
}

function DialogTitle({
	className,
	...props
}: React.ComponentProps<typeof DialogPrimitive.Title>) {
	return (
		<DialogPrimitive.Title
			data-slot="dialog-title"
			className={cn("text-lg leading-none font-semibold", className)}
			{...props}
		/>
	);
}

function DialogDescription({
	className,
	...props
}: React.ComponentProps<typeof DialogPrimitive.Description>) {
	return (
		<DialogPrimitive.Description
			data-slot="dialog-description"
			className={cn("text-muted-foreground text-sm", className)}
			{...props}
		/>
	);
}

export {
	Dialog,
	DialogClose,
	DialogContent,
	DialogDescription,
	DialogFooter,
	DialogHeader,
	DialogOverlay,
	DialogPortal,
	DialogTitle,
	DialogTrigger,
};

================
File: src/components/ui/drawer.tsx
================
import type * as React from "react";
import { Drawer as DrawerPrimitive } from "vaul";

import { cn } from "@/lib/utils";

function Drawer({
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) {
	return <DrawerPrimitive.Root data-slot="drawer" {...props} />;
}

function DrawerTrigger({
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Trigger>) {
	return <DrawerPrimitive.Trigger data-slot="drawer-trigger" {...props} />;
}

function DrawerPortal({
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Portal>) {
	return <DrawerPrimitive.Portal data-slot="drawer-portal" {...props} />;
}

function DrawerClose({
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Close>) {
	return <DrawerPrimitive.Close data-slot="drawer-close" {...props} />;
}

function DrawerOverlay({
	className,
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Overlay>) {
	return (
		<DrawerPrimitive.Overlay
			data-slot="drawer-overlay"
			className={cn(
				"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
				className,
			)}
			{...props}
		/>
	);
}

function DrawerContent({
	className,
	children,
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Content>) {
	return (
		<DrawerPortal data-slot="drawer-portal">
			<DrawerOverlay />
			<DrawerPrimitive.Content
				data-slot="drawer-content"
				className={cn(
					"group/drawer-content bg-background fixed z-50 flex h-auto flex-col",
					"data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b",
					"data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t",
					"data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm",
					"data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",
					className,
				)}
				{...props}
			>
				<div className="bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block" />
				{children}
			</DrawerPrimitive.Content>
		</DrawerPortal>
	);
}

function DrawerHeader({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="drawer-header"
			className={cn("flex flex-col gap-1.5 p-4", className)}
			{...props}
		/>
	);
}

function DrawerFooter({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="drawer-footer"
			className={cn("mt-auto flex flex-col gap-2 p-4", className)}
			{...props}
		/>
	);
}

function DrawerTitle({
	className,
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Title>) {
	return (
		<DrawerPrimitive.Title
			data-slot="drawer-title"
			className={cn("text-foreground font-semibold", className)}
			{...props}
		/>
	);
}

function DrawerDescription({
	className,
	...props
}: React.ComponentProps<typeof DrawerPrimitive.Description>) {
	return (
		<DrawerPrimitive.Description
			data-slot="drawer-description"
			className={cn("text-muted-foreground text-sm", className)}
			{...props}
		/>
	);
}

export {
	Drawer,
	DrawerPortal,
	DrawerOverlay,
	DrawerTrigger,
	DrawerClose,
	DrawerContent,
	DrawerHeader,
	DrawerFooter,
	DrawerTitle,
	DrawerDescription,
};

================
File: src/components/ui/dropdown-menu.tsx
================
"use client";

import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function DropdownMenu({
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
	return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />;
}

function DropdownMenuPortal({
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
	return (
		<DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
	);
}

function DropdownMenuTrigger({
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
	return (
		<DropdownMenuPrimitive.Trigger
			data-slot="dropdown-menu-trigger"
			{...props}
		/>
	);
}

function DropdownMenuContent({
	className,
	sideOffset = 4,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
	return (
		<DropdownMenuPrimitive.Portal>
			<DropdownMenuPrimitive.Content
				data-slot="dropdown-menu-content"
				sideOffset={sideOffset}
				className={cn(
					"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
					className,
				)}
				{...props}
			/>
		</DropdownMenuPrimitive.Portal>
	);
}

function DropdownMenuGroup({
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
	return (
		<DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
	);
}

function DropdownMenuItem({
	className,
	inset,
	variant = "default",
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
	inset?: boolean;
	variant?: "default" | "destructive";
}) {
	return (
		<DropdownMenuPrimitive.Item
			data-slot="dropdown-menu-item"
			data-inset={inset}
			data-variant={variant}
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		/>
	);
}

function DropdownMenuCheckboxItem({
	className,
	children,
	checked,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
	return (
		<DropdownMenuPrimitive.CheckboxItem
			data-slot="dropdown-menu-checkbox-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			checked={checked}
			{...props}
		>
			<span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
				<DropdownMenuPrimitive.ItemIndicator>
					<CheckIcon className="size-4" />
				</DropdownMenuPrimitive.ItemIndicator>
			</span>
			{children}
		</DropdownMenuPrimitive.CheckboxItem>
	);
}

function DropdownMenuRadioGroup({
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
	return (
		<DropdownMenuPrimitive.RadioGroup
			data-slot="dropdown-menu-radio-group"
			{...props}
		/>
	);
}

function DropdownMenuRadioItem({
	className,
	children,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
	return (
		<DropdownMenuPrimitive.RadioItem
			data-slot="dropdown-menu-radio-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		>
			<span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
				<DropdownMenuPrimitive.ItemIndicator>
					<CircleIcon className="size-2 fill-current" />
				</DropdownMenuPrimitive.ItemIndicator>
			</span>
			{children}
		</DropdownMenuPrimitive.RadioItem>
	);
}

function DropdownMenuLabel({
	className,
	inset,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
	inset?: boolean;
}) {
	return (
		<DropdownMenuPrimitive.Label
			data-slot="dropdown-menu-label"
			data-inset={inset}
			className={cn(
				"px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
				className,
			)}
			{...props}
		/>
	);
}

function DropdownMenuSeparator({
	className,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
	return (
		<DropdownMenuPrimitive.Separator
			data-slot="dropdown-menu-separator"
			className={cn("bg-border -mx-1 my-1 h-px", className)}
			{...props}
		/>
	);
}

function DropdownMenuShortcut({
	className,
	...props
}: React.ComponentProps<"span">) {
	return (
		<span
			data-slot="dropdown-menu-shortcut"
			className={cn(
				"text-muted-foreground ml-auto text-xs tracking-widest",
				className,
			)}
			{...props}
		/>
	);
}

function DropdownMenuSub({
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
	return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />;
}

function DropdownMenuSubTrigger({
	className,
	inset,
	children,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
	inset?: boolean;
}) {
	return (
		<DropdownMenuPrimitive.SubTrigger
			data-slot="dropdown-menu-sub-trigger"
			data-inset={inset}
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8",
				className,
			)}
			{...props}
		>
			{children}
			<ChevronRightIcon className="ml-auto size-4" />
		</DropdownMenuPrimitive.SubTrigger>
	);
}

function DropdownMenuSubContent({
	className,
	...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
	return (
		<DropdownMenuPrimitive.SubContent
			data-slot="dropdown-menu-sub-content"
			className={cn(
				"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
				className,
			)}
			{...props}
		/>
	);
}

export {
	DropdownMenu,
	DropdownMenuPortal,
	DropdownMenuTrigger,
	DropdownMenuContent,
	DropdownMenuGroup,
	DropdownMenuLabel,
	DropdownMenuItem,
	DropdownMenuCheckboxItem,
	DropdownMenuRadioGroup,
	DropdownMenuRadioItem,
	DropdownMenuSeparator,
	DropdownMenuShortcut,
	DropdownMenuSub,
	DropdownMenuSubTrigger,
	DropdownMenuSubContent,
};

================
File: src/components/ui/dropzone.test.tsx
================
/// <reference types="vitest" />
import { fireEvent, render, screen } from "@testing-library/react";
import { vi } from "vitest";
import { DropZone } from "./dropzone";

describe("DropZone", () => {
	it("renders the drop zone UI", () => {
		render(<DropZone onFilesAccepted={() => {}} />);
		// Use a function matcher to match text across element boundaries
		const dropZone = screen.getByRole("button", {
			name: /upload video files/i,
		});
		expect(dropZone.textContent?.toLowerCase()).toContain(
			"drag & drop your .mp4 file here",
		);
		expect(dropZone.textContent?.toLowerCase()).toContain(
			"or click to select from your computer",
		);
	});

	it("calls onFilesAccepted when a file is dropped", () => {
		const handleFilesAccepted = vi.fn();
		render(<DropZone onFilesAccepted={handleFilesAccepted} />);
		const dropZone = screen.getByRole("button", {
			name: /upload video files/i,
		});

		// Create a mock file
		const file = new File(["dummy content"], "test.mp4", { type: "video/mp4" });
		const dataTransfer = {
			files: [file],
			types: ["Files"],
			getData: vi.fn(),
			setData: vi.fn(),
			clearData: vi.fn(),
		};

		fireEvent.dragOver(dropZone, { dataTransfer });
		fireEvent.drop(dropZone, { dataTransfer });

		expect(handleFilesAccepted).toHaveBeenCalledWith([file]);
	});

	it("calls onFilesAccepted when a file is selected via input", () => {
		const handleFilesAccepted = vi.fn();
		render(<DropZone onFilesAccepted={handleFilesAccepted} />);
		const input = screen
			.getByLabelText(/upload video files/i)
			.querySelector("input[type='file']") as HTMLInputElement;

		// Create a mock file list
		const file = new File(["dummy content"], "test.mp4", { type: "video/mp4" });
		Object.defineProperty(input, "files", {
			value: [file],
			writable: false,
		});

		fireEvent.change(input);

		expect(handleFilesAccepted).toHaveBeenCalledWith([file]);
	});
});

================
File: src/components/ui/dropzone.tsx
================
import type React from "react";
import { useRef, useState } from "react";
import { cn } from "../../lib/utils";

interface DropZoneProps {
	onFilesAccepted: (files: FileList | File[]) => void;
	accept?: string;
	multiple?: boolean;
	className?: string;
	disabled?: boolean;
}

export const DropZone: React.FC<DropZoneProps> = ({
	onFilesAccepted,
	accept = ".mp4",
	multiple = false,
	className = "",
	disabled = false,
}) => {
	const [isDragging, setIsDragging] = useState(false);
	const inputRef = useRef<HTMLInputElement>(null);

	const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {
		if (disabled) return;
		e.preventDefault();
		e.stopPropagation();
		setIsDragging(true);
	};

	const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {
		if (disabled) return;
		e.preventDefault();
		e.stopPropagation();
		setIsDragging(false);
	};

	const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {
		if (disabled) return;
		e.preventDefault();
		e.stopPropagation();
		setIsDragging(false);
		if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
			onFilesAccepted(e.dataTransfer.files);
		}
	};

	const handleClick = () => {
		if (disabled) return;
		inputRef.current?.click();
	};

	const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
		if (disabled) return;
		if (e.target.files && e.target.files.length > 0) {
			onFilesAccepted(e.target.files);
		}
	};

	return (
		<div
			className={cn(
				"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 cursor-pointer transition-colors",
				isDragging
					? "border-blue-500 bg-blue-50"
					: "border-gray-300 bg-white hover:border-blue-400",
				className,
			)}
			onDragOver={handleDragOver}
			onDragLeave={handleDragLeave}
			onDrop={handleDrop}
			onClick={handleClick}
			tabIndex={0}
			role="button"
			aria-label="Upload video files"
		>
			<input
				ref={inputRef}
				type="file"
				accept={accept}
				multiple={multiple}
				className="hidden"
				onChange={handleInputChange}
				tabIndex={-1}
			/>
			<div className="flex flex-col items-center">
				<svg
					className="w-12 h-12 text-blue-400 mb-2"
					fill="none"
					stroke="currentColor"
					strokeWidth={2}
					viewBox="0 0 48 48"
				>
					<path
						strokeLinecap="round"
						strokeLinejoin="round"
						d="M24 6v24m0 0l-8-8m8 8l8-8M6 36h36"
					/>
				</svg>
				<span className="text-lg font-medium text-gray-700">
					Drag & drop your <span className="text-blue-500">.mp4</span> file here
				</span>
				<span className="text-sm text-gray-500 mt-1">
					or click to select from your computer
				</span>
			</div>
		</div>
	);
};

export default DropZone;

================
File: src/components/ui/form.tsx
================
import type * as LabelPrimitive from "@radix-ui/react-label";
import { Slot } from "@radix-ui/react-slot";
import * as React from "react";
import {
	Controller,
	type ControllerProps,
	type FieldPath,
	type FieldValues,
	FormProvider,
	useFormContext,
	useFormState,
} from "react-hook-form";

import { Label } from "@/components/ui/label";
import { cn } from "@/lib/utils";

const Form = FormProvider;

type FormFieldContextValue<
	TFieldValues extends FieldValues = FieldValues,
	TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
	name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>(
	{} as FormFieldContextValue,
);

const FormField = <
	TFieldValues extends FieldValues = FieldValues,
	TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
	...props
}: ControllerProps<TFieldValues, TName>) => {
	return (
		<FormFieldContext.Provider value={{ name: props.name }}>
			<Controller {...props} />
		</FormFieldContext.Provider>
	);
};

const useFormField = () => {
	const fieldContext = React.useContext(FormFieldContext);
	const itemContext = React.useContext(FormItemContext);
	const { getFieldState } = useFormContext();
	const formState = useFormState({ name: fieldContext.name });
	const fieldState = getFieldState(fieldContext.name, formState);

	if (!fieldContext) {
		throw new Error("useFormField should be used within <FormField>");
	}

	const { id } = itemContext;

	return {
		id,
		name: fieldContext.name,
		formItemId: `${id}-form-item`,
		formDescriptionId: `${id}-form-item-description`,
		formMessageId: `${id}-form-item-message`,
		...fieldState,
	};
};

type FormItemContextValue = {
	id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>(
	{} as FormItemContextValue,
);

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
	const id = React.useId();

	return (
		<FormItemContext.Provider value={{ id }}>
			<div
				data-slot="form-item"
				className={cn("grid gap-2", className)}
				{...props}
			/>
		</FormItemContext.Provider>
	);
}

function FormLabel({
	className,
	...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
	const { error, formItemId } = useFormField();

	return (
		<Label
			data-slot="form-label"
			data-error={!!error}
			className={cn("data-[error=true]:text-destructive", className)}
			htmlFor={formItemId}
			{...props}
		/>
	);
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
	const { error, formItemId, formDescriptionId, formMessageId } =
		useFormField();

	return (
		<Slot
			data-slot="form-control"
			id={formItemId}
			aria-describedby={
				!error
					? `${formDescriptionId}`
					: `${formDescriptionId} ${formMessageId}`
			}
			aria-invalid={!!error}
			{...props}
		/>
	);
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
	const { formDescriptionId } = useFormField();

	return (
		<p
			data-slot="form-description"
			id={formDescriptionId}
			className={cn("text-muted-foreground text-sm", className)}
			{...props}
		/>
	);
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
	const { error, formMessageId } = useFormField();
	const body = error ? String(error?.message ?? "") : props.children;

	if (!body) {
		return null;
	}

	return (
		<p
			data-slot="form-message"
			id={formMessageId}
			className={cn("text-destructive text-sm", className)}
			{...props}
		>
			{body}
		</p>
	);
}

export {
	useFormField,
	Form,
	FormItem,
	FormLabel,
	FormControl,
	FormDescription,
	FormMessage,
	FormField,
};

================
File: src/components/ui/hover-card.tsx
================
import * as HoverCardPrimitive from "@radix-ui/react-hover-card";
import type * as React from "react";

import { cn } from "@/lib/utils";

function HoverCard({
	...props
}: React.ComponentProps<typeof HoverCardPrimitive.Root>) {
	return <HoverCardPrimitive.Root data-slot="hover-card" {...props} />;
}

function HoverCardTrigger({
	...props
}: React.ComponentProps<typeof HoverCardPrimitive.Trigger>) {
	return (
		<HoverCardPrimitive.Trigger data-slot="hover-card-trigger" {...props} />
	);
}

function HoverCardContent({
	className,
	align = "center",
	sideOffset = 4,
	...props
}: React.ComponentProps<typeof HoverCardPrimitive.Content>) {
	return (
		<HoverCardPrimitive.Portal data-slot="hover-card-portal">
			<HoverCardPrimitive.Content
				data-slot="hover-card-content"
				align={align}
				sideOffset={sideOffset}
				className={cn(
					"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",
					className,
				)}
				{...props}
			/>
		</HoverCardPrimitive.Portal>
	);
}

export { HoverCard, HoverCardTrigger, HoverCardContent };

================
File: src/components/ui/input-otp.tsx
================
"use client";

import { OTPInput, OTPInputContext } from "input-otp";
import { MinusIcon } from "lucide-react";
import * as React from "react";

import { cn } from "@/lib/utils";

function InputOTP({
	className,
	containerClassName,
	...props
}: React.ComponentProps<typeof OTPInput> & {
	containerClassName?: string;
}) {
	return (
		<OTPInput
			data-slot="input-otp"
			containerClassName={cn(
				"flex items-center gap-2 has-disabled:opacity-50",
				containerClassName,
			)}
			className={cn("disabled:cursor-not-allowed", className)}
			{...props}
		/>
	);
}

function InputOTPGroup({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="input-otp-group"
			className={cn("flex items-center", className)}
			{...props}
		/>
	);
}

function InputOTPSlot({
	index,
	className,
	...props
}: React.ComponentProps<"div"> & {
	index: number;
}) {
	const inputOTPContext = React.useContext(OTPInputContext);
	const { char, hasFakeCaret, isActive } = inputOTPContext?.slots[index] ?? {};

	return (
		<div
			data-slot="input-otp-slot"
			data-active={isActive}
			className={cn(
				"data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",
				className,
			)}
			{...props}
		>
			{char}
			{hasFakeCaret && (
				<div className="pointer-events-none absolute inset-0 flex items-center justify-center">
					<div className="animate-caret-blink bg-foreground h-4 w-px duration-1000" />
				</div>
			)}
		</div>
	);
}

function InputOTPSeparator({ ...props }: React.ComponentProps<"div">) {
	return (
		<div data-slot="input-otp-separator" role="separator" {...props}>
			<MinusIcon />
		</div>
	);
}

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };

================
File: src/components/ui/input.tsx
================
import type * as React from "react";

import { cn } from "@/lib/utils";

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
	return (
		<input
			type={type}
			data-slot="input"
			className={cn(
				"file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
				"focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
				"aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
				className,
			)}
			{...props}
		/>
	);
}

export { Input };

================
File: src/components/ui/label.tsx
================
"use client";

import * as LabelPrimitive from "@radix-ui/react-label";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Label({
	className,
	...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
	return (
		<LabelPrimitive.Root
			data-slot="label"
			className={cn(
				"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
				className,
			)}
			{...props}
		/>
	);
}

export { Label };

================
File: src/components/ui/menubar.tsx
================
import * as MenubarPrimitive from "@radix-ui/react-menubar";
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Menubar({
	className,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Root>) {
	return (
		<MenubarPrimitive.Root
			data-slot="menubar"
			className={cn(
				"bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs",
				className,
			)}
			{...props}
		/>
	);
}

function MenubarMenu({
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {
	return <MenubarPrimitive.Menu data-slot="menubar-menu" {...props} />;
}

function MenubarGroup({
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Group>) {
	return <MenubarPrimitive.Group data-slot="menubar-group" {...props} />;
}

function MenubarPortal({
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {
	return <MenubarPrimitive.Portal data-slot="menubar-portal" {...props} />;
}

function MenubarRadioGroup({
	...props
}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {
	return (
		<MenubarPrimitive.RadioGroup data-slot="menubar-radio-group" {...props} />
	);
}

function MenubarTrigger({
	className,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Trigger>) {
	return (
		<MenubarPrimitive.Trigger
			data-slot="menubar-trigger"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none",
				className,
			)}
			{...props}
		/>
	);
}

function MenubarContent({
	className,
	align = "start",
	alignOffset = -4,
	sideOffset = 8,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Content>) {
	return (
		<MenubarPortal>
			<MenubarPrimitive.Content
				data-slot="menubar-content"
				align={align}
				alignOffset={alignOffset}
				sideOffset={sideOffset}
				className={cn(
					"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[12rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-md",
					className,
				)}
				{...props}
			/>
		</MenubarPortal>
	);
}

function MenubarItem({
	className,
	inset,
	variant = "default",
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Item> & {
	inset?: boolean;
	variant?: "default" | "destructive";
}) {
	return (
		<MenubarPrimitive.Item
			data-slot="menubar-item"
			data-inset={inset}
			data-variant={variant}
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		/>
	);
}

function MenubarCheckboxItem({
	className,
	children,
	checked,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.CheckboxItem>) {
	return (
		<MenubarPrimitive.CheckboxItem
			data-slot="menubar-checkbox-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			checked={checked}
			{...props}
		>
			<span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
				<MenubarPrimitive.ItemIndicator>
					<CheckIcon className="size-4" />
				</MenubarPrimitive.ItemIndicator>
			</span>
			{children}
		</MenubarPrimitive.CheckboxItem>
	);
}

function MenubarRadioItem({
	className,
	children,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.RadioItem>) {
	return (
		<MenubarPrimitive.RadioItem
			data-slot="menubar-radio-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-xs py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		>
			<span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
				<MenubarPrimitive.ItemIndicator>
					<CircleIcon className="size-2 fill-current" />
				</MenubarPrimitive.ItemIndicator>
			</span>
			{children}
		</MenubarPrimitive.RadioItem>
	);
}

function MenubarLabel({
	className,
	inset,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Label> & {
	inset?: boolean;
}) {
	return (
		<MenubarPrimitive.Label
			data-slot="menubar-label"
			data-inset={inset}
			className={cn(
				"px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
				className,
			)}
			{...props}
		/>
	);
}

function MenubarSeparator({
	className,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Separator>) {
	return (
		<MenubarPrimitive.Separator
			data-slot="menubar-separator"
			className={cn("bg-border -mx-1 my-1 h-px", className)}
			{...props}
		/>
	);
}

function MenubarShortcut({
	className,
	...props
}: React.ComponentProps<"span">) {
	return (
		<span
			data-slot="menubar-shortcut"
			className={cn(
				"text-muted-foreground ml-auto text-xs tracking-widest",
				className,
			)}
			{...props}
		/>
	);
}

function MenubarSub({
	...props
}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {
	return <MenubarPrimitive.Sub data-slot="menubar-sub" {...props} />;
}

function MenubarSubTrigger({
	className,
	inset,
	children,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.SubTrigger> & {
	inset?: boolean;
}) {
	return (
		<MenubarPrimitive.SubTrigger
			data-slot="menubar-sub-trigger"
			data-inset={inset}
			className={cn(
				"focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-none select-none data-[inset]:pl-8",
				className,
			)}
			{...props}
		>
			{children}
			<ChevronRightIcon className="ml-auto h-4 w-4" />
		</MenubarPrimitive.SubTrigger>
	);
}

function MenubarSubContent({
	className,
	...props
}: React.ComponentProps<typeof MenubarPrimitive.SubContent>) {
	return (
		<MenubarPrimitive.SubContent
			data-slot="menubar-sub-content"
			className={cn(
				"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
				className,
			)}
			{...props}
		/>
	);
}

export {
	Menubar,
	MenubarPortal,
	MenubarMenu,
	MenubarTrigger,
	MenubarContent,
	MenubarGroup,
	MenubarSeparator,
	MenubarLabel,
	MenubarItem,
	MenubarShortcut,
	MenubarCheckboxItem,
	MenubarRadioGroup,
	MenubarRadioItem,
	MenubarSub,
	MenubarSubTrigger,
	MenubarSubContent,
};

================
File: src/components/ui/navigation-menu.tsx
================
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu";
import { cva } from "class-variance-authority";
import { ChevronDownIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function NavigationMenu({
	className,
	children,
	viewport = true,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Root> & {
	viewport?: boolean;
}) {
	return (
		<NavigationMenuPrimitive.Root
			data-slot="navigation-menu"
			data-viewport={viewport}
			className={cn(
				"group/navigation-menu relative flex max-w-max flex-1 items-center justify-center",
				className,
			)}
			{...props}
		>
			{children}
			{viewport && <NavigationMenuViewport />}
		</NavigationMenuPrimitive.Root>
	);
}

function NavigationMenuList({
	className,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.List>) {
	return (
		<NavigationMenuPrimitive.List
			data-slot="navigation-menu-list"
			className={cn(
				"group flex flex-1 list-none items-center justify-center gap-1",
				className,
			)}
			{...props}
		/>
	);
}

function NavigationMenuItem({
	className,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Item>) {
	return (
		<NavigationMenuPrimitive.Item
			data-slot="navigation-menu-item"
			className={cn("relative", className)}
			{...props}
		/>
	);
}

const navigationMenuTriggerStyle = cva(
	"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=open]:hover:bg-accent data-[state=open]:text-accent-foreground data-[state=open]:focus:bg-accent data-[state=open]:bg-accent/50 focus-visible:ring-ring/50 outline-none transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1",
);

function NavigationMenuTrigger({
	className,
	children,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Trigger>) {
	return (
		<NavigationMenuPrimitive.Trigger
			data-slot="navigation-menu-trigger"
			className={cn(navigationMenuTriggerStyle(), "group", className)}
			{...props}
		>
			{children}{" "}
			<ChevronDownIcon
				className="relative top-[1px] ml-1 size-3 transition duration-300 group-data-[state=open]:rotate-180"
				aria-hidden="true"
			/>
		</NavigationMenuPrimitive.Trigger>
	);
}

function NavigationMenuContent({
	className,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Content>) {
	return (
		<NavigationMenuPrimitive.Content
			data-slot="navigation-menu-content"
			className={cn(
				"data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 top-0 left-0 w-full p-2 pr-2.5 md:absolute md:w-auto",
				"group-data-[viewport=false]/navigation-menu:bg-popover group-data-[viewport=false]/navigation-menu:text-popover-foreground group-data-[viewport=false]/navigation-menu:data-[state=open]:animate-in group-data-[viewport=false]/navigation-menu:data-[state=closed]:animate-out group-data-[viewport=false]/navigation-menu:data-[state=closed]:zoom-out-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:zoom-in-95 group-data-[viewport=false]/navigation-menu:data-[state=open]:fade-in-0 group-data-[viewport=false]/navigation-menu:data-[state=closed]:fade-out-0 group-data-[viewport=false]/navigation-menu:top-full group-data-[viewport=false]/navigation-menu:mt-1.5 group-data-[viewport=false]/navigation-menu:overflow-hidden group-data-[viewport=false]/navigation-menu:rounded-md group-data-[viewport=false]/navigation-menu:border group-data-[viewport=false]/navigation-menu:shadow group-data-[viewport=false]/navigation-menu:duration-200 **:data-[slot=navigation-menu-link]:focus:ring-0 **:data-[slot=navigation-menu-link]:focus:outline-none",
				className,
			)}
			{...props}
		/>
	);
}

function NavigationMenuViewport({
	className,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Viewport>) {
	return (
		<div
			className={cn(
				"absolute top-full left-0 isolate z-50 flex justify-center",
			)}
		>
			<NavigationMenuPrimitive.Viewport
				data-slot="navigation-menu-viewport"
				className={cn(
					"origin-top-center bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border shadow md:w-[var(--radix-navigation-menu-viewport-width)]",
					className,
				)}
				{...props}
			/>
		</div>
	);
}

function NavigationMenuLink({
	className,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Link>) {
	return (
		<NavigationMenuPrimitive.Link
			data-slot="navigation-menu-link"
			className={cn(
				"data-[active=true]:focus:bg-accent data-[active=true]:hover:bg-accent data-[active=true]:bg-accent/50 data-[active=true]:text-accent-foreground hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus-visible:ring-ring/50 [&_svg:not([class*='text-'])]:text-muted-foreground flex flex-col gap-1 rounded-sm p-2 text-sm transition-all outline-none focus-visible:ring-[3px] focus-visible:outline-1 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		/>
	);
}

function NavigationMenuIndicator({
	className,
	...props
}: React.ComponentProps<typeof NavigationMenuPrimitive.Indicator>) {
	return (
		<NavigationMenuPrimitive.Indicator
			data-slot="navigation-menu-indicator"
			className={cn(
				"data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden",
				className,
			)}
			{...props}
		>
			<div className="bg-border relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm shadow-md" />
		</NavigationMenuPrimitive.Indicator>
	);
}

export {
	NavigationMenu,
	NavigationMenuList,
	NavigationMenuItem,
	NavigationMenuContent,
	NavigationMenuTrigger,
	NavigationMenuLink,
	NavigationMenuIndicator,
	NavigationMenuViewport,
	navigationMenuTriggerStyle,
};

================
File: src/components/ui/pagination.tsx
================
import {
	ChevronLeftIcon,
	ChevronRightIcon,
	MoreHorizontalIcon,
} from "lucide-react";
import type * as React from "react";

import { type Button, buttonVariants } from "@/components/ui/button";
import { cn } from "@/lib/utils";

function Pagination({ className, ...props }: React.ComponentProps<"nav">) {
	return (
		<nav
			aria-label="pagination"
			data-slot="pagination"
			className={cn("mx-auto flex w-full justify-center", className)}
			{...props}
		/>
	);
}

function PaginationContent({
	className,
	...props
}: React.ComponentProps<"ul">) {
	return (
		<ul
			data-slot="pagination-content"
			className={cn("flex flex-row items-center gap-1", className)}
			{...props}
		/>
	);
}

function PaginationItem({ ...props }: React.ComponentProps<"li">) {
	return <li data-slot="pagination-item" {...props} />;
}

type PaginationLinkProps = {
	isActive?: boolean;
} & Pick<React.ComponentProps<typeof Button>, "size"> &
	React.ComponentProps<"a">;

function PaginationLink({
	className,
	isActive,
	size = "icon",
	...props
}: PaginationLinkProps) {
	return (
		<a
			aria-current={isActive ? "page" : undefined}
			data-slot="pagination-link"
			data-active={isActive}
			className={cn(
				buttonVariants({
					variant: isActive ? "outline" : "ghost",
					size,
				}),
				className,
			)}
			{...props}
		/>
	);
}

function PaginationPrevious({
	className,
	...props
}: React.ComponentProps<typeof PaginationLink>) {
	return (
		<PaginationLink
			aria-label="Go to previous page"
			size="default"
			className={cn("gap-1 px-2.5 sm:pl-2.5", className)}
			{...props}
		>
			<ChevronLeftIcon />
			<span className="hidden sm:block">Previous</span>
		</PaginationLink>
	);
}

function PaginationNext({
	className,
	...props
}: React.ComponentProps<typeof PaginationLink>) {
	return (
		<PaginationLink
			aria-label="Go to next page"
			size="default"
			className={cn("gap-1 px-2.5 sm:pr-2.5", className)}
			{...props}
		>
			<span className="hidden sm:block">Next</span>
			<ChevronRightIcon />
		</PaginationLink>
	);
}

function PaginationEllipsis({
	className,
	...props
}: React.ComponentProps<"span">) {
	return (
		<span
			aria-hidden
			data-slot="pagination-ellipsis"
			className={cn("flex size-9 items-center justify-center", className)}
			{...props}
		>
			<MoreHorizontalIcon className="size-4" />
			<span className="sr-only">More pages</span>
		</span>
	);
}

export {
	Pagination,
	PaginationContent,
	PaginationLink,
	PaginationItem,
	PaginationPrevious,
	PaginationNext,
	PaginationEllipsis,
};

================
File: src/components/ui/popover.tsx
================
"use client";

import * as PopoverPrimitive from "@radix-ui/react-popover";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Popover({
	...props
}: React.ComponentProps<typeof PopoverPrimitive.Root>) {
	return <PopoverPrimitive.Root data-slot="popover" {...props} />;
}

function PopoverTrigger({
	...props
}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {
	return <PopoverPrimitive.Trigger data-slot="popover-trigger" {...props} />;
}

function PopoverContent({
	className,
	align = "center",
	sideOffset = 4,
	...props
}: React.ComponentProps<typeof PopoverPrimitive.Content>) {
	return (
		<PopoverPrimitive.Portal>
			<PopoverPrimitive.Content
				data-slot="popover-content"
				align={align}
				sideOffset={sideOffset}
				className={cn(
					"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",
					className,
				)}
				{...props}
			/>
		</PopoverPrimitive.Portal>
	);
}

function PopoverAnchor({
	...props
}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {
	return <PopoverPrimitive.Anchor data-slot="popover-anchor" {...props} />;
}

export { Popover, PopoverTrigger, PopoverContent, PopoverAnchor };

================
File: src/components/ui/progress-steps.tsx
================
import { cn } from "@/lib/utils";
import { CheckIcon, Loader2 } from "lucide-react";

export type Step = {
	id: string;
	label: string;
	description?: string;
	status: "pending" | "in_progress" | "completed" | "error";
	progress?: number; // 0-100
	errorMessage?: string;
};

type ProgressStepsProps = {
	steps: Step[];
	currentStepId?: string;
	className?: string;
};

export function ProgressSteps({
	steps,
	currentStepId,
	className,
}: ProgressStepsProps) {
	return (
		<div className={cn("w-full space-y-2", className)}>
			<div className="flex items-center justify-between">
				<div className="text-sm font-medium">Processing Status</div>
				<div className="text-xs text-muted-foreground">
					{steps.filter((step) => step.status === "completed").length} of{" "}
					{steps.length} completed
				</div>
			</div>
			<ul className="space-y-3">
				{steps.map((step, i) => {
					const isCurrent = step.id === currentStepId;
					const isCompleted = step.status === "completed";
					const isInProgress = step.status === "in_progress";
					const isError = step.status === "error";

					return (
						<li key={step.id} className="relative">
							<div
								className={cn(
									"group relative flex items-start",
									isCurrent && "animate-in fade-in duration-300",
								)}
							>
								<div
									className={cn(
										"flex h-9 w-9 shrink-0 items-center justify-center rounded-full border",
										isCompleted &&
											"bg-primary border-primary text-primary-foreground",
										isInProgress && "border-primary/70 bg-primary/10",
										isError &&
											"bg-destructive border-destructive text-destructive-foreground",
										!isCompleted &&
											!isInProgress &&
											!isError &&
											"border-muted-foreground/30",
									)}
								>
									{isCompleted && <CheckIcon className="h-4 w-4" />}
									{isInProgress && (
										<Loader2 className="h-4 w-4 animate-spin text-primary" />
									)}
									{isError && <span className="text-xs font-bold">!</span>}
									{!isCompleted && !isInProgress && !isError && (
										<span className="text-xs text-muted-foreground">
											{i + 1}
										</span>
									)}
								</div>

								<div className="ml-4 min-w-0 flex-1">
									<div className="flex items-center justify-between">
										<div
											className={cn(
												"text-sm font-medium",
												isCompleted && "text-foreground",
												isInProgress && "text-primary",
												isError && "text-destructive",
												!isCompleted &&
													!isInProgress &&
													!isError &&
													"text-muted-foreground",
											)}
										>
											{step.label}
										</div>
										{step.status === "in_progress" &&
											step.progress !== undefined && (
												<div className="text-xs text-muted-foreground">
													{step.progress}%
												</div>
											)}
									</div>

									{step.description && (
										<p className="text-xs text-muted-foreground mt-0.5">
											{step.description}
										</p>
									)}

									{isError && step.errorMessage && (
										<p className="text-xs text-destructive mt-1">
											{step.errorMessage}
										</p>
									)}

									{isInProgress && step.progress !== undefined && (
										<div className="mt-2 h-1.5 w-full overflow-hidden rounded-full bg-secondary">
											<div
												className="h-full bg-primary transition-all duration-300 ease-in-out"
												style={{ width: `${step.progress}%` }}
											/>
										</div>
									)}
								</div>
							</div>

							{i < steps.length - 1 && (
								<div
									className={cn(
										"absolute left-4 top-9 h-full w-px -translate-x-1/2 bg-border",
										isCompleted && "bg-primary",
									)}
									aria-hidden="true"
								/>
							)}
						</li>
					);
				})}
			</ul>
		</div>
	);
}

================
File: src/components/ui/progress.tsx
================
import * as ProgressPrimitive from "@radix-ui/react-progress";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Progress({
	className,
	value,
	...props
}: React.ComponentProps<typeof ProgressPrimitive.Root>) {
	return (
		<ProgressPrimitive.Root
			data-slot="progress"
			className={cn(
				"bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",
				className,
			)}
			{...props}
		>
			<ProgressPrimitive.Indicator
				data-slot="progress-indicator"
				className="bg-primary h-full w-full flex-1 transition-all"
				style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
			/>
		</ProgressPrimitive.Root>
	);
}

export { Progress };

================
File: src/components/ui/radio-group.tsx
================
"use client";

import * as RadioGroupPrimitive from "@radix-ui/react-radio-group";
import { CircleIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function RadioGroup({
	className,
	...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {
	return (
		<RadioGroupPrimitive.Root
			data-slot="radio-group"
			className={cn("grid gap-3", className)}
			{...props}
		/>
	);
}

function RadioGroupItem({
	className,
	...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {
	return (
		<RadioGroupPrimitive.Item
			data-slot="radio-group-item"
			className={cn(
				"border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
				className,
			)}
			{...props}
		>
			<RadioGroupPrimitive.Indicator
				data-slot="radio-group-indicator"
				className="relative flex items-center justify-center"
			>
				<CircleIcon className="fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2" />
			</RadioGroupPrimitive.Indicator>
		</RadioGroupPrimitive.Item>
	);
}

export { RadioGroup, RadioGroupItem };

================
File: src/components/ui/resizable.tsx
================
import { GripVerticalIcon } from "lucide-react";
import type * as React from "react";
import * as ResizablePrimitive from "react-resizable-panels";

import { cn } from "@/lib/utils";

function ResizablePanelGroup({
	className,
	...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) {
	return (
		<ResizablePrimitive.PanelGroup
			data-slot="resizable-panel-group"
			className={cn(
				"flex h-full w-full data-[panel-group-direction=vertical]:flex-col",
				className,
			)}
			{...props}
		/>
	);
}

function ResizablePanel({
	...props
}: React.ComponentProps<typeof ResizablePrimitive.Panel>) {
	return <ResizablePrimitive.Panel data-slot="resizable-panel" {...props} />;
}

function ResizableHandle({
	withHandle,
	className,
	...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
	withHandle?: boolean;
}) {
	return (
		<ResizablePrimitive.PanelResizeHandle
			data-slot="resizable-handle"
			className={cn(
				"bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
				className,
			)}
			{...props}
		>
			{withHandle && (
				<div className="bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border">
					<GripVerticalIcon className="size-2.5" />
				</div>
			)}
		</ResizablePrimitive.PanelResizeHandle>
	);
}

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };

================
File: src/components/ui/scroll-area.tsx
================
"use client";

import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area";
import type * as React from "react";

import { cn } from "@/lib/utils";

function ScrollArea({
	className,
	children,
	...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {
	return (
		<ScrollAreaPrimitive.Root
			data-slot="scroll-area"
			className={cn("relative", className)}
			{...props}
		>
			<ScrollAreaPrimitive.Viewport
				data-slot="scroll-area-viewport"
				className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
			>
				{children}
			</ScrollAreaPrimitive.Viewport>
			<ScrollBar />
			<ScrollAreaPrimitive.Corner />
		</ScrollAreaPrimitive.Root>
	);
}

function ScrollBar({
	className,
	orientation = "vertical",
	...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {
	return (
		<ScrollAreaPrimitive.ScrollAreaScrollbar
			data-slot="scroll-area-scrollbar"
			orientation={orientation}
			className={cn(
				"flex touch-none p-px transition-colors select-none",
				orientation === "vertical" &&
					"h-full w-2.5 border-l border-l-transparent",
				orientation === "horizontal" &&
					"h-2.5 flex-col border-t border-t-transparent",
				className,
			)}
			{...props}
		>
			<ScrollAreaPrimitive.ScrollAreaThumb
				data-slot="scroll-area-thumb"
				className="bg-border relative flex-1 rounded-full"
			/>
		</ScrollAreaPrimitive.ScrollAreaScrollbar>
	);
}

export { ScrollArea, ScrollBar };

================
File: src/components/ui/select.tsx
================
import * as SelectPrimitive from "@radix-ui/react-select";
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Select({
	...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
	return <SelectPrimitive.Root data-slot="select" {...props} />;
}

function SelectGroup({
	...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
	return <SelectPrimitive.Group data-slot="select-group" {...props} />;
}

function SelectValue({
	...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
	return <SelectPrimitive.Value data-slot="select-value" {...props} />;
}

function SelectTrigger({
	className,
	size = "default",
	children,
	...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
	size?: "sm" | "default";
}) {
	return (
		<SelectPrimitive.Trigger
			data-slot="select-trigger"
			data-size={size}
			className={cn(
				"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		>
			{children}
			<SelectPrimitive.Icon asChild>
				<ChevronDownIcon className="size-4 opacity-50" />
			</SelectPrimitive.Icon>
		</SelectPrimitive.Trigger>
	);
}

function SelectContent({
	className,
	children,
	position = "popper",
	...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
	return (
		<SelectPrimitive.Portal>
			<SelectPrimitive.Content
				data-slot="select-content"
				className={cn(
					"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
					position === "popper" &&
						"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
					className,
				)}
				position={position}
				{...props}
			>
				<SelectScrollUpButton />
				<SelectPrimitive.Viewport
					className={cn(
						"p-1",
						position === "popper" &&
							"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1",
					)}
				>
					{children}
				</SelectPrimitive.Viewport>
				<SelectScrollDownButton />
			</SelectPrimitive.Content>
		</SelectPrimitive.Portal>
	);
}

function SelectLabel({
	className,
	...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
	return (
		<SelectPrimitive.Label
			data-slot="select-label"
			className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
			{...props}
		/>
	);
}

function SelectItem({
	className,
	children,
	...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
	return (
		<SelectPrimitive.Item
			data-slot="select-item"
			className={cn(
				"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
				className,
			)}
			{...props}
		>
			<span className="absolute right-2 flex size-3.5 items-center justify-center">
				<SelectPrimitive.ItemIndicator>
					<CheckIcon className="size-4" />
				</SelectPrimitive.ItemIndicator>
			</span>
			<SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
		</SelectPrimitive.Item>
	);
}

function SelectSeparator({
	className,
	...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
	return (
		<SelectPrimitive.Separator
			data-slot="select-separator"
			className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
			{...props}
		/>
	);
}

function SelectScrollUpButton({
	className,
	...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
	return (
		<SelectPrimitive.ScrollUpButton
			data-slot="select-scroll-up-button"
			className={cn(
				"flex cursor-default items-center justify-center py-1",
				className,
			)}
			{...props}
		>
			<ChevronUpIcon className="size-4" />
		</SelectPrimitive.ScrollUpButton>
	);
}

function SelectScrollDownButton({
	className,
	...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
	return (
		<SelectPrimitive.ScrollDownButton
			data-slot="select-scroll-down-button"
			className={cn(
				"flex cursor-default items-center justify-center py-1",
				className,
			)}
			{...props}
		>
			<ChevronDownIcon className="size-4" />
		</SelectPrimitive.ScrollDownButton>
	);
}

export {
	Select,
	SelectContent,
	SelectGroup,
	SelectItem,
	SelectLabel,
	SelectScrollDownButton,
	SelectScrollUpButton,
	SelectSeparator,
	SelectTrigger,
	SelectValue,
};

================
File: src/components/ui/separator.tsx
================
"use client";

import * as SeparatorPrimitive from "@radix-ui/react-separator";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Separator({
	className,
	orientation = "horizontal",
	decorative = true,
	...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
	return (
		<SeparatorPrimitive.Root
			data-slot="separator-root"
			decorative={decorative}
			orientation={orientation}
			className={cn(
				"bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
				className,
			)}
			{...props}
		/>
	);
}

export { Separator };

================
File: src/components/ui/sheet.tsx
================
import * as SheetPrimitive from "@radix-ui/react-dialog";
import { XIcon } from "lucide-react";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
	return <SheetPrimitive.Root data-slot="sheet" {...props} />;
}

function SheetTrigger({
	...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
	return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />;
}

function SheetClose({
	...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
	return <SheetPrimitive.Close data-slot="sheet-close" {...props} />;
}

function SheetPortal({
	...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
	return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />;
}

function SheetOverlay({
	className,
	...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
	return (
		<SheetPrimitive.Overlay
			data-slot="sheet-overlay"
			className={cn(
				"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
				className,
			)}
			{...props}
		/>
	);
}

function SheetContent({
	className,
	children,
	side = "right",
	...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
	side?: "top" | "right" | "bottom" | "left";
}) {
	return (
		<SheetPortal>
			<SheetOverlay />
			<SheetPrimitive.Content
				data-slot="sheet-content"
				className={cn(
					"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
					side === "right" &&
						"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
					side === "left" &&
						"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
					side === "top" &&
						"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
					side === "bottom" &&
						"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
					className,
				)}
				{...props}
			>
				{children}
				<SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
					<XIcon className="size-4" />
					<span className="sr-only">Close</span>
				</SheetPrimitive.Close>
			</SheetPrimitive.Content>
		</SheetPortal>
	);
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sheet-header"
			className={cn("flex flex-col gap-1.5 p-4", className)}
			{...props}
		/>
	);
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sheet-footer"
			className={cn("mt-auto flex flex-col gap-2 p-4", className)}
			{...props}
		/>
	);
}

function SheetTitle({
	className,
	...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
	return (
		<SheetPrimitive.Title
			data-slot="sheet-title"
			className={cn("text-foreground font-semibold", className)}
			{...props}
		/>
	);
}

function SheetDescription({
	className,
	...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
	return (
		<SheetPrimitive.Description
			data-slot="sheet-description"
			className={cn("text-muted-foreground text-sm", className)}
			{...props}
		/>
	);
}

export {
	Sheet,
	SheetTrigger,
	SheetClose,
	SheetContent,
	SheetHeader,
	SheetFooter,
	SheetTitle,
	SheetDescription,
};

================
File: src/components/ui/sidebar.tsx
================
"use client";

import { Slot } from "@radix-ui/react-slot";
import { type VariantProps, cva } from "class-variance-authority";
import { PanelLeftIcon } from "lucide-react";
import * as React from "react";

import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Separator } from "@/components/ui/separator";
import {
	Sheet,
	SheetContent,
	SheetDescription,
	SheetHeader,
	SheetTitle,
} from "@/components/ui/sheet";
import { Skeleton } from "@/components/ui/skeleton";
import {
	Tooltip,
	TooltipContent,
	TooltipProvider,
	TooltipTrigger,
} from "@/components/ui/tooltip";
import { useIsMobile } from "@/hooks/use-mobile";
import { cn } from "@/lib/utils";

const SIDEBAR_COOKIE_NAME = "sidebar_state";
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = "16rem";
const SIDEBAR_WIDTH_MOBILE = "18rem";
const SIDEBAR_WIDTH_ICON = "3rem";
const SIDEBAR_KEYBOARD_SHORTCUT = "b";

type SidebarContextProps = {
	state: "expanded" | "collapsed";
	open: boolean;
	setOpen: (open: boolean) => void;
	openMobile: boolean;
	setOpenMobile: (open: boolean) => void;
	isMobile: boolean;
	toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContextProps | null>(null);

function useSidebar() {
	const context = React.useContext(SidebarContext);
	if (!context) {
		throw new Error("useSidebar must be used within a SidebarProvider.");
	}

	return context;
}

function SidebarProvider({
	defaultOpen = true,
	open: openProp,
	onOpenChange: setOpenProp,
	className,
	style,
	children,
	...props
}: React.ComponentProps<"div"> & {
	defaultOpen?: boolean;
	open?: boolean;
	onOpenChange?: (open: boolean) => void;
}) {
	const isMobile = useIsMobile();
	const [openMobile, setOpenMobile] = React.useState(false);

	// This is the internal state of the sidebar.
	// We use openProp and setOpenProp for control from outside the component.
	const [_open, _setOpen] = React.useState(defaultOpen);
	const open = openProp ?? _open;
	const setOpen = React.useCallback(
		(value: boolean | ((value: boolean) => boolean)) => {
			const openState = typeof value === "function" ? value(open) : value;
			if (setOpenProp) {
				setOpenProp(openState);
			} else {
				_setOpen(openState);
			}

			// This sets the cookie to keep the sidebar state.
			document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
		},
		[setOpenProp, open],
	);

	// Helper to toggle the sidebar.
	const toggleSidebar = React.useCallback(() => {
		return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
	}, [isMobile, setOpen, setOpenMobile]);

	// Adds a keyboard shortcut to toggle the sidebar.
	React.useEffect(() => {
		const handleKeyDown = (event: KeyboardEvent) => {
			if (
				event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
				(event.metaKey || event.ctrlKey)
			) {
				event.preventDefault();
				toggleSidebar();
			}
		};

		window.addEventListener("keydown", handleKeyDown);
		return () => window.removeEventListener("keydown", handleKeyDown);
	}, [toggleSidebar]);

	// We add a state so that we can do data-state="expanded" or "collapsed".
	// This makes it easier to style the sidebar with Tailwind classes.
	const state = open ? "expanded" : "collapsed";

	const contextValue = React.useMemo<SidebarContextProps>(
		() => ({
			state,
			open,
			setOpen,
			isMobile,
			openMobile,
			setOpenMobile,
			toggleSidebar,
		}),
		[state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],
	);

	return (
		<SidebarContext.Provider value={contextValue}>
			<TooltipProvider delayDuration={0}>
				<div
					data-slot="sidebar-wrapper"
					style={
						{
							"--sidebar-width": SIDEBAR_WIDTH,
							"--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
							...style,
						} as React.CSSProperties
					}
					className={cn(
						"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",
						className,
					)}
					{...props}
				>
					{children}
				</div>
			</TooltipProvider>
		</SidebarContext.Provider>
	);
}

function Sidebar({
	side = "left",
	variant = "sidebar",
	collapsible = "offcanvas",
	className,
	children,
	...props
}: React.ComponentProps<"div"> & {
	side?: "left" | "right";
	variant?: "sidebar" | "floating" | "inset";
	collapsible?: "offcanvas" | "icon" | "none";
}) {
	const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

	if (collapsible === "none") {
		return (
			<div
				data-slot="sidebar"
				className={cn(
					"bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",
					className,
				)}
				{...props}
			>
				{children}
			</div>
		);
	}

	if (isMobile) {
		return (
			<Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
				<SheetContent
					data-sidebar="sidebar"
					data-slot="sidebar"
					data-mobile="true"
					className="bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden"
					style={
						{
							"--sidebar-width": SIDEBAR_WIDTH_MOBILE,
						} as React.CSSProperties
					}
					side={side}
				>
					<SheetHeader className="sr-only">
						<SheetTitle>Sidebar</SheetTitle>
						<SheetDescription>Displays the mobile sidebar.</SheetDescription>
					</SheetHeader>
					<div className="flex h-full w-full flex-col">{children}</div>
				</SheetContent>
			</Sheet>
		);
	}

	return (
		<div
			className="group peer text-sidebar-foreground hidden md:block"
			data-state={state}
			data-collapsible={state === "collapsed" ? collapsible : ""}
			data-variant={variant}
			data-side={side}
			data-slot="sidebar"
		>
			{/* This is what handles the sidebar gap on desktop */}
			<div
				data-slot="sidebar-gap"
				className={cn(
					"relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear",
					"group-data-[collapsible=offcanvas]:w-0",
					"group-data-[side=right]:rotate-180",
					variant === "floating" || variant === "inset"
						? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]"
						: "group-data-[collapsible=icon]:w-(--sidebar-width-icon)",
				)}
			/>
			<div
				data-slot="sidebar-container"
				className={cn(
					"fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",
					side === "left"
						? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
						: "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
					// Adjust the padding for floating and inset variants.
					variant === "floating" || variant === "inset"
						? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]"
						: "group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",
					className,
				)}
				{...props}
			>
				<div
					data-sidebar="sidebar"
					data-slot="sidebar-inner"
					className="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"
				>
					{children}
				</div>
			</div>
		</div>
	);
}

function SidebarTrigger({
	className,
	onClick,
	...props
}: React.ComponentProps<typeof Button>) {
	const { toggleSidebar } = useSidebar();

	return (
		<Button
			data-sidebar="trigger"
			data-slot="sidebar-trigger"
			variant="ghost"
			size="icon"
			className={cn("size-7", className)}
			onClick={(event) => {
				onClick?.(event);
				toggleSidebar();
			}}
			{...props}
		>
			<PanelLeftIcon />
			<span className="sr-only">Toggle Sidebar</span>
		</Button>
	);
}

function SidebarRail({ className, ...props }: React.ComponentProps<"button">) {
	const { toggleSidebar } = useSidebar();

	return (
		<button
			data-sidebar="rail"
			data-slot="sidebar-rail"
			aria-label="Toggle Sidebar"
			tabIndex={-1}
			onClick={toggleSidebar}
			title="Toggle Sidebar"
			className={cn(
				"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex",
				"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize",
				"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
				"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full",
				"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
				"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarInset({ className, ...props }: React.ComponentProps<"main">) {
	return (
		<main
			data-slot="sidebar-inset"
			className={cn(
				"bg-background relative flex w-full flex-1 flex-col",
				"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarInput({
	className,
	...props
}: React.ComponentProps<typeof Input>) {
	return (
		<Input
			data-slot="sidebar-input"
			data-sidebar="input"
			className={cn("bg-background h-8 w-full shadow-none", className)}
			{...props}
		/>
	);
}

function SidebarHeader({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sidebar-header"
			data-sidebar="header"
			className={cn("flex flex-col gap-2 p-2", className)}
			{...props}
		/>
	);
}

function SidebarFooter({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sidebar-footer"
			data-sidebar="footer"
			className={cn("flex flex-col gap-2 p-2", className)}
			{...props}
		/>
	);
}

function SidebarSeparator({
	className,
	...props
}: React.ComponentProps<typeof Separator>) {
	return (
		<Separator
			data-slot="sidebar-separator"
			data-sidebar="separator"
			className={cn("bg-sidebar-border mx-2 w-auto", className)}
			{...props}
		/>
	);
}

function SidebarContent({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sidebar-content"
			data-sidebar="content"
			className={cn(
				"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarGroup({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sidebar-group"
			data-sidebar="group"
			className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
			{...props}
		/>
	);
}

function SidebarGroupLabel({
	className,
	asChild = false,
	...props
}: React.ComponentProps<"div"> & { asChild?: boolean }) {
	const Comp = asChild ? Slot : "div";

	return (
		<Comp
			data-slot="sidebar-group-label"
			data-sidebar="group-label"
			className={cn(
				"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
				"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarGroupAction({
	className,
	asChild = false,
	...props
}: React.ComponentProps<"button"> & { asChild?: boolean }) {
	const Comp = asChild ? Slot : "button";

	return (
		<Comp
			data-slot="sidebar-group-action"
			data-sidebar="group-action"
			className={cn(
				"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
				// Increases the hit area of the button on mobile.
				"after:absolute after:-inset-2 md:after:hidden",
				"group-data-[collapsible=icon]:hidden",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarGroupContent({
	className,
	...props
}: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sidebar-group-content"
			data-sidebar="group-content"
			className={cn("w-full text-sm", className)}
			{...props}
		/>
	);
}

function SidebarMenu({ className, ...props }: React.ComponentProps<"ul">) {
	return (
		<ul
			data-slot="sidebar-menu"
			data-sidebar="menu"
			className={cn("flex w-full min-w-0 flex-col gap-1", className)}
			{...props}
		/>
	);
}

function SidebarMenuItem({ className, ...props }: React.ComponentProps<"li">) {
	return (
		<li
			data-slot="sidebar-menu-item"
			data-sidebar="menu-item"
			className={cn("group/menu-item relative", className)}
			{...props}
		/>
	);
}

const sidebarMenuButtonVariants = cva(
	"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
	{
		variants: {
			variant: {
				default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
				outline:
					"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
			},
			size: {
				default: "h-8 text-sm",
				sm: "h-7 text-xs",
				lg: "h-12 text-sm group-data-[collapsible=icon]:p-0!",
			},
		},
		defaultVariants: {
			variant: "default",
			size: "default",
		},
	},
);

function SidebarMenuButton({
	asChild = false,
	isActive = false,
	variant = "default",
	size = "default",
	tooltip,
	className,
	...props
}: React.ComponentProps<"button"> & {
	asChild?: boolean;
	isActive?: boolean;
	tooltip?: string | React.ComponentProps<typeof TooltipContent>;
} & VariantProps<typeof sidebarMenuButtonVariants>) {
	const Comp = asChild ? Slot : "button";
	const { isMobile, state } = useSidebar();

	const button = (
		<Comp
			data-slot="sidebar-menu-button"
			data-sidebar="menu-button"
			data-size={size}
			data-active={isActive}
			className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
			{...props}
		/>
	);

	if (!tooltip) {
		return button;
	}

	if (typeof tooltip === "string") {
		tooltip = {
			children: tooltip,
		};
	}

	return (
		<Tooltip>
			<TooltipTrigger asChild>{button}</TooltipTrigger>
			<TooltipContent
				side="right"
				align="center"
				hidden={state !== "collapsed" || isMobile}
				{...tooltip}
			/>
		</Tooltip>
	);
}

function SidebarMenuAction({
	className,
	asChild = false,
	showOnHover = false,
	...props
}: React.ComponentProps<"button"> & {
	asChild?: boolean;
	showOnHover?: boolean;
}) {
	const Comp = asChild ? Slot : "button";

	return (
		<Comp
			data-slot="sidebar-menu-action"
			data-sidebar="menu-action"
			className={cn(
				"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
				// Increases the hit area of the button on mobile.
				"after:absolute after:-inset-2 md:after:hidden",
				"peer-data-[size=sm]/menu-button:top-1",
				"peer-data-[size=default]/menu-button:top-1.5",
				"peer-data-[size=lg]/menu-button:top-2.5",
				"group-data-[collapsible=icon]:hidden",
				showOnHover &&
					"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarMenuBadge({
	className,
	...props
}: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="sidebar-menu-badge"
			data-sidebar="menu-badge"
			className={cn(
				"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none",
				"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
				"peer-data-[size=sm]/menu-button:top-1",
				"peer-data-[size=default]/menu-button:top-1.5",
				"peer-data-[size=lg]/menu-button:top-2.5",
				"group-data-[collapsible=icon]:hidden",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarMenuSkeleton({
	className,
	showIcon = false,
	...props
}: React.ComponentProps<"div"> & {
	showIcon?: boolean;
}) {
	// Random width between 50 to 90%.
	const width = React.useMemo(() => {
		return `${Math.floor(Math.random() * 40) + 50}%`;
	}, []);

	return (
		<div
			data-slot="sidebar-menu-skeleton"
			data-sidebar="menu-skeleton"
			className={cn("flex h-8 items-center gap-2 rounded-md px-2", className)}
			{...props}
		>
			{showIcon && (
				<Skeleton
					className="size-4 rounded-md"
					data-sidebar="menu-skeleton-icon"
				/>
			)}
			<Skeleton
				className="h-4 max-w-(--skeleton-width) flex-1"
				data-sidebar="menu-skeleton-text"
				style={
					{
						"--skeleton-width": width,
					} as React.CSSProperties
				}
			/>
		</div>
	);
}

function SidebarMenuSub({ className, ...props }: React.ComponentProps<"ul">) {
	return (
		<ul
			data-slot="sidebar-menu-sub"
			data-sidebar="menu-sub"
			className={cn(
				"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5",
				"group-data-[collapsible=icon]:hidden",
				className,
			)}
			{...props}
		/>
	);
}

function SidebarMenuSubItem({
	className,
	...props
}: React.ComponentProps<"li">) {
	return (
		<li
			data-slot="sidebar-menu-sub-item"
			data-sidebar="menu-sub-item"
			className={cn("group/menu-sub-item relative", className)}
			{...props}
		/>
	);
}

function SidebarMenuSubButton({
	asChild = false,
	size = "md",
	isActive = false,
	className,
	...props
}: React.ComponentProps<"a"> & {
	asChild?: boolean;
	size?: "sm" | "md";
	isActive?: boolean;
}) {
	const Comp = asChild ? Slot : "a";

	return (
		<Comp
			data-slot="sidebar-menu-sub-button"
			data-sidebar="menu-sub-button"
			data-size={size}
			data-active={isActive}
			className={cn(
				"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
				"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
				size === "sm" && "text-xs",
				size === "md" && "text-sm",
				"group-data-[collapsible=icon]:hidden",
				className,
			)}
			{...props}
		/>
	);
}

export {
	Sidebar,
	SidebarContent,
	SidebarFooter,
	SidebarGroup,
	SidebarGroupAction,
	SidebarGroupContent,
	SidebarGroupLabel,
	SidebarHeader,
	SidebarInput,
	SidebarInset,
	SidebarMenu,
	SidebarMenuAction,
	SidebarMenuBadge,
	SidebarMenuButton,
	SidebarMenuItem,
	SidebarMenuSkeleton,
	SidebarMenuSub,
	SidebarMenuSubButton,
	SidebarMenuSubItem,
	SidebarProvider,
	SidebarRail,
	SidebarSeparator,
	SidebarTrigger,
	useSidebar,
};

================
File: src/components/ui/skeleton.tsx
================
import { cn } from "@/lib/utils";

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
	return (
		<div
			data-slot="skeleton"
			className={cn("bg-accent animate-pulse rounded-md", className)}
			{...props}
		/>
	);
}

export { Skeleton };

================
File: src/components/ui/slider.tsx
================
"use client";

import * as SliderPrimitive from "@radix-ui/react-slider";
import * as React from "react";

import { cn } from "@/lib/utils";

function Slider({
	className,
	defaultValue,
	value,
	min = 0,
	max = 100,
	...props
}: React.ComponentProps<typeof SliderPrimitive.Root>) {
	const _values = React.useMemo(
		() =>
			Array.isArray(value)
				? value
				: Array.isArray(defaultValue)
					? defaultValue
					: [min, max],
		[value, defaultValue, min, max],
	);

	return (
		<SliderPrimitive.Root
			data-slot="slider"
			defaultValue={defaultValue}
			value={value}
			min={min}
			max={max}
			className={cn(
				"relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",
				className,
			)}
			{...props}
		>
			<SliderPrimitive.Track
				data-slot="slider-track"
				className={cn(
					"bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5",
				)}
			>
				<SliderPrimitive.Range
					data-slot="slider-range"
					className={cn(
						"bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full",
					)}
				/>
			</SliderPrimitive.Track>
			{Array.from({ length: _values.length }, (_, index) => (
				<SliderPrimitive.Thumb
					data-slot="slider-thumb"
					key={index}
					className="border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"
				/>
			))}
		</SliderPrimitive.Root>
	);
}

export { Slider };

================
File: src/components/ui/sonner.tsx
================
import { useTheme } from "next-themes";
import { Toaster as Sonner, type ToasterProps } from "sonner";

const Toaster = ({ ...props }: ToasterProps) => {
	const { theme = "system" } = useTheme();

	return (
		<Sonner
			theme={theme as ToasterProps["theme"]}
			className="toaster group"
			style={
				{
					"--normal-bg": "var(--popover)",
					"--normal-text": "var(--popover-foreground)",
					"--normal-border": "var(--border)",
				} as React.CSSProperties
			}
			{...props}
		/>
	);
};

export { Toaster };

================
File: src/components/ui/switch.tsx
================
"use client";

import * as SwitchPrimitive from "@radix-ui/react-switch";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Switch({
	className,
	...props
}: React.ComponentProps<typeof SwitchPrimitive.Root>) {
	return (
		<SwitchPrimitive.Root
			data-slot="switch"
			className={cn(
				"peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
				className,
			)}
			{...props}
		>
			<SwitchPrimitive.Thumb
				data-slot="switch-thumb"
				className={cn(
					"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0",
				)}
			/>
		</SwitchPrimitive.Root>
	);
}

export { Switch };

================
File: src/components/ui/table.tsx
================
import type * as React from "react";

import { cn } from "@/lib/utils";

function Table({ className, ...props }: React.ComponentProps<"table">) {
	return (
		<div
			data-slot="table-container"
			className="relative w-full overflow-x-auto"
		>
			<table
				data-slot="table"
				className={cn("w-full caption-bottom text-sm", className)}
				{...props}
			/>
		</div>
	);
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
	return (
		<thead
			data-slot="table-header"
			className={cn("[&_tr]:border-b", className)}
			{...props}
		/>
	);
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
	return (
		<tbody
			data-slot="table-body"
			className={cn("[&_tr:last-child]:border-0", className)}
			{...props}
		/>
	);
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
	return (
		<tfoot
			data-slot="table-footer"
			className={cn(
				"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
				className,
			)}
			{...props}
		/>
	);
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
	return (
		<tr
			data-slot="table-row"
			className={cn(
				"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
				className,
			)}
			{...props}
		/>
	);
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
	return (
		<th
			data-slot="table-head"
			className={cn(
				"text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
				className,
			)}
			{...props}
		/>
	);
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
	return (
		<td
			data-slot="table-cell"
			className={cn(
				"p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
				className,
			)}
			{...props}
		/>
	);
}

function TableCaption({
	className,
	...props
}: React.ComponentProps<"caption">) {
	return (
		<caption
			data-slot="table-caption"
			className={cn("text-muted-foreground mt-4 text-sm", className)}
			{...props}
		/>
	);
}

export {
	Table,
	TableHeader,
	TableBody,
	TableFooter,
	TableHead,
	TableRow,
	TableCell,
	TableCaption,
};

================
File: src/components/ui/tabs.tsx
================
"use client";

import * as TabsPrimitive from "@radix-ui/react-tabs";
import type * as React from "react";

import { cn } from "@/lib/utils";

function Tabs({
	className,
	...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
	return (
		<TabsPrimitive.Root
			data-slot="tabs"
			className={cn("flex flex-col gap-2", className)}
			{...props}
		/>
	);
}

function TabsList({
	className,
	...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
	return (
		<TabsPrimitive.List
			data-slot="tabs-list"
			className={cn(
				"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",
				className,
			)}
			{...props}
		/>
	);
}

function TabsTrigger({
	className,
	...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
	return (
		<TabsPrimitive.Trigger
			data-slot="tabs-trigger"
			className={cn(
				"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
				className,
			)}
			{...props}
		/>
	);
}

function TabsContent({
	className,
	...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
	return (
		<TabsPrimitive.Content
			data-slot="tabs-content"
			className={cn("flex-1 outline-none", className)}
			{...props}
		/>
	);
}

export { Tabs, TabsList, TabsTrigger, TabsContent };

================
File: src/components/ui/textarea.tsx
================
import type * as React from "react";

import { cn } from "@/lib/utils";

function Textarea({ className, ...props }: React.ComponentProps<"textarea">) {
	return (
		<textarea
			data-slot="textarea"
			className={cn(
				"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
				className,
			)}
			{...props}
		/>
	);
}

export { Textarea };

================
File: src/components/ui/toast.tsx
================
"use client";

import * as ToastPrimitives from "@radix-ui/react-toast";
import { type VariantProps, cva } from "class-variance-authority";
import { X } from "lucide-react";
import * as React from "react";

import { cn } from "../../lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Viewport>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Viewport
		ref={ref}
		className={cn(
			"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
			className,
		)}
		{...props}
	/>
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
	"group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
	{
		variants: {
			variant: {
				default: "border bg-background text-foreground",
				destructive:
					"destructive group border-destructive bg-destructive text-destructive-foreground",
			},
		},
		defaultVariants: {
			variant: "default",
		},
	},
);

const Toast = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Root>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
		VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
	return (
		<ToastPrimitives.Root
			ref={ref}
			className={cn(toastVariants({ variant }), className)}
			{...props}
		/>
	);
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Action>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Action
		ref={ref}
		className={cn(
			"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
			className,
		)}
		{...props}
	/>
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Close>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Close
		ref={ref}
		className={cn(
			"absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
			className,
		)}
		toast-close=""
		{...props}
	>
		<X className="h-4 w-4" />
	</ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Title>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Title
		ref={ref}
		className={cn("text-sm font-semibold [&+div]:text-xs", className)}
		{...props}
	/>
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Description>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Description
		ref={ref}
		className={cn("text-sm opacity-90", className)}
		{...props}
	/>
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
	type ToastProps,
	type ToastActionElement,
	ToastProvider,
	ToastViewport,
	Toast,
	ToastTitle,
	ToastDescription,
	ToastClose,
	ToastAction,
};

================
File: src/components/ui/toaster.tsx
================
"use client";

import * as ToastPrimitives from "@radix-ui/react-toast";
import { type VariantProps, cva } from "class-variance-authority";
import { X } from "lucide-react";
import * as React from "react";

import { cn } from "../../lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Viewport>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Viewport
		ref={ref}
		className={cn(
			"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
			className,
		)}
		{...props}
	/>
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
	"group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
	{
		variants: {
			variant: {
				default: "border bg-background text-foreground",
				destructive:
					"destructive group border-destructive bg-destructive text-destructive-foreground",
			},
		},
		defaultVariants: {
			variant: "default",
		},
	},
);

const Toast = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Root>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
		VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
	return (
		<ToastPrimitives.Root
			ref={ref}
			className={cn(toastVariants({ variant }), className)}
			{...props}
		/>
	);
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Action>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Action
		ref={ref}
		className={cn(
			"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
			className,
		)}
		{...props}
	/>
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Close>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Close
		ref={ref}
		className={cn(
			"absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
			className,
		)}
		toast-close=""
		{...props}
	>
		<X className="h-4 w-4" />
	</ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Title>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Title
		ref={ref}
		className={cn("text-sm font-semibold [&+div]:text-xs", className)}
		{...props}
	/>
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Description>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Description
		ref={ref}
		className={cn("text-sm opacity-90", className)}
		{...props}
	/>
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
	type ToastProps,
	type ToastActionElement,
	ToastProvider,
	ToastViewport,
	Toast,
	ToastTitle,
	ToastDescription,
	ToastClose,
	ToastAction,
};

================
File: src/components/ui/toggle-group.tsx
================
"use client";

import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group";
import type { VariantProps } from "class-variance-authority";
import * as React from "react";

import { toggleVariants } from "@/components/ui/toggle";
import { cn } from "@/lib/utils";

const ToggleGroupContext = React.createContext<
	VariantProps<typeof toggleVariants>
>({
	size: "default",
	variant: "default",
});

function ToggleGroup({
	className,
	variant,
	size,
	children,
	...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Root> &
	VariantProps<typeof toggleVariants>) {
	return (
		<ToggleGroupPrimitive.Root
			data-slot="toggle-group"
			data-variant={variant}
			data-size={size}
			className={cn(
				"group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",
				className,
			)}
			{...props}
		>
			<ToggleGroupContext.Provider value={{ variant, size }}>
				{children}
			</ToggleGroupContext.Provider>
		</ToggleGroupPrimitive.Root>
	);
}

function ToggleGroupItem({
	className,
	children,
	variant,
	size,
	...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Item> &
	VariantProps<typeof toggleVariants>) {
	const context = React.useContext(ToggleGroupContext);

	return (
		<ToggleGroupPrimitive.Item
			data-slot="toggle-group-item"
			data-variant={context.variant || variant}
			data-size={context.size || size}
			className={cn(
				toggleVariants({
					variant: context.variant || variant,
					size: context.size || size,
				}),
				"min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",
				className,
			)}
			{...props}
		>
			{children}
		</ToggleGroupPrimitive.Item>
	);
}

export { ToggleGroup, ToggleGroupItem };

================
File: src/components/ui/toggle.tsx
================
import * as TogglePrimitive from "@radix-ui/react-toggle";
import { type VariantProps, cva } from "class-variance-authority";
import type * as React from "react";

import { cn } from "@/lib/utils";

const toggleVariants = cva(
	"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",
	{
		variants: {
			variant: {
				default: "bg-transparent",
				outline:
					"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground",
			},
			size: {
				default: "h-9 px-2 min-w-9",
				sm: "h-8 px-1.5 min-w-8",
				lg: "h-10 px-2.5 min-w-10",
			},
		},
		defaultVariants: {
			variant: "default",
			size: "default",
		},
	},
);

function Toggle({
	className,
	variant,
	size,
	...props
}: React.ComponentProps<typeof TogglePrimitive.Root> &
	VariantProps<typeof toggleVariants>) {
	return (
		<TogglePrimitive.Root
			data-slot="toggle"
			className={cn(toggleVariants({ variant, size, className }))}
			{...props}
		/>
	);
}

export { Toggle, toggleVariants };

================
File: src/components/ui/tooltip.tsx
================
import * as TooltipPrimitive from "@radix-ui/react-tooltip";
import type * as React from "react";

import { cn } from "@/lib/utils";

function TooltipProvider({
	delayDuration = 0,
	...props
}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
	return (
		<TooltipPrimitive.Provider
			data-slot="tooltip-provider"
			delayDuration={delayDuration}
			{...props}
		/>
	);
}

function Tooltip({
	...props
}: React.ComponentProps<typeof TooltipPrimitive.Root>) {
	return (
		<TooltipProvider>
			<TooltipPrimitive.Root data-slot="tooltip" {...props} />
		</TooltipProvider>
	);
}

function TooltipTrigger({
	...props
}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
	return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />;
}

function TooltipContent({
	className,
	sideOffset = 0,
	children,
	...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
	return (
		<TooltipPrimitive.Portal>
			<TooltipPrimitive.Content
				data-slot="tooltip-content"
				sideOffset={sideOffset}
				className={cn(
					"bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",
					className,
				)}
				{...props}
			>
				{children}
				<TooltipPrimitive.Arrow className="bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
			</TooltipPrimitive.Content>
		</TooltipPrimitive.Portal>
	);
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };

================
File: src/components/ui/use-toast.tsx
================
"use client";

import * as ToastPrimitives from "@radix-ui/react-toast";
import { type VariantProps, cva } from "class-variance-authority";
import { X } from "lucide-react";
import * as React from "react";

import { cn } from "../../lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Viewport>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Viewport
		ref={ref}
		className={cn(
			"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
			className,
		)}
		{...props}
	/>
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
	"group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
	{
		variants: {
			variant: {
				default: "border bg-background text-foreground",
				destructive:
					"destructive group border-destructive bg-destructive text-destructive-foreground",
			},
		},
		defaultVariants: {
			variant: "default",
		},
	},
);

const Toast = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Root>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
		VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
	return (
		<ToastPrimitives.Root
			ref={ref}
			className={cn(toastVariants({ variant }), className)}
			{...props}
		/>
	);
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Action>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Action
		ref={ref}
		className={cn(
			"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
			className,
		)}
		{...props}
	/>
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Close>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Close
		ref={ref}
		className={cn(
			"absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
			className,
		)}
		toast-close=""
		{...props}
	>
		<X className="h-4 w-4" />
	</ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Title>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Title
		ref={ref}
		className={cn("text-sm font-semibold [&+div]:text-xs", className)}
		{...props}
	/>
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
	React.ElementRef<typeof ToastPrimitives.Description>,
	React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
	<ToastPrimitives.Description
		ref={ref}
		className={cn("text-sm opacity-90", className)}
		{...props}
	/>
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
	type ToastProps,
	type ToastActionElement,
	ToastProvider,
	ToastViewport,
	Toast,
	ToastTitle,
	ToastDescription,
	ToastClose,
	ToastAction,
};

================
File: src/components/video/content-editor.tsx
================
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";
import { Loader2, Pencil, Save, X } from "lucide-react";
import { useEffect, useState } from "react";

type ContentEditorProps = {
	content: string;
	isLoading?: boolean;
	errorMessage?: string;
	onSave?: (content: string) => Promise<void>;
	className?: string;
	readOnly?: boolean;
	placeholder?: string;
	maxHeight?: string;
};

export function ContentEditor({
	content,
	isLoading = false,
	errorMessage,
	onSave,
	className = "",
	readOnly = false,
	placeholder = "Content not available yet",
	maxHeight = "400px",
}: ContentEditorProps) {
	const [isEditing, setIsEditing] = useState(false);
	const [editedContent, setEditedContent] = useState(content);
	const [isSaving, setIsSaving] = useState(false);
	const [saveError, setSaveError] = useState<string | null>(null);

	// Update edited content when the source content changes
	useEffect(() => {
		setEditedContent(content);
	}, [content]);

	const handleEdit = () => {
		setIsEditing(true);
		setSaveError(null);
	};

	const handleCancel = () => {
		setIsEditing(false);
		setEditedContent(content);
		setSaveError(null);
	};

	const handleSave = async () => {
		if (!onSave) return;
		setIsSaving(true);
		setSaveError(null);

		try {
			await onSave(editedContent);
			setIsEditing(false);
		} catch (error) {
			setSaveError(
				error instanceof Error ? error.message : "Error saving content",
			);
		} finally {
			setIsSaving(false);
		}
	};

	if (isLoading) {
		return (
			<div className="flex justify-center items-center p-8">
				<Loader2 className="h-6 w-6 animate-spin mr-2" />
				<span>Loading content...</span>
			</div>
		);
	}

	if (errorMessage) {
		return (
			<div className="p-4 border border-red-200 rounded-md bg-red-50 text-red-600">
				<p className="font-medium">Error loading content</p>
				<p className="text-sm mt-1">{errorMessage}</p>
			</div>
		);
	}

	if (!content.trim() && !isEditing) {
		return (
			<div className="flex flex-col items-center justify-center p-8 text-center text-muted-foreground">
				<p>{placeholder}</p>
				{!readOnly && onSave && (
					<Button
						variant="outline"
						size="sm"
						onClick={handleEdit}
						className="mt-4"
					>
						<Pencil className="h-4 w-4 mr-2" />
						Create Content
					</Button>
				)}
			</div>
		);
	}

	return (
		<div className={`relative ${className}`}>
			{isEditing ? (
				<>
					<Textarea
						value={editedContent}
						onChange={(e) => setEditedContent(e.target.value)}
						className={`min-h-[200px] font-mono text-sm p-4 ${saveError ? "border-red-300" : ""}`}
						placeholder="Enter content here..."
						disabled={isSaving}
					/>

					{saveError && (
						<div className="mt-2 p-2 text-sm text-red-600 bg-red-50 rounded-md">
							{saveError}
						</div>
					)}

					<div className="flex justify-end gap-2 mt-4">
						<Button
							variant="outline"
							size="sm"
							onClick={handleCancel}
							disabled={isSaving}
						>
							<X className="h-4 w-4 mr-1" />
							Cancel
						</Button>
						<Button size="sm" onClick={handleSave} disabled={isSaving}>
							{isSaving ? (
								<>
									<Loader2 className="h-4 w-4 mr-2 animate-spin" />
									Saving...
								</>
							) : (
								<>
									<Save className="h-4 w-4 mr-1" />
									Save Changes
								</>
							)}
						</Button>
					</div>
				</>
			) : (
				<>
					<div
						className={`overflow-y-auto p-4 font-mono text-sm whitespace-pre-wrap border rounded-md ${
							!readOnly
								? "hover:border-primary hover:bg-accent/10 transition-colors"
								: ""
						}`}
						style={{ maxHeight }}
					>
						{content}
					</div>

					{!readOnly && onSave && (
						<Button
							variant="ghost"
							size="sm"
							onClick={handleEdit}
							className="absolute top-2 right-2"
						>
							<Pencil className="h-4 w-4" />
						</Button>
					)}
				</>
			)}
		</div>
	);
}

================
File: src/components/video/processing-dashboard.tsx
================
import { Button } from "@/components/ui/button";
import { Link } from "@tanstack/react-router";
import { collection, onSnapshot, query, where } from "firebase/firestore";
import type { DocumentData, QuerySnapshot } from "firebase/firestore";
import { PlusIcon } from "lucide-react";
import { useEffect, useState } from "react";
import { db } from "../../../firebase/index";
import {
	ProcessingStepId,
	createMockProcessingSteps,
} from "./processing-steps";
import { VideoProgressCard } from "./video-progress-card";

// Map backend processing stages to frontend steps
const stageToStepMap: Record<string, number> = {
	uploaded: 0,
	audio_extraction: 1,
	transcript_generation: 2,
	subtitle_generation: 3,
	shownote_generation: 4,
	chapter_generation: 5,
	title_generation: 6,
	youtube_upload: 7,
	completed: 8,
};

// Helper to determine the current step index based on backend stage
function getCurrentStepIndex(stage?: string): number {
	if (!stage) return 0;
	return stageToStepMap[stage] || 0;
}

function getVideoStatus(
	stage?: string,
): "processing" | "completed" | "error" | "paused" {
	if (!stage) return "processing";
	if (stage === "completed") return "completed";
	if (stage === "error") return "error";
	if (stage === "paused") return "paused";
	return "processing";
}

interface VideoData extends DocumentData {
	id: string;
	title?: string;
	current_stage?: string;
	filename?: string;
	channel?: string;
	created_at?: any; // Timestamp from Firestore
	youtube_video_id?: string;
	thumbnails?: Array<{ url: string; prompt: string; status: string }>;
	error_message?: string;
}

type ProcessingDashboardProps = {
	className?: string;
};

export function ProcessingDashboard({ className }: ProcessingDashboardProps) {
	const [videos, setVideos] = useState<VideoData[]>([]);
	const [loading, setLoading] = useState(true);

	// Fetch videos in processing status
	useEffect(() => {
		const processingVideosQuery = query(
			collection(db, "videos"),
			where("current_stage", "!=", "completed"),
		);

		const unsubscribe = onSnapshot(
			processingVideosQuery,
			(snapshot: QuerySnapshot<DocumentData>) => {
				const vids = snapshot.docs.map((doc) => ({
					id: doc.id,
					...doc.data(),
				})) as VideoData[];
				setVideos(vids);
				setLoading(false);
			},
			(error) => {
				console.error("Error fetching processing videos:", error);
				setLoading(false);
			},
		);

		return () => unsubscribe();
	}, []);

	// Pause/resume functionality would require backend support
	const handlePauseResume = (videoId: string) => {
		console.log(
			"Pause/resume functionality would require backend support",
			videoId,
		);
		// In a real implementation, this would update the Firestore document
	};

	// Get the current step ID based on current_stage
	const getCurrentStepId = (video: VideoData) => {
		const stepIndex = getCurrentStepIndex(video.current_stage);
		const steps = Object.keys(ProcessingStepId);
		return steps[stepIndex];
	};

	return (
		<div className={className}>
			<div className="flex items-center justify-between mb-8">
				<div>
					<h1 className="text-2xl font-bold tracking-tight">
						Video Processing
					</h1>
					<p className="text-muted-foreground text-sm mt-1">
						Track the status of your video processing tasks
					</p>
				</div>
				<Button asChild>
					<Link to="/upload">
						<PlusIcon className="h-4 w-4 mr-2" />
						Upload New Video
					</Link>
				</Button>
			</div>

			{loading ? (
				<div className="flex justify-center py-20">
					<div className="animate-pulse">Loading videos...</div>
				</div>
			) : videos.length === 0 ? (
				<div className="flex flex-col items-center justify-center py-20 text-center">
					<p className="text-muted-foreground mb-4">
						No videos currently processing
					</p>
					<Button asChild variant="outline">
						<Link to="/upload">Upload a new video</Link>
					</Button>
				</div>
			) : (
				<div className="grid gap-6 sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3">
					{videos.map((video) => {
						// Get current step index and ID
						const stepIndex = getCurrentStepIndex(video.current_stage);
						const currentStepId = getCurrentStepId(video);

						// Create processing steps with appropriate status
						const processingSteps = createMockProcessingSteps(stepIndex);

						// If there's an error, update the error step
						if (video.error_message) {
							// Find the step that corresponds to the current stage
							const currentStep = processingSteps.find(
								(step) => step.id === currentStepId,
							);
							if (currentStep) {
								currentStep.status = "error";
								currentStep.errorMessage = video.error_message;
							}
						}

						// Create YouTube URL if available
						const youtubeUrl = video.youtube_video_id
							? `https://youtube.com/watch?v=${video.youtube_video_id}`
							: undefined;

						// Get thumbnail if available
						const thumbnailUrl =
							video.thumbnails && video.thumbnails.length > 0
								? video.thumbnails[0].url
								: undefined;

						// Create upload date from timestamp
						const uploadedAt = video.created_at
							? new Date(video.created_at.seconds * 1000)
							: new Date();

						return (
							<VideoProgressCard
								key={video.id}
								videoId={video.id}
								videoTitle={video.title || "Untitled Video"}
								thumbnailUrl={thumbnailUrl}
								uploadedAt={uploadedAt}
								status={getVideoStatus(video.current_stage)}
								processingSteps={processingSteps}
								currentStepId={currentStepId}
								youtubeUrl={youtubeUrl}
								onPauseResume={() => handlePauseResume(video.id)}
							/>
						);
					})}
				</div>
			)}
		</div>
	);
}

================
File: src/components/video/processing-steps.ts
================
import type { Step } from "@/components/ui/progress-steps";

// Define the IDs for our processing steps
export enum ProcessingStepId {
	UPLOAD = "upload",
	AUDIO_EXTRACTION = "audio_extraction",
	TRANSCRIPT = "transcript",
	SUBTITLES = "subtitles",
	SHOWNOTES = "shownotes",
	CHAPTERS = "chapters",
	TITLE = "title",
	YOUTUBE_UPLOAD = "youtube_upload",
}

// Define static step metadata
export const PROCESSING_STEPS_META = {
	[ProcessingStepId.UPLOAD]: {
		label: "Video Upload",
		description: "Uploading video file to secure storage",
		progressPercentage: 10,
	},
	[ProcessingStepId.AUDIO_EXTRACTION]: {
		label: "Audio Extraction",
		description: "Extracting audio track for transcription",
		progressPercentage: 15,
	},
	[ProcessingStepId.TRANSCRIPT]: {
		label: "Transcript Generation",
		description: "Creating full text transcript from audio",
		progressPercentage: 15,
	},
	[ProcessingStepId.SUBTITLES]: {
		label: "Subtitles Generation",
		description: "Creating timestamped VTT subtitles",
		progressPercentage: 15,
	},
	[ProcessingStepId.SHOWNOTES]: {
		label: "Shownotes Generation",
		description: "Creating detailed show notes and summary",
		progressPercentage: 15,
	},
	[ProcessingStepId.CHAPTERS]: {
		label: "Chapters Generation",
		description: "Creating timestamped chapters",
		progressPercentage: 15,
	},
	[ProcessingStepId.TITLE]: {
		label: "Title & Keywords",
		description: "Creating optimized title and keywords",
		progressPercentage: 5,
	},
	[ProcessingStepId.YOUTUBE_UPLOAD]: {
		label: "YouTube Upload",
		description: "Uploading to YouTube with metadata",
		progressPercentage: 10,
	},
};

// Create the processing steps in the proper order
export const ORDERED_PROCESSING_STEPS = Object.keys(PROCESSING_STEPS_META).map(
	(id) => ({
		id,
		...PROCESSING_STEPS_META[id as ProcessingStepId],
	}),
);

// Initialize all steps to pending
export function initializeProcessingSteps(): Step[] {
	return Object.entries(PROCESSING_STEPS_META).map(([id, meta]) => ({
		id,
		label: meta.label,
		description: meta.description,
		status: "pending" as const,
	}));
}

// Update step status in the array
export function updateStepStatus(
	steps: Step[],
	stepId: ProcessingStepId,
	status: Step["status"],
	options?: { progress?: number; errorMessage?: string },
): Step[] {
	return steps.map((step) => {
		if (step.id === stepId) {
			return {
				...step,
				status,
				progress: options?.progress,
				errorMessage: options?.errorMessage,
			};
		}
		return step;
	});
}

// Calculate the overall progress percentage
export function calculateOverallProgress(steps: Step[]): number {
	// If all steps are completed, return 100%
	if (steps.every((step) => step.status === "completed")) {
		return 100;
	}

	let totalProgress = 0;
	let completedProgress = 0;

	steps.forEach((step) => {
		const stepMeta = PROCESSING_STEPS_META[step.id as ProcessingStepId];
		const weight = stepMeta.progressPercentage;

		totalProgress += weight;

		if (step.status === "completed") {
			completedProgress += weight;
		} else if (step.status === "in_progress" && step.progress !== undefined) {
			// For in-progress steps, add a portion based on its progress
			completedProgress += (weight * step.progress) / 100;
		}
	});

	return Math.round((completedProgress / totalProgress) * 100);
}

// Mock step progress for UI development/testing
export function createMockProcessingSteps(currentStepIndex: number): Step[] {
	const orderedStepIds = Object.keys(PROCESSING_STEPS_META);

	return orderedStepIds.map((id, index) => {
		const meta = PROCESSING_STEPS_META[id as ProcessingStepId];

		let status: Step["status"] = "pending";
		let progress: number | undefined = undefined;

		if (index < currentStepIndex) {
			status = "completed";
		} else if (index === currentStepIndex) {
			status = "in_progress";
			progress = Math.floor(Math.random() * 100);
		}

		return {
			id,
			label: meta.label,
			description: meta.description,
			status,
			progress,
		};
	});
}

================
File: src/components/video/thumbnail-gallery.tsx
================
import { Button } from "@/components/ui/button";
import {
	Card,
	CardContent,
	CardDescription,
	CardFooter,
	CardHeader,
	CardTitle,
} from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Textarea } from "@/components/ui/textarea";
import { cn } from "@/lib/utils";
import {
	Check,
	Edit2,
	Image,
	Loader2,
	RefreshCw,
	Sparkles,
} from "lucide-react";
import { useState } from "react";

export type Thumbnail = {
	id: string;
	url: string;
	prompt: string;
	isSelected?: boolean;
	status: "ready" | "generating" | "failed";
	error?: string;
};

type ThumbnailGalleryProps = {
	videoId: string;
	thumbnails: Thumbnail[];
	onSelect: (thumbnailId: string) => void;
	onRegenerateAll: () => void;
	onRegenerateSingle: (thumbnailId: string, newPrompt: string) => void;
	onApply: (thumbnailId: string) => void;
	onCustomUpload?: (file: File) => void;
	className?: string;
	isGenerating?: boolean;
};

export function ThumbnailGallery({
	videoId,
	thumbnails,
	onSelect,
	onRegenerateAll,
	onRegenerateSingle,
	onApply,
	onCustomUpload,
	className,
	isGenerating = false,
}: ThumbnailGalleryProps) {
	const [editingThumbnailId, setEditingThumbnailId] = useState<string | null>(
		null,
	);
	const [editPrompt, setEditPrompt] = useState("");
	const [customUploadFile, setCustomUploadFile] = useState<File | null>(null);

	const selectedThumbnail = thumbnails.find((thumb) => thumb.isSelected);

	const handleEditStart = (thumbnail: Thumbnail) => {
		setEditingThumbnailId(thumbnail.id);
		setEditPrompt(thumbnail.prompt);
	};

	const handleEditSave = (thumbnailId: string) => {
		if (editPrompt.trim()) {
			onRegenerateSingle(thumbnailId, editPrompt.trim());
			setEditingThumbnailId(null);
		}
	};

	const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
		if (e.target.files && e.target.files.length > 0) {
			setCustomUploadFile(e.target.files[0]);
		}
	};

	const handleCustomUpload = () => {
		if (customUploadFile && onCustomUpload) {
			onCustomUpload(customUploadFile);
			setCustomUploadFile(null);
		}
	};

	return (
		<Card className={className}>
			<CardHeader>
				<CardTitle className="flex justify-between items-center">
					<span>Thumbnail Options</span>
					<Button
						size="sm"
						variant="outline"
						onClick={onRegenerateAll}
						disabled={isGenerating}
						className="gap-1"
					>
						{isGenerating ? (
							<>
								<Loader2 className="h-3.5 w-3.5 animate-spin" />
								Generating...
							</>
						) : (
							<>
								<Sparkles className="h-3.5 w-3.5" />
								Generate New Set
							</>
						)}
					</Button>
				</CardTitle>
				<CardDescription>
					Select or customize the thumbnail for your video
				</CardDescription>
			</CardHeader>

			<CardContent>
				<Tabs defaultValue="gallery">
					<TabsList className="grid w-full grid-cols-2 mb-4">
						<TabsTrigger value="gallery">AI Generated</TabsTrigger>
						<TabsTrigger value="custom">Custom Upload</TabsTrigger>
					</TabsList>

					<TabsContent value="gallery" className="space-y-4">
						{/* Selected Thumbnail Preview */}
						{selectedThumbnail && (
							<div className="space-y-2">
								<Label className="text-xs text-muted-foreground">
									Selected Thumbnail
								</Label>
								<div className="aspect-video bg-muted rounded-md overflow-hidden relative">
									<img
										src={selectedThumbnail.url}
										alt="Selected thumbnail"
										className="w-full h-full object-cover"
									/>
									<div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity">
										<Button
											variant="secondary"
											size="sm"
											onClick={() => handleEditStart(selectedThumbnail)}
										>
											Edit Prompt
										</Button>
									</div>
								</div>
							</div>
						)}

						{/* Thumbnail Grid */}
						<div className="grid grid-cols-2 gap-3">
							{thumbnails.map((thumbnail) => (
								<div
									key={thumbnail.id}
									className={cn(
										"relative group rounded-md overflow-hidden border-2 aspect-video",
										thumbnail.isSelected
											? "border-primary"
											: "border-transparent",
									)}
								>
									{/* Thumbnail Image */}
									{thumbnail.status === "generating" ? (
										<div className="w-full h-full bg-muted flex items-center justify-center">
											<Loader2 className="h-6 w-6 animate-spin text-muted-foreground" />
										</div>
									) : thumbnail.status === "failed" ? (
										<div className="w-full h-full bg-destructive/10 flex flex-col items-center justify-center p-2">
											<span className="text-xs text-destructive font-medium">
												Generation Failed
											</span>
											{thumbnail.error && (
												<span className="text-[10px] text-muted-foreground text-center mt-1">
													{thumbnail.error}
												</span>
											)}
										</div>
									) : (
										<img
											src={thumbnail.url}
											alt={`Thumbnail option ${thumbnail.id}`}
											className="w-full h-full object-cover"
										/>
									)}

									{/* Overlay with Actions */}
									{thumbnail.status === "ready" && (
										<div className="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2">
											<div className="flex gap-1">
												<Button
													size="sm"
													variant="secondary"
													className="h-8"
													onClick={() => handleEditStart(thumbnail)}
												>
													<Edit2 className="h-3.5 w-3.5 mr-1" />
													Edit
												</Button>
												<Button
													size="sm"
													variant={thumbnail.isSelected ? "default" : "outline"}
													className="h-8"
													onClick={() => onSelect(thumbnail.id)}
												>
													<Check className="h-3.5 w-3.5 mr-1" />
													{thumbnail.isSelected ? "Selected" : "Select"}
												</Button>
											</div>
											<p className="text-[10px] text-white/70 px-2 text-center line-clamp-2 mt-1">
												{thumbnail.prompt}
											</p>
										</div>
									)}
								</div>
							))}
						</div>

						{/* Edit Prompt Dialog */}
						{editingThumbnailId && (
							<div className="mt-4 border rounded-md p-3 space-y-3">
								<Label htmlFor="thumbnail-prompt">Edit Thumbnail Prompt</Label>
								<Textarea
									id="thumbnail-prompt"
									value={editPrompt}
									onChange={(e) => setEditPrompt(e.target.value)}
									placeholder="Describe what you want in this thumbnail..."
									className="resize-none min-h-[100px]"
								/>
								<div className="flex justify-end gap-2">
									<Button
										variant="outline"
										size="sm"
										onClick={() => setEditingThumbnailId(null)}
									>
										Cancel
									</Button>
									<Button
										size="sm"
										onClick={() => handleEditSave(editingThumbnailId)}
										disabled={!editPrompt.trim()}
									>
										Regenerate
									</Button>
								</div>
							</div>
						)}
					</TabsContent>

					<TabsContent value="custom" className="space-y-4">
						<div className="border-2 border-dashed rounded-md p-4 text-center">
							<div className="flex flex-col items-center justify-center gap-2">
								<Image className="h-8 w-8 text-muted-foreground" />
								<div className="space-y-1">
									<p className="text-sm font-medium">Upload Custom Thumbnail</p>
									<p className="text-xs text-muted-foreground">
										PNG, JPG, or WEBP up to 2MB
									</p>
								</div>

								<Input
									type="file"
									accept="image/png,image/jpeg,image/webp"
									className="max-w-xs mt-2"
									onChange={handleFileChange}
								/>

								{customUploadFile && (
									<div className="mt-2 w-full max-w-xs">
										<p className="text-xs text-muted-foreground truncate">
											{customUploadFile.name} (
											{Math.round(customUploadFile.size / 1024)} KB)
										</p>
										<Button
											className="w-full mt-2"
											size="sm"
											onClick={handleCustomUpload}
										>
											Upload & Use This Thumbnail
										</Button>
									</div>
								)}
							</div>
						</div>

						<div className="text-xs text-muted-foreground">
							<p>Image requirements:</p>
							<ul className="list-disc pl-5 space-y-1 mt-1">
								<li>1280x720 pixels (16:9 aspect ratio)</li>
								<li>Less than 2MB in size</li>
								<li>PNG, JPG, or WEBP format</li>
								<li>High-contrast images work best</li>
							</ul>
						</div>
					</TabsContent>
				</Tabs>
			</CardContent>

			<CardFooter>
				<Button
					className="w-full"
					disabled={!selectedThumbnail}
					onClick={() => selectedThumbnail && onApply(selectedThumbnail.id)}
				>
					Apply Selected Thumbnail
				</Button>
			</CardFooter>
		</Card>
	);
}

================
File: src/components/video/title-selector.tsx
================
import { Button } from "@/components/ui/button";
import {
	Card,
	CardContent,
	CardDescription,
	CardFooter,
	CardHeader,
	CardTitle,
} from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { cn } from "@/lib/utils";
import { Check, Edit2, RefreshCw, Sparkles, ThumbsUp } from "lucide-react";
import { useState } from "react";

export type TitleOption = {
	id: string;
	text: string;
	votes?: number;
	isSelected?: boolean;
};

type TitleSelectorProps = {
	videoId: string;
	titleOptions: TitleOption[];
	onSelect: (titleId: string) => void;
	onEdit: (titleId: string, newText: string) => void;
	onVote: (titleId: string) => void;
	onGenerateMore: () => void;
	onApply: (titleId: string) => void;
	className?: string;
	maxDisplayedOptions?: number;
};

export function TitleSelector({
	videoId,
	titleOptions,
	onSelect,
	onEdit,
	onVote,
	onGenerateMore,
	onApply,
	className,
	maxDisplayedOptions = 5,
}: TitleSelectorProps) {
	const [editingTitleId, setEditingTitleId] = useState<string | null>(null);
	const [editText, setEditText] = useState("");
	const [showAllOptions, setShowAllOptions] = useState(false);

	const sortedOptions = [...titleOptions].sort(
		(a, b) => (b.votes || 0) - (a.votes || 0),
	);

	const displayedOptions = showAllOptions
		? sortedOptions
		: sortedOptions.slice(0, maxDisplayedOptions);

	const selectedTitle = sortedOptions.find((title) => title.isSelected);

	const handleEditStart = (title: TitleOption) => {
		setEditingTitleId(title.id);
		setEditText(title.text);
	};

	const handleEditSave = () => {
		if (editingTitleId && editText.trim()) {
			onEdit(editingTitleId, editText.trim());
			setEditingTitleId(null);
		}
	};

	const handleEditCancel = () => {
		setEditingTitleId(null);
	};

	return (
		<Card className={className}>
			<CardHeader>
				<CardTitle className="flex justify-between items-center">
					<span>Video Title Options</span>
					<Button
						size="sm"
						variant="outline"
						onClick={onGenerateMore}
						className="gap-1"
					>
						<Sparkles className="h-3.5 w-3.5" />
						Generate More
					</Button>
				</CardTitle>
				<CardDescription>
					Select the best title for your video or create your own
				</CardDescription>
			</CardHeader>

			<CardContent className="space-y-4">
				{/* Selected Title Preview */}
				{selectedTitle && (
					<div className="p-3 border rounded-md bg-muted/50">
						<div className="text-xs text-muted-foreground mb-1">
							Selected Title
						</div>
						<div className="font-medium">{selectedTitle.text}</div>
					</div>
				)}

				{/* Title Options */}
				<div className="space-y-3">
					{displayedOptions.map((title) => (
						<div
							key={title.id}
							className={cn(
								"p-3 border rounded-md relative transition",
								title.isSelected
									? "border-primary/50 bg-primary/5"
									: "hover:border-border/80",
							)}
						>
							{editingTitleId === title.id ? (
								<div className="space-y-2">
									<Input
										value={editText}
										onChange={(e) => setEditText(e.target.value)}
										className="w-full"
										autoFocus
									/>
									<div className="flex space-x-2 justify-end">
										<Button
											size="sm"
											variant="ghost"
											onClick={handleEditCancel}
										>
											Cancel
										</Button>
										<Button size="sm" onClick={handleEditSave}>
											Save
										</Button>
									</div>
								</div>
							) : (
								<>
									<div className="mr-16 text-sm">{title.text}</div>
									<div className="absolute right-3 top-3 flex items-center space-x-2">
										<Button
											size="icon"
											variant="ghost"
											className="h-7 w-7"
											onClick={() => onVote(title.id)}
										>
											<ThumbsUp className="h-3.5 w-3.5" />
											{title.votes && title.votes > 0 && (
												<span className="absolute -top-0.5 -right-0.5 bg-primary text-[10px] text-primary-foreground w-4 h-4 flex items-center justify-center rounded-full">
													{title.votes}
												</span>
											)}
										</Button>
										<Button
											size="icon"
											variant="ghost"
											className="h-7 w-7"
											onClick={() => handleEditStart(title)}
										>
											<Edit2 className="h-3.5 w-3.5" />
										</Button>
										<Button
											size="icon"
											variant="ghost"
											className={cn(
												"h-7 w-7",
												title.isSelected && "text-primary",
											)}
											onClick={() => onSelect(title.id)}
										>
											<Check className="h-3.5 w-3.5" />
										</Button>
									</div>
								</>
							)}
						</div>
					))}

					{titleOptions.length > maxDisplayedOptions && (
						<Button
							variant="ghost"
							size="sm"
							className="w-full text-xs"
							onClick={() => setShowAllOptions(!showAllOptions)}
						>
							{showAllOptions
								? "Show Less"
								: `Show ${titleOptions.length - maxDisplayedOptions} More Options`}
						</Button>
					)}
				</div>
			</CardContent>

			<CardFooter>
				<Button
					className="w-full"
					disabled={!selectedTitle}
					onClick={() => selectedTitle && onApply(selectedTitle.id)}
				>
					Apply Selected Title
				</Button>
			</CardFooter>
		</Card>
	);
}

================
File: src/components/video/video-detail.tsx
================
import { Button } from "@/components/ui/button";
import {
	Card,
	CardContent,
	CardDescription,
	CardHeader,
	CardTitle,
} from "@/components/ui/card";
import { ProgressSteps, type Step } from "@/components/ui/progress-steps";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { tryFetchContent } from "@/services/gcs-content";
import { Link } from "@tanstack/react-router";
import {
	ArrowLeft,
	CheckCircle,
	Download,
	ExternalLink,
	Loader2,
	type LucideIcon,
} from "lucide-react";
import { useEffect, useState } from "react";
import { ContentEditor } from "./content-editor";
import { calculateOverallProgress } from "./processing-steps";

type VideoAsset = {
	type: string;
	label: string;
	url: string;
	icon: LucideIcon;
	sizeKB?: number;
};

type VideoDetailProps = {
	videoId: string;
	videoTitle: string;
	videoUrl: string;
	thumbnailUrl?: string;
	processingSteps: Step[];
	currentStepId?: string;
	youtubeUrl?: string;
	status: "processing" | "completed" | "error" | "paused";
	assets?: VideoAsset[];
	className?: string;
	// Content related props
	output_files?: Record<string, string>;
	bucket_name?: string;
	onSaveContent?: (contentType: string, content: string) => Promise<void>;
};

export function VideoDetail({
	videoId,
	videoTitle,
	videoUrl,
	thumbnailUrl,
	processingSteps,
	currentStepId,
	youtubeUrl,
	status,
	assets = [],
	className,
	output_files = {},
	bucket_name,
	onSaveContent,
}: VideoDetailProps) {
	const overallProgress = calculateOverallProgress(processingSteps);
	const isCompleted = status === "completed";

	// State for content
	const [transcript, setTranscript] = useState<string>("");
	const [subtitles, setSubtitles] = useState<string>("");
	const [chapters, setChapters] = useState<string>("");
	const [shownotes, setShownotes] = useState<string>("");

	// Loading states
	const [loadingTranscript, setLoadingTranscript] = useState<boolean>(false);
	const [loadingSubtitles, setLoadingSubtitles] = useState<boolean>(false);
	const [loadingChapters, setLoadingChapters] = useState<boolean>(false);
	const [loadingShownotes, setLoadingShownotes] = useState<boolean>(false);

	// Error states
	const [transcriptError, setTranscriptError] = useState<string | null>(null);
	const [subtitlesError, setSubtitlesError] = useState<string | null>(null);
	const [chaptersError, setChaptersError] = useState<string | null>(null);
	const [shownotesError, setShownotesError] = useState<string | null>(null);

	// Active tab
	const [activeContentTab, setActiveContentTab] =
		useState<string>("transcript");

	// Effect to load content based on active tab
	useEffect(() => {
		if (!bucket_name || status !== "completed") return;

		const fetchContent = async () => {
			// Only fetch content for the active tab to save bandwidth
			switch (activeContentTab) {
				case "transcript":
					if (transcript || loadingTranscript) return;
					setLoadingTranscript(true);
					setTranscriptError(null);
					try {
						const content = await tryFetchContent(
							bucket_name,
							output_files,
							"transcript",
						);
						setTranscript(content || "");
					} catch (error) {
						setTranscriptError(
							error instanceof Error
								? error.message
								: "Failed to load transcript",
						);
					} finally {
						setLoadingTranscript(false);
					}
					break;

				case "subtitles":
					if (subtitles || loadingSubtitles) return;
					setLoadingSubtitles(true);
					setSubtitlesError(null);
					try {
						const content = await tryFetchContent(
							bucket_name,
							output_files,
							"subtitles",
						);
						setSubtitles(content || "");
					} catch (error) {
						setSubtitlesError(
							error instanceof Error
								? error.message
								: "Failed to load subtitles",
						);
					} finally {
						setLoadingSubtitles(false);
					}
					break;

				case "chapters":
					if (chapters || loadingChapters) return;
					setLoadingChapters(true);
					setChaptersError(null);
					try {
						const content = await tryFetchContent(
							bucket_name,
							output_files,
							"chapters",
						);
						setChapters(content || "");
					} catch (error) {
						setChaptersError(
							error instanceof Error
								? error.message
								: "Failed to load chapters",
						);
					} finally {
						setLoadingChapters(false);
					}
					break;

				case "shownotes":
					if (shownotes || loadingShownotes) return;
					setLoadingShownotes(true);
					setShownotesError(null);
					try {
						const content = await tryFetchContent(
							bucket_name,
							output_files,
							"shownotes",
						);
						setShownotes(content || "");
					} catch (error) {
						setShownotesError(
							error instanceof Error
								? error.message
								: "Failed to load shownotes",
						);
					} finally {
						setLoadingShownotes(false);
					}
					break;
			}
		};

		fetchContent();
	}, [
		activeContentTab,
		bucket_name,
		output_files,
		status,
		transcript,
		subtitles,
		chapters,
		shownotes,
		loadingTranscript,
		loadingSubtitles,
		loadingChapters,
		loadingShownotes,
	]);

	// Handle save operations for different content types
	const handleSaveTranscript = async (content: string) => {
		if (!onSaveContent) throw new Error("Save function not provided");
		await onSaveContent("transcript", content);
		setTranscript(content);
	};

	const handleSaveSubtitles = async (content: string) => {
		if (!onSaveContent) throw new Error("Save function not provided");
		await onSaveContent("subtitles", content);
		setSubtitles(content);
	};

	const handleSaveChapters = async (content: string) => {
		if (!onSaveContent) throw new Error("Save function not provided");
		await onSaveContent("chapters", content);
		setChapters(content);
	};

	const handleSaveShownotes = async (content: string) => {
		if (!onSaveContent) throw new Error("Save function not provided");
		await onSaveContent("shownotes", content);
		setShownotes(content);
	};

	return (
		<div className={className}>
			<div className="mb-6">
				<Link
					to="/dashboard"
					className="inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-4"
				>
					<ArrowLeft className="mr-2 h-4 w-4" />
					Back to dashboard
				</Link>

				<div className="flex items-center justify-between">
					<h1 className="text-2xl font-bold tracking-tight line-clamp-1">
						{videoTitle}
					</h1>
					{youtubeUrl && (
						<Button variant="outline" size="sm" asChild>
							<a href={youtubeUrl} target="_blank" rel="noopener noreferrer">
								<ExternalLink className="mr-2 h-4 w-4" />
								View on YouTube
							</a>
						</Button>
					)}
				</div>

				<div className="text-sm text-muted-foreground mt-1">ID: {videoId}</div>
			</div>

			<div className="grid gap-6 md:grid-cols-2">
				<div className="md:col-span-1 space-y-6">
					{/* Video Preview */}
					<Card>
						<CardHeader className="pb-2">
							<CardTitle className="text-base">Video Preview</CardTitle>
						</CardHeader>
						<CardContent>
							<div className="aspect-video bg-muted rounded-md overflow-hidden">
								{status === "completed" ? (
									<video
										src={videoUrl}
										poster={thumbnailUrl}
										controls
										className="w-full h-full object-cover"
									/>
								) : thumbnailUrl ? (
									<img
										src={thumbnailUrl}
										alt={videoTitle}
										className="w-full h-full object-cover"
									/>
								) : (
									<div className="w-full h-full flex items-center justify-center text-muted-foreground">
										Processing video...
									</div>
								)}
							</div>
						</CardContent>
					</Card>

					{/* Status Card */}
					<Card>
						<CardHeader className="pb-2">
							<div className="flex items-center justify-between">
								<CardTitle className="text-base">Processing Status</CardTitle>
								{isCompleted && (
									<div className="flex items-center text-xs font-medium text-primary">
										<CheckCircle className="mr-1 h-3 w-3" />
										Complete
									</div>
								)}
								{!isCompleted && (
									<div className="text-xs font-medium text-muted-foreground">
										{overallProgress}% complete
									</div>
								)}
							</div>
						</CardHeader>
						<CardContent>
							<ProgressSteps
								steps={processingSteps}
								currentStepId={currentStepId}
							/>
						</CardContent>
					</Card>
				</div>

				<div className="md:col-span-1 space-y-6">
					{/* Generated Content */}
					<Card>
						<CardHeader>
							<CardTitle className="text-base">Generated Content</CardTitle>
							<CardDescription>
								Assets created during video processing
							</CardDescription>
						</CardHeader>
						<CardContent>
							<Tabs
								value={activeContentTab}
								onValueChange={setActiveContentTab}
							>
								<TabsList className="grid grid-cols-4 mb-4">
									<TabsTrigger value="transcript">Transcript</TabsTrigger>
									<TabsTrigger value="subtitles">Subtitles</TabsTrigger>
									<TabsTrigger value="chapters">Chapters</TabsTrigger>
									<TabsTrigger value="shownotes">Shownotes</TabsTrigger>
								</TabsList>

								<TabsContent value="transcript" className="space-y-4">
									{isCompleted ? (
										<ContentEditor
											content={transcript}
											isLoading={loadingTranscript}
											errorMessage={transcriptError || undefined}
											onSave={onSaveContent ? handleSaveTranscript : undefined}
											readOnly={!onSaveContent}
											placeholder="Transcript not available"
											maxHeight="400px"
										/>
									) : (
										<div className="flex flex-col items-center justify-center py-8 text-center text-muted-foreground">
											<p>Transcript not yet generated</p>
											<p className="text-xs mt-1">
												This will be available once processing is complete
											</p>
										</div>
									)}
								</TabsContent>

								<TabsContent value="subtitles" className="space-y-4">
									{isCompleted ? (
										<ContentEditor
											content={subtitles}
											isLoading={loadingSubtitles}
											errorMessage={subtitlesError || undefined}
											onSave={onSaveContent ? handleSaveSubtitles : undefined}
											readOnly={!onSaveContent}
											placeholder="Subtitles not available"
											maxHeight="400px"
										/>
									) : (
										<div className="flex flex-col items-center justify-center py-8 text-center text-muted-foreground">
											<p>Subtitles not yet generated</p>
											<p className="text-xs mt-1">
												This will be available once processing is complete
											</p>
										</div>
									)}
								</TabsContent>

								<TabsContent value="chapters" className="space-y-4">
									{isCompleted ? (
										<ContentEditor
											content={chapters}
											isLoading={loadingChapters}
											errorMessage={chaptersError || undefined}
											onSave={onSaveContent ? handleSaveChapters : undefined}
											readOnly={!onSaveContent}
											placeholder="Chapters not available"
											maxHeight="400px"
										/>
									) : (
										<div className="flex flex-col items-center justify-center py-8 text-center text-muted-foreground">
											<p>Chapters not yet generated</p>
											<p className="text-xs mt-1">
												This will be available once processing is complete
											</p>
										</div>
									)}
								</TabsContent>

								<TabsContent value="shownotes" className="space-y-4">
									{isCompleted ? (
										<ContentEditor
											content={shownotes}
											isLoading={loadingShownotes}
											errorMessage={shownotesError || undefined}
											onSave={onSaveContent ? handleSaveShownotes : undefined}
											readOnly={!onSaveContent}
											placeholder="Show notes not available"
											maxHeight="400px"
										/>
									) : (
										<div className="flex flex-col items-center justify-center py-8 text-center text-muted-foreground">
											<p>Show notes not yet generated</p>
											<p className="text-xs mt-1">
												This will be available once processing is complete
											</p>
										</div>
									)}
								</TabsContent>
							</Tabs>
						</CardContent>
					</Card>

					{/* Download Assets */}
					{isCompleted && assets.length > 0 && (
						<Card>
							<CardHeader className="pb-2">
								<CardTitle className="text-base">Download Assets</CardTitle>
							</CardHeader>
							<CardContent>
								<ul className="divide-y">
									{assets.map((asset, index) => (
										<li key={index} className="py-2 first:pt-0 last:pb-0">
											<div className="flex items-center justify-between">
												<div className="flex items-center">
													<asset.icon className="h-4 w-4 text-muted-foreground mr-2" />
													<span className="text-sm">{asset.label}</span>
													{asset.sizeKB && (
														<span className="text-xs text-muted-foreground ml-2">
															({asset.sizeKB} KB)
														</span>
													)}
												</div>
												<Button variant="ghost" size="sm" asChild>
													<a href={asset.url} download>
														<Download className="h-4 w-4" />
													</a>
												</Button>
											</div>
										</li>
									))}
								</ul>
							</CardContent>
						</Card>
					)}
				</div>
			</div>
		</div>
	);
}

================
File: src/components/video/video-progress-card.tsx
================
import { Button } from "@/components/ui/button";
import {
	Card,
	CardContent,
	CardFooter,
	CardHeader,
	CardTitle,
} from "@/components/ui/card";
import { ProgressSteps, type Step } from "@/components/ui/progress-steps";
import { ExternalLink, PauseIcon, PlayIcon } from "lucide-react";
import { useState } from "react";

type VideoProgressCardProps = {
	videoId: string;
	videoTitle: string;
	thumbnailUrl?: string;
	uploadedAt: Date;
	status: "processing" | "completed" | "error" | "paused";
	processingSteps: Step[];
	currentStepId?: string;
	youtubeUrl?: string;
	onPauseResume?: () => void;
	className?: string;
};

export function VideoProgressCard({
	videoId,
	videoTitle,
	thumbnailUrl,
	uploadedAt,
	status,
	processingSteps,
	currentStepId,
	youtubeUrl,
	onPauseResume,
	className,
}: VideoProgressCardProps) {
	const [isPaused, setIsPaused] = useState(status === "paused");

	const handlePauseResume = () => {
		setIsPaused(!isPaused);
		onPauseResume?.();
	};

	const formatDate = (date: Date) => {
		return new Intl.DateTimeFormat("en-US", {
			month: "short",
			day: "numeric",
			hour: "numeric",
			minute: "numeric",
		}).format(date);
	};

	return (
		<Card className={className}>
			<CardHeader className="pb-2">
				<div className="flex items-start justify-between">
					<div className="space-y-1">
						<CardTitle className="line-clamp-1 text-base">
							{videoTitle}
						</CardTitle>
						<div className="flex items-center gap-2 text-xs text-muted-foreground">
							<span>Uploaded {formatDate(uploadedAt)}</span>
							<span>•</span>
							<span>ID: {videoId.slice(0, 8)}</span>
						</div>
					</div>

					{thumbnailUrl && (
						<div className="relative h-14 w-24 overflow-hidden rounded-md shrink-0">
							<img
								src={thumbnailUrl}
								alt={videoTitle}
								className="h-full w-full object-cover"
							/>
						</div>
					)}
				</div>
			</CardHeader>

			<CardContent>
				<ProgressSteps steps={processingSteps} currentStepId={currentStepId} />
			</CardContent>

			<CardFooter className="flex justify-between pt-0">
				{(status === "processing" || status === "paused") && (
					<Button variant="outline" size="sm" onClick={handlePauseResume}>
						{isPaused ? (
							<>
								<PlayIcon className="mr-1.5 h-3.5 w-3.5" />
								Resume
							</>
						) : (
							<>
								<PauseIcon className="mr-1.5 h-3.5 w-3.5" />
								Pause
							</>
						)}
					</Button>
				)}

				{status === "completed" && youtubeUrl && (
					<Button variant="outline" size="sm" asChild>
						<a href={youtubeUrl} target="_blank" rel="noopener noreferrer">
							<ExternalLink className="mr-1.5 h-3.5 w-3.5" />
							View on YouTube
						</a>
					</Button>
				)}

				<Button variant="ghost" size="sm" asChild>
					<a href={`/video/${videoId}`}>View Details</a>
				</Button>
			</CardFooter>
		</Card>
	);
}

================
File: src/components/auth.tsx
================
export function Auth({
	actionText,
	onSubmit,
	status,
	afterSubmit,
}: {
	actionText: string;
	onSubmit: (e: React.FormEvent<HTMLFormElement>) => void;
	status: "pending" | "idle" | "success" | "error";
	afterSubmit?: React.ReactNode;
}) {
	return (
		<div className="fixed inset-0 bg-white dark:bg-black flex items-start justify-center p-8">
			<div className="bg-white dark:bg-gray-900 p-8 rounded-lg shadow-lg">
				<h1 className="text-2xl font-bold mb-4">{actionText}</h1>
				<form
					onSubmit={(e) => {
						e.preventDefault();
						onSubmit(e);
					}}
					className="space-y-4"
				>
					<div>
						<label htmlFor="email" className="block text-xs">
							Username
						</label>
						<input
							type="email"
							name="email"
							id="email"
							className="px-2 py-1 w-full rounded border border-gray-500/20 bg-white dark:bg-gray-800"
						/>
					</div>
					<div>
						<label htmlFor="password" className="block text-xs">
							Password
						</label>
						<input
							type="password"
							name="password"
							id="password"
							className="px-2 py-1 w-full rounded border border-gray-500/20 bg-white dark:bg-gray-800"
						/>
					</div>
					<button
						type="submit"
						className="w-full bg-cyan-600 text-white rounded py-2 font-black uppercase"
						disabled={status === "pending"}
					>
						{status === "pending" ? "..." : actionText}
					</button>
					{afterSubmit ? afterSubmit : null}
				</form>
			</div>
		</div>
	);
}

================
File: src/components/default-catch-boundary.tsx
================
import {
	ErrorComponent,
	Link,
	rootRouteId,
	useMatch,
	useRouter,
} from "@tanstack/react-router";
import type { ErrorComponentProps } from "@tanstack/react-router";
import * as React from "react";

export function DefaultCatchBoundary({ error }: ErrorComponentProps) {
	const router = useRouter();
	const isRoot = useMatch({
		strict: false,
		select: (state) => state.id === rootRouteId,
	});

	console.error(error);

	return (
		<div className="min-w-0 flex-1 p-4 flex flex-col items-center justify-center gap-6">
			<ErrorComponent error={error} />
			<div className="flex gap-2 items-center flex-wrap">
				<button
					onClick={() => {
						router.invalidate();
					}}
					className={
						"px-2 py-1 bg-gray-600 dark:bg-gray-700 rounded text-white uppercase font-extrabold"
					}
				>
					Try Again
				</button>
				{isRoot ? (
					<Link
						to="/"
						className={
							"px-2 py-1 bg-gray-600 dark:bg-gray-700 rounded text-white uppercase font-extrabold"
						}
					>
						Home
					</Link>
				) : (
					<Link
						to="/"
						className={
							"px-2 py-1 bg-gray-600 dark:bg-gray-700 rounded text-white uppercase font-extrabold"
						}
						onClick={(e) => {
							e.preventDefault();
							window.history.back();
						}}
					>
						Go Back
					</Link>
				)}
			</div>
		</div>
	);
}

================
File: src/components/login.tsx
================
import { useRouter } from "@tanstack/react-router";
import { useServerFn } from "@tanstack/react-start";
import { useMutation } from "../hooks/useMutation";
import { loginFn } from "../routes/_authed";
import { signupFn } from "../routes/signup";
import { Auth } from "./auth";

export function Login() {
	const router = useRouter();

	const loginMutation = useMutation({
		fn: loginFn,
		onSuccess: async (ctx) => {
			if (!ctx.data?.error) {
				await router.invalidate();
				router.navigate({ to: "/" });
				return;
			}
		},
	});

	const signupMutation = useMutation({
		fn: useServerFn(signupFn),
	});

	return (
		<Auth
			actionText="Login"
			status={loginMutation.status}
			onSubmit={(e) => {
				const formData = new FormData(e.target as HTMLFormElement);

				loginMutation.mutate({
					data: {
						email: formData.get("email") as string,
						password: formData.get("password") as string,
					},
				});
			}}
			afterSubmit={
				loginMutation.data ? (
					<>
						<div className="text-red-400">{loginMutation.data.message}</div>
						{loginMutation.data.error &&
						loginMutation.data.message === "Invalid login credentials" ? (
							<div>
								<button
									className="text-blue-500"
									onClick={(e) => {
										const formData = new FormData(
											(e.target as HTMLButtonElement).form!,
										);

										signupMutation.mutate({
											data: {
												email: formData.get("email") as string,
												password: formData.get("password") as string,
											},
										});
									}}
									type="button"
								>
									Sign up instead?
								</button>
							</div>
						) : null}
					</>
				) : null
			}
		/>
	);
}

================
File: src/components/not-found.tsx
================
import { Link } from '@tanstack/react-router'

export function NotFound({ children }: { children?: any }) {
  return (
    <div className="space-y-2 p-2">
      <div className="text-gray-600 dark:text-gray-400">
        {children || <p>The page you are looking for does not exist.</p>}
      </div>
      <p className="flex items-center gap-2 flex-wrap">
        <button
          onClick={() => window.history.back()}
          className="bg-emerald-500 text-white px-2 py-1 rounded uppercase font-black text-sm"
        >
          Go back
        </button>
        <Link
          to="/"
          className="bg-cyan-600 text-white px-2 py-1 rounded uppercase font-black text-sm"
        >
          Start Over
        </Link>
      </p>
    </div>
  )
}

================
File: src/components/post-error.tsx
================
import { ErrorComponent, ErrorComponentProps } from '@tanstack/react-router'

export function PostErrorComponent({ error }: ErrorComponentProps) {
  return <ErrorComponent error={error} />
}

================
File: src/components/user-error.tsx
================
import { ErrorComponent, ErrorComponentProps } from '@tanstack/react-router'

export function UserErrorComponent({ error }: ErrorComponentProps) {
  return <ErrorComponent error={error} />
}

================
File: src/hooks/use-mobile.ts
================
import * as React from "react";

const MOBILE_BREAKPOINT = 768;

export function useIsMobile() {
	const [isMobile, setIsMobile] = React.useState<boolean | undefined>(
		undefined,
	);

	React.useEffect(() => {
		const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);
		const onChange = () => {
			setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
		};
		mql.addEventListener("change", onChange);
		setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);
		return () => mql.removeEventListener("change", onChange);
	}, []);

	return !!isMobile;
}

================
File: src/hooks/useMutation.ts
================
import * as React from "react";

export function useMutation<TVariables, TData, TError = Error>(opts: {
	fn: (variables: TVariables) => Promise<TData>;
	onSuccess?: (ctx: { data: TData }) => void | Promise<void>;
}) {
	const [submittedAt, setSubmittedAt] = React.useState<number | undefined>();
	const [variables, setVariables] = React.useState<TVariables | undefined>();
	const [error, setError] = React.useState<TError | undefined>();
	const [data, setData] = React.useState<TData | undefined>();
	const [status, setStatus] = React.useState<
		"idle" | "pending" | "success" | "error"
	>("idle");

	const mutate = React.useCallback(
		async (variables: TVariables): Promise<TData | undefined> => {
			setStatus("pending");
			setSubmittedAt(Date.now());
			setVariables(variables);
			//
			try {
				const data = await opts.fn(variables);
				await opts.onSuccess?.({ data });
				setStatus("success");
				setError(undefined);
				setData(data);
				return data;
			} catch (err: any) {
				setStatus("error");
				setError(err);
			}
		},
		[opts.fn],
	);

	return {
		status,
		variables,
		submittedAt,
		mutate,
		error,
		data,
	};
}

================
File: src/lib/utils.ts
================
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

/**
 * Combines multiple class names into a single string, merging Tailwind CSS classes properly.
 * Uses clsx for conditional classes and tailwind-merge to handle Tailwind class conflicts.
 *
 * @param inputs - Class values to be combined
 * @returns A string of combined class names
 */
export function cn(...inputs: ClassValue[]): string {
	return twMerge(clsx(inputs));
}

================
File: src/routes/_authed/posts.$postId.tsx
================
import { ErrorComponent, createFileRoute } from "@tanstack/react-router";
import type { ErrorComponentProps } from "@tanstack/react-router";
import { NotFound } from "@/components/not-found";
import { fetchPost } from "@/utils/posts";

export const Route = createFileRoute("/_authed/posts/$postId")({
	loader: ({ params: { postId } }) => fetchPost({ data: postId }),
	errorComponent: PostErrorComponent,
	component: PostComponent,
	notFoundComponent: () => {
		return <NotFound>Post not found</NotFound>;
	},
});

export function PostErrorComponent({ error }: ErrorComponentProps) {
	return <ErrorComponent error={error} />;
}

function PostComponent() {
	const post = Route.useLoaderData();

	return (
		<div className="space-y-2">
			<h4 className="text-xl font-bold underline">{post.title}</h4>
			<div className="text-sm">{post.body}</div>
		</div>
	);
}

================
File: src/routes/_authed/posts.index.tsx
================
import { createFileRoute } from "@tanstack/react-router";

export const Route = createFileRoute("/_authed/posts/")({
	component: PostsIndexComponent,
});

function PostsIndexComponent() {
	return <div>Select a post.</div>;
}

================
File: src/routes/_authed/posts.tsx
================
import { Link, Outlet, createFileRoute } from "@tanstack/react-router";
import { fetchPosts } from "@/utils/posts";

export const Route = createFileRoute("/_authed/posts")({
	loader: () => fetchPosts(),
	component: PostsComponent,
});

function PostsComponent() {
	const posts = Route.useLoaderData();

	return (
		<div className="p-2 flex gap-2">
			<ul className="list-disc pl-4">
				{[...posts, { id: "i-do-not-exist", title: "Non-existent Post" }].map(
					(post) => {
						return (
							<li key={post.id} className="whitespace-nowrap">
								<Link
									to="/posts/$postId"
									params={{
										postId: post.id,
									}}
									className="block py-1 text-blue-800 hover:text-blue-600"
									activeProps={{ className: "text-black font-bold" }}
								>
									<div>{post.title.substring(0, 20)}</div>
								</Link>
							</li>
						);
					},
				)}
			</ul>
			<hr />
			<Outlet />
		</div>
	);
}

================
File: src/routes/_pathlessLayout/_nested-layout/route-a.tsx
================
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/_pathlessLayout/_nested-layout/route-a')(
  {
    component: LayoutAComponent,
  },
)

function LayoutAComponent() {
  return <div>I'm A!</div>
}

================
File: src/routes/_pathlessLayout/_nested-layout/route-b.tsx
================
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/_pathlessLayout/_nested-layout/route-b')(
  {
    component: LayoutBComponent,
  },
)

function LayoutBComponent() {
  return <div>I'm B!</div>
}

================
File: src/routes/_pathlessLayout/_nested-layout.tsx
================
import { Link, Outlet, createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/_pathlessLayout/_nested-layout')({
  component: LayoutComponent,
})

function LayoutComponent() {
  return (
    <div>
      <div>I'm a nested layout</div>
      <div className="flex gap-2 border-b">
        <Link
          to="/route-a"
          activeProps={{
            className: 'font-bold',
          }}
        >
          Go to route A
        </Link>
        <Link
          to="/route-b"
          activeProps={{
            className: 'font-bold',
          }}
        >
          Go to route B
        </Link>
      </div>
      <div>
        <Outlet />
      </div>
    </div>
  )
}

================
File: src/routes/api/users.$id.ts
================
import { json } from '@tanstack/react-start'
import { createAPIFileRoute } from '@tanstack/react-start/api'
import type { User } from '../../utils/users'

export const APIRoute = createAPIFileRoute('/api/users/$id')({
  GET: async ({ request, params }) => {
    console.info(`Fetching users by id=${params.id}... @`, request.url)
    try {
      const res = await fetch(
        'https://jsonplaceholder.typicode.com/users/' + params.id,
      )
      if (!res.ok) {
        throw new Error('Failed to fetch user')
      }

      const user = (await res.json()) as User

      return json({
        id: user.id,
        name: user.name,
        email: user.email,
      })
    } catch (e) {
      console.error(e)
      return json({ error: 'User not found' }, { status: 404 })
    }
  },
})

================
File: src/routes/api/users.ts
================
import { json } from '@tanstack/react-start'
import { createAPIFileRoute } from '@tanstack/react-start/api'
import type { User } from '../../utils/users'

export const APIRoute = createAPIFileRoute('/api/users')({
  GET: async ({ request }) => {
    console.info('Fetching users... @', request.url)
    const res = await fetch('https://jsonplaceholder.typicode.com/users')
    if (!res.ok) {
      throw new Error('Failed to fetch users')
    }

    const data = (await res.json()) as Array<User>

    const list = data.slice(0, 10)

    return json(list.map((u) => ({ id: u.id, name: u.name, email: u.email })))
  },
})

================
File: src/routes/__root.tsx
================
import {
	HeadContent,
	Link,
	Outlet,
	Scripts,
	createRootRoute,
  } from '@tanstack/react-router'
  import { TanStackRouterDevtools } from '@tanstack/react-router-devtools'
  import * as React from 'react'
  import { DefaultCatchBoundary } from '@/components/default-catch-boundary'
  import { NotFound } from '@/components/not-found'
  import appCss from '@/styles/app.css?url'
  import { seo } from '@/utils/seo'
  
  export const Route = createRootRoute({
	head: () => ({
	  meta: [
		{
		  charSet: 'utf-8',
		},
		{
		  name: 'viewport',
		  content: 'width=device-width, initial-scale=1',
		},
		...seo({
		  title:
			'TanStack Start | Type-Safe, Client-First, Full-Stack React Framework',
		  description: `TanStack Start is a type-safe, client-first, full-stack React framework. `,
		}),
	  ],
	  links: [
		{ rel: 'stylesheet', href: appCss },
		{
		  rel: 'apple-touch-icon',
		  sizes: '180x180',
		  href: '/apple-touch-icon.png',
		},
		{
		  rel: 'icon',
		  type: 'image/png',
		  sizes: '32x32',
		  href: '/favicon-32x32.png',
		},
		{
		  rel: 'icon',
		  type: 'image/png',
		  sizes: '16x16',
		  href: '/favicon-16x16.png',
		},
		{ rel: 'manifest', href: '/site.webmanifest', color: '#fffff' },
		{ rel: 'icon', href: '/favicon.ico' },
	  ],
	}),
	errorComponent: (props) => {
	  return (
		<RootDocument>
		  <DefaultCatchBoundary {...props} />
		</RootDocument>
	  )
	},
	notFoundComponent: () => <NotFound />,
	component: RootComponent,
  })
  
  function RootComponent() {
	return (
	  <RootDocument>
		<Outlet />
	  </RootDocument>
	)
  }
  
  function RootDocument({ children }: { children: React.ReactNode }) {
	return (
	  <html>
		<head>
		  <HeadContent />
		</head>
		<body>
		  <div className="p-2 flex gap-2 text-lg">
			<Link
			  to="/"
			  activeProps={{
				className: 'font-bold',
			  }}
			  activeOptions={{ exact: true }}
			>
			  Home
			</Link>{' '}
			<Link
			  to="/posts"
			  activeProps={{
				className: 'font-bold',
			  }}
			>
			  Posts
			</Link>{' '}
			<Link
			  to="/users"
			  activeProps={{
				className: 'font-bold',
			  }}
			>
			  Users
			</Link>{' '}
			<Link
			  to="/route-a"
			  activeProps={{
				className: 'font-bold',
			  }}
			>
			  Pathless Layout
			</Link>{' '}
			<Link
			  to="/deferred"
			  activeProps={{
				className: 'font-bold',
			  }}
			>
			  Deferred
			</Link>{' '}
			<Link
			  // @ts-expect-error
			  to="/this-route-does-not-exist"
			  activeProps={{
				className: 'font-bold',
			  }}
			>
			  This Route Does Not Exist
			</Link>
		  </div>
		  <hr />
		  {children}
		  <TanStackRouterDevtools position="bottom-right" />
		  <Scripts />
		</body>
	  </html>
	)
  }

================
File: src/routes/_authed.tsx
================
import { createFileRoute } from "@tanstack/react-router";
import { createServerFn } from "@tanstack/react-start";
import { Login } from "../components/login";
import { getSupabaseServerClient } from "../utils/supabase";

export const loginFn = createServerFn({ method: "POST" })
	.validator((d: { email: string; password: string }) => d)
	.handler(async ({ data }) => {
		const supabase = await getSupabaseServerClient();
		const { error } = await supabase.auth.signInWithPassword({
			email: data.email,
			password: data.password,
		});

		if (error) {
			return {
				error: true,
				message: error.message,
			};
		}
	});

export const Route = createFileRoute("/_authed")({
	beforeLoad: ({ context }) => {
		if (!context.user) {
			throw new Error("Not authenticated");
		}
	},
	errorComponent: ({ error }) => {
		if (error.message === "Not authenticated") {
			return <Login />;
		}

		throw error;
	},
});

================
File: src/routes/_pathlessLayout.tsx
================
import { Outlet, createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/_pathlessLayout')({
  component: LayoutComponent,
})

function LayoutComponent() {
  return (
    <div className="p-2">
      <div className="border-b">I'm a layout</div>
      <div>
        <Outlet />
      </div>
    </div>
  )
}

================
File: src/routes/dashboard.tsx
================
import { Button } from "@/components/ui/button";
import { DropZone } from "@/components/ui/dropzone";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { ProcessingDashboard } from "@/components/video/processing-dashboard";
import { Link, createFileRoute } from "@tanstack/react-router";
import {
	addDoc,
	collection,
	onSnapshot,
	query,
	where,
} from "firebase/firestore";
import type { DocumentData, QuerySnapshot } from "firebase/firestore";
import { ExternalLink, UploadIcon } from "lucide-react";
import { useEffect, useState } from "react";
import { db } from "../../firebase/index";
import {
	Dialog,
	DialogContent,
	DialogHeader,
	DialogTitle,
	DialogTrigger,
} from "./components/ui/dialog";

interface VideoData extends DocumentData {
	id: string;
	title?: string;
	current_stage?: string;
	filename?: string;
	channel?: string;
}

function DashboardComponent() {
	const [processingVideos, setProcessingVideos] = useState<VideoData[]>([]);
	const [completedVideos, setCompletedVideos] = useState<VideoData[]>([]);
	const [loading, setLoading] = useState(true);
	const [activeTab, setActiveTab] = useState("processing");
	const [uploadDialogOpen, setUploadDialogOpen] = useState(false);
	const [uploading, setUploading] = useState(false);

	useEffect(() => {
		// Fetch videos that are still processing (not completed)
		const processingQuery = query(
			collection(db, "videos"),
			where("current_stage", "!=", "completed"),
		);

		const unsubscribeProcessing = onSnapshot(
			processingQuery,
			(snapshot: QuerySnapshot<DocumentData>) => {
				const vids = snapshot.docs.map((doc) => ({
					id: doc.id,
					...doc.data(),
				})) as VideoData[];
				setProcessingVideos(vids);
				setLoading(false);
			},
			(error) => {
				console.error("Error fetching processing videos:", error);
				setLoading(false);
			},
		);

		// Fetch completed videos separately
		const completedQuery = query(
			collection(db, "videos"),
			where("current_stage", "==", "completed"),
		);

		const unsubscribeCompleted = onSnapshot(
			completedQuery,
			(snapshot: QuerySnapshot<DocumentData>) => {
				const vids = snapshot.docs.map((doc) => ({
					id: doc.id,
					...doc.data(),
				})) as VideoData[];
				setCompletedVideos(vids);
			},
			(error) => {
				console.error("Error fetching completed videos:", error);
			},
		);

		return () => {
			unsubscribeProcessing();
			unsubscribeCompleted();
		};
	}, []);

	const handleFilesAccepted = async (files: FileList | File[]) => {
		if (files.length === 0) return;

		setUploading(true);
		try {
			// TODO: Implement actual file upload to storage
			const file = files[0];

			// Create a document in Firestore to track the video processing
			await addDoc(collection(db, "videos"), {
				filename: file.name,
				title: file.name.replace(/\.[^/.]+$/, ""), // Remove extension
				current_stage: "uploaded", // Initial stage
				uploadedAt: new Date(),
				fileSize: file.size,
				// Add other metadata as needed
			});

			// TODO: Submit the video for processing via backend API

			setUploadDialogOpen(false);
		} catch (error) {
			console.error("Error uploading video:", error);
		} finally {
			setUploading(false);
		}
	};

	return (
		<div className="container py-10">
			<div className="flex items-center justify-between mb-8">
				<div>
					<h1 className="text-2xl font-bold tracking-tight">Video Dashboard</h1>
					<p className="text-muted-foreground text-sm mt-1">
						Manage and monitor your video processing status
					</p>
				</div>
				<Dialog open={uploadDialogOpen} onOpenChange={setUploadDialogOpen}>
					<DialogTrigger asChild>
						<Button>
							<UploadIcon className="h-4 w-4 mr-2" />
							Upload New Video
						</Button>
					</DialogTrigger>
					<DialogContent className="sm:max-w-md">
						<DialogHeader>
							<DialogTitle>Upload Video</DialogTitle>
						</DialogHeader>
						<div className="py-4">
							<DropZone
								onFilesAccepted={handleFilesAccepted}
								disabled={uploading}
							/>
							{uploading && (
								<div className="mt-4 text-center text-sm text-muted-foreground">
									<div className="animate-pulse">Processing upload...</div>
								</div>
							)}
						</div>
					</DialogContent>
				</Dialog>
			</div>

			<Tabs value={activeTab} onValueChange={setActiveTab}>
				<TabsList className="w-full max-w-md mb-6">
					<TabsTrigger value="processing" className="flex-1">
						Processing Status
					</TabsTrigger>
					<TabsTrigger value="library" className="flex-1">
						Video Library
					</TabsTrigger>
				</TabsList>

				<TabsContent value="processing" className="space-y-4 animate-in">
					<ProcessingDashboard />
				</TabsContent>

				<TabsContent value="library" className="space-y-4 animate-in">
					{loading ? (
						<div className="flex justify-center py-20">
							<div className="animate-pulse">Loading videos...</div>
						</div>
					) : completedVideos.length === 0 ? (
						<div className="flex flex-col items-center justify-center py-20 text-center">
							<p className="text-muted-foreground mb-4">
								No completed videos found in your library
							</p>
							<Dialog
								open={uploadDialogOpen}
								onOpenChange={setUploadDialogOpen}
							>
								<DialogTrigger asChild>
									<Button variant="outline">Upload your first video</Button>
								</DialogTrigger>
							</Dialog>
						</div>
					) : (
						<div className="grid gap-6 sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3">
							{completedVideos.map((video) => (
								<div
									key={video.id}
									className="group relative rounded-lg border border-border p-4 hover:border-primary transition-colors"
								>
									<div className="flex justify-between items-start mb-3">
										<h3 className="font-semibold line-clamp-1 group-hover:text-primary transition-colors">
											{video.title || "Untitled Video"}
										</h3>
										{video.youtube_video_id && (
											<a
												href={`https://studio.youtube.com/video/${video.youtube_video_id}/edit`}
												target="_blank"
												rel="noopener noreferrer"
												className="text-muted-foreground hover:text-primary transition-colors"
											>
												<ExternalLink className="h-4 w-4" />
											</a>
										)}
									</div>
									<div className="mt-2 space-y-1 text-sm text-muted-foreground">
										<p className="line-clamp-1">
											Filename: {video.filename || "N/A"}
										</p>
										<p>Channel: {video.channel || "N/A"}</p>
										{video.youtube_video_id && (
											<div className="mt-3 flex space-x-2">
												<Button variant="outline" size="sm" asChild>
													<Link
														to="/video/$videoId"
														params={{ videoId: video.id }}
													>
														View Details
													</Link>
												</Button>
												<Button variant="outline" size="sm" asChild>
													<a
														href={`https://youtube.com/watch?v=${video.youtube_video_id}`}
														target="_blank"
														rel="noopener noreferrer"
													>
														Watch on YouTube
													</a>
												</Button>
											</div>
										)}
									</div>
								</div>
							))}
						</div>
					)}
				</TabsContent>
			</Tabs>
		</div>
	);
}

export const Route = createFileRoute("/dashboard")({
	component: DashboardComponent,
});

================
File: src/routes/deferred.tsx
================
import { Await, createFileRoute } from '@tanstack/react-router'
import { createServerFn } from '@tanstack/react-start'
import { Suspense, useState } from 'react'

const personServerFn = createServerFn({ method: 'GET' })
  .validator((d: string) => d)
  .handler(({ data: name }) => {
    return { name, randomNumber: Math.floor(Math.random() * 100) }
  })

const slowServerFn = createServerFn({ method: 'GET' })
  .validator((d: string) => d)
  .handler(async ({ data: name }) => {
    await new Promise((r) => setTimeout(r, 1000))
    return { name, randomNumber: Math.floor(Math.random() * 100) }
  })

export const Route = createFileRoute('/deferred')({
  loader: async () => {
    return {
      deferredStuff: new Promise<string>((r) =>
        setTimeout(() => r('Hello deferred!'), 2000),
      ),
      deferredPerson: slowServerFn({ data: 'Tanner Linsley' }),
      person: await personServerFn({ data: 'John Doe' }),
    }
  },
  component: Deferred,
})

function Deferred() {
  const [count, setCount] = useState(0)
  const { deferredStuff, deferredPerson, person } = Route.useLoaderData()

  return (
    <div className="p-2">
      <div data-testid="regular-person">
        {person.name} - {person.randomNumber}
      </div>
      <Suspense fallback={<div>Loading person...</div>}>
        <Await
          promise={deferredPerson}
          children={(data) => (
            <div data-testid="deferred-person">
              {data.name} - {data.randomNumber}
            </div>
          )}
        />
      </Suspense>
      <Suspense fallback={<div>Loading stuff...</div>}>
        <Await
          promise={deferredStuff}
          children={(data) => <h3 data-testid="deferred-stuff">{data}</h3>}
        />
      </Suspense>
      <div>Count: {count}</div>
      <div>
        <button onClick={() => setCount(count + 1)}>Increment</button>
      </div>
    </div>
  )
}

================
File: src/routes/index.tsx
================
import { createFileRoute } from "@tanstack/react-router";
import { Button } from "@/components/ui/button";

export const Route = createFileRoute("/")({
  component: Home,
});

function Home() {
  return (
    <div className="p-2">
      <h3>Welcome Home!!!</h3>
      <Button>Button</Button>
    </div>
  );
}

================
File: src/routes/login.tsx
================
import { createFileRoute } from "@tanstack/react-router";
import { Login } from "../components/login";

export const Route = createFileRoute("/login")({
	component: LoginComp,
});

function LoginComp() {
	return <Login />;
}

================
File: src/routes/logout.tsx
================
import { createFileRoute, redirect } from "@tanstack/react-router";
import { createServerFn } from "@tanstack/react-start";
import { getSupabaseServerClient } from "../utils/supabase";

const logoutFn = createServerFn().handler(async () => {
	const supabase = await getSupabaseServerClient();
	const { error } = await supabase.auth.signOut();

	if (error) {
		return {
			error: true,
			message: error.message,
		};
	}

	throw redirect({
		href: "/",
	});
});

export const Route = createFileRoute("/logout")({
	preload: false,
	loader: () => logoutFn(),
});

================
File: src/routes/redirect.tsx
================
import { createFileRoute, redirect } from '@tanstack/react-router'

export const Route = createFileRoute('/redirect')({
  beforeLoad: async () => {
    throw redirect({
      to: '/posts',
    })
  },
})

================
File: src/routes/settings.tsx
================
import { createFileRoute } from "@tanstack/react-router";

import { Button } from "../components/ui/button";
import {
	Card,
	CardContent,
	CardHeader,
	CardTitle,
} from "../components/ui/card";
import { Input } from "../components/ui/input";
import { Label } from "../components/ui/label";
import { Separator } from "../components/ui/separator";
import { Switch } from "../components/ui/switch";
// import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "../components/ui/select"; // Placeholder for future use

function SettingsComponent() {
	return (
		<div className="container mx-auto py-8 max-w-4xl space-y-8">
			<h1 className="text-3xl font-bold">Settings</h1>

			{/* Profile & Preferences Section */}
			<Card>
				<CardHeader>
					<CardTitle>Profile & Preferences</CardTitle>
				</CardHeader>
				<CardContent className="space-y-4">
					<div className="space-y-2">
						<Label htmlFor="displayName">Display Name</Label>
						<Input
							id="displayName"
							placeholder="Your Name (coming soon)"
							disabled
						/>
					</div>
					<div className="space-y-2">
						<Label htmlFor="email">Email</Label>
						<Input
							id="email"
							type="email"
							placeholder="your.email@example.com (coming soon)"
							disabled
						/>
					</div>
					<div className="flex items-center justify-between space-x-2 pt-2">
						<Label htmlFor="darkMode" className="flex flex-col space-y-1">
							<span>Dark Mode</span>
							<span className="font-normal leading-snug text-muted-foreground">
								Adjust the appearance to reduce eye strain.
							</span>
						</Label>
						<Switch id="darkMode" disabled />
					</div>
				</CardContent>
			</Card>

			{/* YouTube Integration Section */}
			<Card>
				<CardHeader>
					<CardTitle>YouTube Integration</CardTitle>
				</CardHeader>
				<CardContent className="space-y-4">
					<div className="space-y-2">
						<Label>Connected Account</Label>
						<div className="flex items-center justify-between">
							<p className="text-sm text-muted-foreground">
								youtube-channel-name (coming soon)
							</p>
							<Button variant="outline" size="sm" disabled>
								Reconnect
							</Button>
						</div>
					</div>
					<Separator />
					<div className="space-y-2">
						<Label htmlFor="defaultPrivacy">Default Upload Privacy</Label>
						{/* Placeholder for Select component */}
						<Input
							id="defaultPrivacy"
							placeholder="Private (coming soon)"
							disabled
						/>
						{/* <Select disabled>
              <SelectTrigger id="defaultPrivacy">
                <SelectValue placeholder="Select default privacy" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="private">Private</SelectItem>
                <SelectItem value="unlisted">Unlisted</SelectItem>
                <SelectItem value="public">Public</SelectItem>
              </SelectContent>
            </Select> */}
					</div>
					<div className="space-y-2">
						<Label htmlFor="defaultCategory">Default Video Category</Label>
						{/* Placeholder for Select component */}
						<Input
							id="defaultCategory"
							placeholder="Science & Technology (coming soon)"
							disabled
						/>
					</div>
				</CardContent>
			</Card>

			{/* AI Configuration Section */}
			<Card>
				<CardHeader>
					<CardTitle>AI Configuration</CardTitle>
				</CardHeader>
				<CardContent className="space-y-4">
					<div className="space-y-2">
						<Label>AI Model</Label>
						<p className="text-sm text-muted-foreground">
							Gemini Pro (Current Model - read-only)
						</p>
					</div>
					<Separator />
					<div className="space-y-2">
						<Label htmlFor="titleSuggestions">
							Number of Title Suggestions
						</Label>
						<Input
							id="titleSuggestions"
							type="number"
							placeholder="3 (coming soon)"
							disabled
						/>
					</div>
					<div className="space-y-2">
						<Label htmlFor="thumbnailStyles">Thumbnail Generation Style</Label>
						{/* Placeholder for Select component */}
						<Input
							id="thumbnailStyles"
							placeholder="Default (coming soon)"
							disabled
						/>
					</div>
				</CardContent>
			</Card>

			{/* Notification Settings Section */}
			<Card>
				<CardHeader>
					<CardTitle>Notifications</CardTitle>
				</CardHeader>
				<CardContent className="space-y-4">
					<div className="flex items-center justify-between space-x-2">
						<Label
							htmlFor="emailNotifications"
							className="flex flex-col space-y-1"
						>
							<span>Email Notifications</span>
							<span className="font-normal leading-snug text-muted-foreground">
								Receive email updates for processing events.
							</span>
						</Label>
						<Switch id="emailNotifications" disabled />
					</div>
					<Separator />
					<p className="text-sm font-medium text-muted-foreground">
						Notify me when:
					</p>
					<div className="flex items-center justify-between space-x-2 pl-4">
						<Label htmlFor="notifyUploadComplete">Upload Complete</Label>
						<Switch id="notifyUploadComplete" disabled />
					</div>
					<div className="flex items-center justify-between space-x-2 pl-4">
						<Label htmlFor="notifyProcessingComplete">
							Processing Complete
						</Label>
						<Switch id="notifyProcessingComplete" disabled />
					</div>
					<div className="flex items-center justify-between space-x-2 pl-4">
						<Label htmlFor="notifyProcessingError">Processing Error</Label>
						<Switch id="notifyProcessingError" disabled />
					</div>
				</CardContent>
			</Card>

			{/* Storage & Credentials Section */}
			<Card>
				<CardHeader>
					<CardTitle>Storage & Credentials</CardTitle>
				</CardHeader>
				<CardContent className="space-y-4">
					<div className="space-y-2">
						<Label>Google Cloud Storage</Label>
						<p className="text-sm text-muted-foreground">
							Input Bucket: `your-input-bucket` (read-only)
						</p>
						<p className="text-sm text-muted-foreground">
							Output Bucket: `your-output-bucket` (read-only)
						</p>
					</div>
					<Separator />
					<div className="space-y-2">
						<Label>Credential Status</Label>
						<p className="text-sm text-muted-foreground">
							Google Cloud: Connected ✅
						</p>
						<p className="text-sm text-muted-foreground">
							YouTube API: Connected ✅
						</p>
					</div>
				</CardContent>
			</Card>
		</div>
	);
}

export const Route = createFileRoute("/settings")({
	component: SettingsComponent,
});

================
File: src/routes/signup.tsx
================
import { createFileRoute, redirect } from "@tanstack/react-router";
import { createServerFn, useServerFn } from "@tanstack/react-start";
import { Auth } from "../components/auth";
import { useMutation } from "../hooks/useMutation";
import { getSupabaseServerClient } from "../utils/supabase";

export const signupFn = createServerFn({ method: "POST" })
	.validator(
		(d: { email: string; password: string; redirectUrl?: string }) => d,
	)
	.handler(async ({ data }) => {
		const supabase = await getSupabaseServerClient();
		const { error } = await supabase.auth.signUp({
			email: data.email,
			password: data.password,
		});
		if (error) {
			return {
				error: true,
				message: error.message,
			};
		}

		// Redirect to the prev page stored in the "redirect" search param
		throw redirect({
			href: data.redirectUrl || "/",
		});
	});

export const Route = createFileRoute("/signup")({
	component: SignupComp,
});

function SignupComp() {
	const signupMutation = useMutation({
		fn: useServerFn(signupFn),
	});

	return (
		<Auth
			actionText="Sign Up"
			status={signupMutation.status}
			onSubmit={(e) => {
				const formData = new FormData(e.target as HTMLFormElement);

				signupMutation.mutate({
					data: {
						email: formData.get("email") as string,
						password: formData.get("password") as string,
					},
				});
			}}
			afterSubmit={
				signupMutation.data?.error ? (
					<>
						<div className="text-red-400">{signupMutation.data.message}</div>
					</>
				) : null
			}
		/>
	);
}

================
File: src/routes/users.route.tsx
================
import { Link, Outlet, createFileRoute } from '@tanstack/react-router'
import { DEPLOY_URL } from '../utils/users'
import type { User } from '../utils/users'

export const Route = createFileRoute('/users')({
  loader: async () => {
    try {
      const res = await fetch(DEPLOY_URL + '/api/users')
      if (!res.ok) {
        throw new Error('Unexpected status code')
      }

      const data = (await res.json()) as Array<User>

      return data
    } catch {
      throw new Error('Failed to fetch users')
    }
  },
  component: UsersLayoutComponent,
})

function UsersLayoutComponent() {
  const users = Route.useLoaderData()

  return (
    <div className="p-2 flex gap-2">
      <ul className="list-disc pl-4">
        {[
          ...users,
          { id: 'i-do-not-exist', name: 'Non-existent User', email: '' },
        ].map((user) => {
          return (
            <li key={user.id} className="whitespace-nowrap">
              <Link
                to="/users/$userId"
                params={{
                  userId: String(user.id),
                }}
                className="block py-1 text-blue-800 hover:text-blue-600"
                activeProps={{ className: 'text-black font-bold' }}
              >
                <div>{user.name}</div>
              </Link>
            </li>
          )
        })}
      </ul>
      <hr />
      <Outlet />
    </div>
  )
}

================
File: src/routes/video.$videoId.tsx
================
import { Link, createFileRoute, useParams } from "@tanstack/react-router";
import {
	type DocumentSnapshot,
	doc,
	getDoc,
	onSnapshot,
	updateDoc,
} from "firebase/firestore";
import type { DocumentData } from "firebase/firestore";
import { AlignLeft, FileText, FileVideo, Image, Loader2 } from "lucide-react";
import React, { useEffect, useState } from "react";
import { db } from "../../firebase/index";
import { Button } from "../components/ui/button";
import {
	Card,
	CardContent,
	CardDescription,
	CardHeader,
	CardTitle,
} from "../components/ui/card";
import { Input } from "../components/ui/input";
import { Label } from "../components/ui/label";
import type { Step } from "../components/ui/progress-steps";
import {
	Tabs,
	TabsContent,
	TabsList,
	TabsTrigger,
} from "../components/ui/tabs";
import { Textarea } from "../components/ui/textarea";
import {
	ProcessingStepId,
	createMockProcessingSteps,
} from "../components/video/processing-steps";
import {
	type Thumbnail,
	ThumbnailGallery,
} from "../components/video/thumbnail-gallery";
import {
	type TitleOption,
	TitleSelector,
} from "../components/video/title-selector";
import { VideoDetail } from "../components/video/video-detail";
import { cn } from "../lib/utils";

interface VideoData {
	title: string;
	description: string;
	tags: string;
	scheduledTime: string;
	thumbnails: Thumbnail[];
	titleOptions?: TitleOption[];
	current_stage?: string;
	output_files?: {
		transcript?: string;
		subtitles?: string;
		chapters?: string;
		shownotes?: string;
		title?: string;
		[key: string]: string | undefined;
	};
	bucket_name?: string;
	processed_path?: string;
	youtube_video_id?: string;
	[key: string]: any; // For other properties that might be in the data
}

interface VideoFormData {
	title?: string;
	description?: string;
	tags?: string;
	scheduledTime?: string;
	thumbnails?: Thumbnail[];
	[key: string]: any;
}

// Map backend processing stages to frontend processing steps
const stageToStepMap: Record<string, number> = {
	uploaded: 0,
	audio_extraction: 1,
	transcript_generation: 2,
	subtitle_generation: 3,
	shownote_generation: 4,
	chapter_generation: 5,
	title_generation: 6,
	youtube_upload: 7,
	completed: 8,
};

// Helper to determine the current step index based on backend stage
function getCurrentStepIndex(stage?: string): number {
	if (!stage) return 0;
	return stageToStepMap[stage] || 0;
}

function getVideoStatus(
	stage?: string,
): "processing" | "completed" | "error" | "paused" {
	if (!stage) return "processing";
	if (stage === "completed") return "completed";
	if (stage === "error") return "error";
	if (stage === "paused") return "paused";
	return "processing";
}

function VideoDetailComponent() {
	const { videoId } = useParams({ from: "/video/$videoId" });
	const [videoData, setVideoData] = useState<VideoData | null>(null);
	const [loading, setLoading] = useState(true);
	const [form, setForm] = useState<VideoFormData | null>(null);
	const [saving, setSaving] = useState(false);
	const [activeTab, setActiveTab] = useState("overview");
	const [isGeneratingThumbnails, setIsGeneratingThumbnails] = useState(false);

	// Mock title options for demo
	const [titleOptions, setTitleOptions] = useState<TitleOption[]>([]);
	const [thumbnails, setThumbnails] = useState<Thumbnail[]>([]);

	useEffect(() => {
		if (!videoId) return;
		setLoading(true);
		const docRef = doc(db, "videos", videoId);
		const unsubscribe = onSnapshot(
			docRef,
			(docSnap: DocumentSnapshot<DocumentData>) => {
				if (docSnap.exists()) {
					const data = docSnap.data() as VideoData;
					setVideoData(data);
					setForm(data);

					// Generate mock title options if not present
					if (!data.titleOptions || data.titleOptions.length === 0) {
						const mockTitles = generateMockTitles(data.title || "Video Title");
						setTitleOptions(mockTitles);
					} else {
						setTitleOptions(data.titleOptions);
					}

					// Format thumbnails for our component
					if (data.thumbnails && data.thumbnails.length > 0) {
						const formattedThumbnails = data.thumbnails.map((thumb, index) => ({
							id: `thumb-${index}`,
							url: thumb.url,
							prompt: thumb.prompt,
							status: thumb.status as "ready" | "generating" | "failed",
							isSelected: index === 0, // Default first one selected
						}));

						// If we don't have at least 4, add placeholders
						while (formattedThumbnails.length < 4) {
							formattedThumbnails.push({
								id: `thumb-placeholder-${formattedThumbnails.length}`,
								url: `https://picsum.photos/id/${formattedThumbnails.length + 10}/640/360`,
								prompt: "Example thumbnail prompt with style settings",
								status: "ready",
								isSelected: false,
							});
						}

						setThumbnails(formattedThumbnails);
					} else {
						// Create 4 mock thumbnails
						const mockThumbnails = [
							{
								id: "thumb-1",
								url: "https://picsum.photos/id/10/640/360",
								prompt:
									"Professional headshot with blurred background, high contrast",
								status: "ready" as const,
								isSelected: true,
							},
							{
								id: "thumb-2",
								url: "https://picsum.photos/id/11/640/360",
								prompt: "Product featured prominently with clean background",
								status: "ready" as const,
							},
							{
								id: "thumb-3",
								url: "https://picsum.photos/id/12/640/360",
								prompt:
									"Action shot with dynamic composition and vibrant colors",
								status: "ready" as const,
							},
							{
								id: "thumb-4",
								url: "https://picsum.photos/id/13/640/360",
								prompt:
									"Infographic style with text overlay and minimal design",
								status: "ready" as const,
							},
						];
						setThumbnails(mockThumbnails);
					}
				} else {
					setVideoData(null);
					setForm(null);
				}
				setLoading(false);
			},
			(error) => {
				console.error("Error fetching video data:", error);
				setVideoData(null);
				setForm(null);
				setLoading(false);
			},
		);
		return () => unsubscribe();
	}, [videoId]);

	const handleSave = async (updates: Partial<VideoData>) => {
		setSaving(true);
		const docRef = doc(db, "videos", videoId);
		try {
			await updateDoc(docRef, updates);
		} catch (error) {
			console.error("Error updating video data:", error);
		} finally {
			setSaving(false);
		}
	};

	// Mock title generation
	const generateMockTitles = (baseTitle: string): TitleOption[] => {
		const titles = [
			{
				id: "title-1",
				text: baseTitle,
				votes: 2,
				isSelected: true,
			},
			{
				id: "title-2",
				text: `How to ${baseTitle} in 5 Simple Steps`,
				votes: 1,
			},
			{
				id: "title-3",
				text: `The Ultimate Guide to ${baseTitle}`,
				votes: 3,
			},
			{
				id: "title-4",
				text: `${baseTitle}: Expert Tips and Tricks`,
				votes: 0,
			},
			{
				id: "title-5",
				text: `Why ${baseTitle} Is Changing Everything`,
				votes: 1,
			},
		];

		return titles;
	};

	// Title selector handlers
	const handleTitleSelect = (titleId: string) => {
		setTitleOptions((prev) =>
			prev.map((title) => ({
				...title,
				isSelected: title.id === titleId,
			})),
		);
	};

	const handleTitleEdit = (titleId: string, newText: string) => {
		setTitleOptions((prev) =>
			prev.map((title) =>
				title.id === titleId ? { ...title, text: newText } : title,
			),
		);
	};

	const handleTitleVote = (titleId: string) => {
		setTitleOptions((prev) =>
			prev.map((title) =>
				title.id === titleId
					? { ...title, votes: (title.votes || 0) + 1 }
					: title,
			),
		);
	};

	const handleGenerateMoreTitles = () => {
		setSaving(true);
		// Simulate API call delay
		setTimeout(() => {
			const currentTitle = videoData?.title || "Video Title";
			const newTitles = [
				{
					id: `title-${titleOptions.length + 1}`,
					text: `NEW: ${currentTitle} For Beginners`,
					votes: 0,
				},
				{
					id: `title-${titleOptions.length + 2}`,
					text: `NEW: Top 10 ${currentTitle} Strategies`,
					votes: 0,
				},
				{
					id: `title-${titleOptions.length + 3}`,
					text: `NEW: ${currentTitle} That Actually Work`,
					votes: 0,
				},
			];

			setTitleOptions((prev) => [...prev, ...newTitles]);
			setSaving(false);
		}, 1500);
	};

	const handleApplyTitle = async (titleId: string) => {
		const selectedTitle = titleOptions.find((title) => title.id === titleId);
		if (!selectedTitle) return;

		await handleSave({
			title: selectedTitle.text,
			titleOptions: titleOptions,
		});
	};

	// Thumbnail handlers
	const handleThumbnailSelect = (thumbnailId: string) => {
		setThumbnails((prev) =>
			prev.map((thumb) => ({
				...thumb,
				isSelected: thumb.id === thumbnailId,
			})),
		);
	};

	const handleRegenerateAllThumbnails = () => {
		setIsGeneratingThumbnails(true);

		// Mark all thumbnails as generating
		setThumbnails((prev) =>
			prev.map((thumb) => ({
				...thumb,
				status: "generating",
			})),
		);

		// Simulate API call delay
		setTimeout(() => {
			// Replace with new thumbnails
			const newThumbnails = thumbnails.map((thumb, index) => ({
				...thumb,
				url: `https://picsum.photos/id/${20 + index}/640/360?random=${Date.now()}`,
				status: "ready" as const,
			}));

			setThumbnails(newThumbnails);
			setIsGeneratingThumbnails(false);
		}, 3000);
	};

	const handleRegenerateSingleThumbnail = (
		thumbnailId: string,
		newPrompt: string,
	) => {
		// Mark this thumbnail as generating
		setThumbnails((prev) =>
			prev.map((thumb) =>
				thumb.id === thumbnailId
					? { ...thumb, status: "generating", prompt: newPrompt }
					: thumb,
			),
		);

		// Simulate API call delay
		setTimeout(() => {
			// Replace with new thumbnail
			setThumbnails((prev) =>
				prev.map((thumb) =>
					thumb.id === thumbnailId
						? {
								...thumb,
								url: `https://picsum.photos/id/${30}/640/360?random=${Date.now()}`,
								status: "ready",
							}
						: thumb,
				),
			);
		}, 2000);
	};

	const handleApplyThumbnail = async (thumbnailId: string) => {
		const selectedThumb = thumbnails.find((thumb) => thumb.id === thumbnailId);
		if (!selectedThumb) return;

		// In a real implementation, this would update the backend
		// For demo, we'll just update our local state
		console.log("Applied thumbnail:", selectedThumb);
	};

	const handleCustomThumbnailUpload = (file: File) => {
		// In a real implementation, this would upload the file
		// For demo, we'll just log it
		console.log("Uploaded custom thumbnail:", file);
	};

	if (loading) {
		return (
			<div className="container py-10">
				<div className="flex justify-center py-20">
					<div className="animate-pulse flex items-center">
						<Loader2 className="h-5 w-5 animate-spin mr-2" />
						Loading video details...
					</div>
				</div>
			</div>
		);
	}

	if (!videoData) {
		return (
			<div className="container py-10">
				<div className="flex flex-col items-center justify-center py-20 text-center">
					<p className="text-muted-foreground mb-4">Video not found</p>
					<Link to="/dashboard" className="text-primary hover:underline">
						Back to dashboard
					</Link>
				</div>
			</div>
		);
	}

	// Prepare data for the VideoDetail component
	const processingSteps: Step[] = createMockProcessingSteps(
		getCurrentStepIndex(videoData.current_stage),
	);

	// Generate video assets for download with real URLs if available
	const videoAssets = [
		{
			type: "transcript",
			label: "Transcript (TXT)",
			url: videoData.output_files?.transcript
				? `https://storage.googleapis.com/${videoData.bucket_name}/${videoData.output_files.transcript}`
				: "#",
			icon: FileText,
			sizeKB: 120,
		},
		{
			type: "subtitles",
			label: "Subtitles (VTT)",
			url: videoData.output_files?.subtitles
				? `https://storage.googleapis.com/${videoData.bucket_name}/${videoData.output_files.subtitles}`
				: "#",
			icon: AlignLeft,
			sizeKB: 45,
		},
		{
			type: "video",
			label: "Original Video (MP4)",
			url: "#", // The full video URL would require a signed URL for larger files
			icon: FileVideo,
			sizeKB: 24500,
		},
		{
			type: "thumbnail",
			label: "Thumbnail (JPG)",
			url: videoData.thumbnails?.[0]?.url || "#",
			icon: Image,
			sizeKB: 320,
		},
	];

	// Use the first thumbnail as preview if available
	const thumbnailUrl =
		videoData.thumbnails?.[0]?.url || thumbnails.find((t) => t.isSelected)?.url;

	// Get the current step ID
	const currentStepIndex = getCurrentStepIndex(videoData.current_stage);
	const stepIds = Object.values(ProcessingStepId);
	const currentStepId = stepIds[currentStepIndex];

	return (
		<div className="container py-10">
			<div className="mb-8">
				<Link
					to="/dashboard"
					className="inline-flex items-center text-sm text-muted-foreground hover:text-foreground"
				>
					← Back to dashboard
				</Link>
				<h1 className="text-2xl font-bold tracking-tight mt-4">
					{videoData.title || "Untitled Video"}
				</h1>
				<div className="flex items-center text-sm text-muted-foreground mt-1">
					<span className="text-primary">#{videoId.slice(0, 6)}</span>
					{videoData.current_stage && (
						<>
							<span className="mx-2">•</span>
							<span className="capitalize">
								{videoData.current_stage.replace("_", " ")}
							</span>
						</>
					)}
				</div>
			</div>

			<Tabs
				value={activeTab}
				onValueChange={setActiveTab}
				className="space-y-4"
			>
				<TabsList className="w-full max-w-md">
					<TabsTrigger value="overview" className="flex-1">
						Overview
					</TabsTrigger>
					<TabsTrigger value="title" className="flex-1">
						Title
					</TabsTrigger>
					<TabsTrigger value="thumbnail" className="flex-1">
						Thumbnail
					</TabsTrigger>
					<TabsTrigger value="metadata" className="flex-1">
						Metadata
					</TabsTrigger>
				</TabsList>

				<TabsContent value="overview" className="animate-in space-y-6">
					<VideoDetail
						videoId={videoId}
						videoTitle={videoData.title || "Untitled Video"}
						videoUrl="#" // Mock video URL for demo
						thumbnailUrl={thumbnailUrl}
						processingSteps={processingSteps}
						currentStepId={currentStepId}
						youtubeUrl={videoData.youtube_url}
						status={getVideoStatus(videoData.current_stage)}
						assets={videoAssets}
						output_files={videoData.output_files}
						bucket_name={videoData.bucket_name}
						onSaveContent={async (contentType, content) => {
							// In a real implementation, this would send to the backend API
							console.log(
								`Saving ${contentType} content:`,
								`${content.substring(0, 100)}...`,
							);
							// For demo, we'll just simulate a delay
							setSaving(true);
							await new Promise((resolve) => setTimeout(resolve, 1000));
							setSaving(false);
							// In a real implementation, you would update the output_files in Firestore
							return;
						}}
					/>
				</TabsContent>

				<TabsContent value="title" className="animate-in">
					<TitleSelector
						videoId={videoId}
						titleOptions={titleOptions}
						onSelect={handleTitleSelect}
						onEdit={handleTitleEdit}
						onVote={handleTitleVote}
						onGenerateMore={handleGenerateMoreTitles}
						onApply={handleApplyTitle}
					/>
				</TabsContent>

				<TabsContent value="thumbnail" className="animate-in">
					<ThumbnailGallery
						videoId={videoId}
						thumbnails={thumbnails}
						onSelect={handleThumbnailSelect}
						onRegenerateAll={handleRegenerateAllThumbnails}
						onRegenerateSingle={handleRegenerateSingleThumbnail}
						onApply={handleApplyThumbnail}
						onCustomUpload={handleCustomThumbnailUpload}
						isGenerating={isGeneratingThumbnails}
					/>
				</TabsContent>

				<TabsContent value="metadata" className="animate-in space-y-6">
					<Card>
						<CardHeader>
							<CardTitle>Video Metadata</CardTitle>
							<CardDescription>
								Edit details and metadata for your video
							</CardDescription>
						</CardHeader>
						<CardContent>
							<form className="space-y-6">
								<div className="space-y-2">
									<Label htmlFor="title">Title</Label>
									<Input
										id="title"
										value={form?.title || ""}
										onChange={(e) =>
											setForm((prev) => ({ ...prev!, title: e.target.value }))
										}
									/>
								</div>

								<div className="space-y-2">
									<Label htmlFor="description">Description</Label>
									<Textarea
										id="description"
										value={form?.description || ""}
										onChange={(e) =>
											setForm((prev) => ({
												...prev!,
												description: e.target.value,
											}))
										}
										className="min-h-[150px]"
									/>
								</div>

								<div className="space-y-2">
									<Label htmlFor="tags">Tags (comma separated)</Label>
									<Input
										id="tags"
										value={form?.tags || ""}
										onChange={(e) =>
											setForm((prev) => ({ ...prev!, tags: e.target.value }))
										}
									/>
								</div>

								<div className="space-y-2">
									<Label htmlFor="scheduledTime">Scheduled Publish Time</Label>
									<Input
										id="scheduledTime"
										type="datetime-local"
										value={form?.scheduledTime || ""}
										onChange={(e) =>
											setForm((prev) => ({
												...prev!,
												scheduledTime: e.target.value,
											}))
										}
									/>
								</div>

								<Button
									className="w-full"
									onClick={(e) => {
										e.preventDefault();
										if (!form) return;
										handleSave({
											title: form.title,
											description: form.description,
											tags: form.tags,
											scheduledTime: form.scheduledTime,
										});
									}}
									disabled={saving}
								>
									{saving ? (
										<>
											<Loader2 className="mr-2 h-4 w-4 animate-spin" />
											Saving...
										</>
									) : (
										"Save Changes"
									)}
								</Button>
							</form>
						</CardContent>
					</Card>

					<Card>
						<CardHeader>
							<CardTitle>Raw Data</CardTitle>
							<CardDescription>
								Debug information for developers
							</CardDescription>
						</CardHeader>
						<CardContent>
							<pre className="overflow-auto text-xs bg-muted p-4 rounded-md max-h-[300px]">
								{JSON.stringify(videoData, null, 2)}
							</pre>
						</CardContent>
					</Card>
				</TabsContent>
			</Tabs>
		</div>
	);
}

export const Route = createFileRoute("/video/$videoId")({
	component: VideoDetailComponent,
});

================
File: src/services/gcs-content.ts
================
/**
 * Service to handle fetching content from Google Cloud Storage
 */

// Utility to fetch content from GCS using a publicly accessible URL
export async function fetchGCSContent(url: string): Promise<string> {
	try {
		const response = await fetch(url);

		if (!response.ok) {
			throw new Error(
				`Failed to fetch content: ${response.status} ${response.statusText}`,
			);
		}

		return await response.text();
	} catch (error) {
		console.error("Error fetching GCS content:", error);
		throw error;
	}
}

// Generate a publicly accessible URL for a GCS file (if permission allows)
export function getGCSPublicUrl(bucketName: string, filePath: string): string {
	return `https://storage.googleapis.com/${bucketName}/${filePath}`;
}

// Process the output_files paths from Firestore to generate usable URLs
export function getContentUrls(
	bucketName: string,
	outputFiles: Record<string, string> = {},
) {
	const urls: Record<string, string> = {};

	Object.entries(outputFiles).forEach(([key, path]) => {
		if (path) {
			urls[key] = getGCSPublicUrl(bucketName, path);
		}
	});

	return urls;
}

// Try to fetch content, returns null if not available
export async function tryFetchContent(
	bucketName: string | undefined,
	outputFiles: Record<string, string>,
	contentType: string,
): Promise<string | null> {
	if (!bucketName || !outputFiles[contentType]) {
		return null;
	}

	try {
		const url = getGCSPublicUrl(bucketName, outputFiles[contentType]);
		const content = await fetchGCSContent(url);
		return content;
	} catch (error) {
		console.error(`Error fetching ${contentType}:`, error);
		return null;
	}
}

================
File: src/styles/app.css
================
@import "tailwindcss";

@plugin 'tailwindcss-animate';

@custom-variant dark (&:is(.dark *));

@theme inline {
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
}

:root {
  --radius: 0.5rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.141 0.005 285.823);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.141 0.005 285.823);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.141 0.005 285.823);
  --primary: oklch(0.645 0.246 16.439);
  --primary-foreground: oklch(0.969 0.015 12.422);
  --secondary: oklch(0.967 0.001 286.375);
  --secondary-foreground: oklch(0.21 0.006 285.885);
  --muted: oklch(0.967 0.001 286.375);
  --muted-foreground: oklch(0.552 0.016 285.938);
  --accent: oklch(0.967 0.001 286.375);
  --accent-foreground: oklch(0.21 0.006 285.885);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.92 0.004 286.32);
  --input: oklch(0.92 0.004 286.32);
  --ring: oklch(0.645 0.246 16.439);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.141 0.005 285.823);
  --sidebar-primary: oklch(0.645 0.246 16.439);
  --sidebar-primary-foreground: oklch(0.969 0.015 12.422);
  --sidebar-accent: oklch(0.967 0.001 286.375);
  --sidebar-accent-foreground: oklch(0.21 0.006 285.885);
  --sidebar-border: oklch(0.92 0.004 286.32);
  --sidebar-ring: oklch(0.645 0.246 16.439);
}

.dark {
  --background: oklch(0.141 0.005 285.823);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.21 0.006 285.885);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.21 0.006 285.885);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.645 0.246 16.439);
  --primary-foreground: oklch(0.969 0.015 12.422);
  --secondary: oklch(0.274 0.006 286.033);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.274 0.006 286.033);
  --muted-foreground: oklch(0.705 0.015 286.067);
  --accent: oklch(0.274 0.006 286.033);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.645 0.246 16.439);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.21 0.006 285.885);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.645 0.246 16.439);
  --sidebar-primary-foreground: oklch(0.969 0.015 12.422);
  --sidebar-accent: oklch(0.274 0.006 286.033);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.645 0.246 16.439);
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

================
File: src/utils/loggingMiddleware.ts
================
import { createMiddleware } from '@tanstack/react-start'

const preLogMiddleware = createMiddleware()
  .client(async (ctx) => {
    const clientTime = new Date()

    return ctx.next({
      context: {
        clientTime,
      },
      sendContext: {
        clientTime,
      },
    })
  })
  .server(async (ctx) => {
    const serverTime = new Date()

    return ctx.next({
      sendContext: {
        serverTime,
        durationToServer:
          serverTime.getTime() - ctx.context.clientTime.getTime(),
      },
    })
  })

export const logMiddleware = createMiddleware()
  .middleware([preLogMiddleware])
  .client(async (ctx) => {
    const res = await ctx.next()

    const now = new Date()
    console.log('Client Req/Res:', {
      duration: res.context.clientTime.getTime() - now.getTime(),
      durationToServer: res.context.durationToServer,
      durationFromServer: now.getTime() - res.context.serverTime.getTime(),
    })

    return res
  })

================
File: src/utils/posts.tsx
================
import { notFound } from '@tanstack/react-router'
import { createServerFn } from '@tanstack/react-start'

export type PostType = {
  id: string
  title: string
  body: string
}

export const fetchPost = createServerFn({ method: 'GET' })
  .validator((d: string) => d)
  .handler(async ({ data }) => {
    console.info(`Fetching post with id ${data}...`)
    const res = await fetch(
      `https://jsonplaceholder.typicode.com/posts/${data}`,
    )
    if (!res.ok) {
      if (res.status === 404) {
        throw notFound()
      }

      throw new Error('Failed to fetch post')
    }

    const post = (await res.json()) as PostType

    return post
  })

export const fetchPosts = createServerFn({ method: 'GET' }).handler(
  async () => {
    console.info('Fetching posts...')
    const res = await fetch('https://jsonplaceholder.typicode.com/posts')
    if (!res.ok) {
      throw new Error('Failed to fetch posts')
    }

    const posts = (await res.json()) as Array<PostType>

    return posts
  },
)

================
File: src/utils/seo.ts
================
export const seo = ({
	title,
	description,
	keywords,
	image,
  }: {
	title: string
	description?: string
	image?: string
	keywords?: string
  }) => {
	const tags = [
	  { title },
	  { name: 'description', content: description },
	  { name: 'keywords', content: keywords },
	  { name: 'twitter:title', content: title },
	  { name: 'twitter:description', content: description },
	  { name: 'twitter:creator', content: '@tannerlinsley' },
	  { name: 'twitter:site', content: '@tannerlinsley' },
	  { name: 'og:type', content: 'website' },
	  { name: 'og:title', content: title },
	  { name: 'og:description', content: description },
	  ...(image
		? [
			{ name: 'twitter:image', content: image },
			{ name: 'twitter:card', content: 'summary_large_image' },
			{ name: 'og:image', content: image },
		  ]
		: []),
	]
  
	return tags
  }

================
File: src/utils/supabase.ts
================
import { createServerClient } from "@supabase/ssr";
import { parseCookies, setCookie } from "@tanstack/react-start/server";

export function getSupabaseServerClient() {
	return createServerClient(
		process.env.SUPABASE_URL!,
		process.env.SUPABASE_ANON_KEY!,
		{
			cookies: {
				// @ts-ignore Wait till Supabase overload works
				getAll() {
					return Object.entries(parseCookies()).map(([name, value]) => ({
						name,
						value,
					}));
				},
				setAll(cookies) {
					cookies.forEach((cookie) => {
						setCookie(cookie.name, cookie.value);
					});
				},
			},
		},
	);
}

================
File: src/utils/users.tsx
================
export type User = {
    id: number
    name: string
    email: string
  }
  
  export const DEPLOY_URL = 'http://localhost:3000'

================
File: src/api.ts
================
import {
	createStartAPIHandler,
	defaultAPIFileRouteHandler,
  } from '@tanstack/react-start/api'
  
  export default createStartAPIHandler(defaultAPIFileRouteHandler)

================
File: src/client.tsx
================
/// <reference types="vinxi/types/client" />
import { hydrateRoot } from 'react-dom/client'
import { StartClient } from '@tanstack/react-start'
import { createRouter } from './router'

const router = createRouter()

hydrateRoot(document, <StartClient router={router} />)

================
File: src/global-middleware.ts
================
import { registerGlobalMiddleware } from '@tanstack/react-start'
import { logMiddleware } from './utils/loggingMiddleware'

registerGlobalMiddleware({
  middleware: [logMiddleware],
})

================
File: src/router.tsx
================
import { createRouter as createTanStackRouter } from '@tanstack/react-router'
import { routeTree } from './routeTree.gen'
import { DefaultCatchBoundary } from '@/components/default-catch-boundary'
import { NotFound } from '@/components/not-found'

export function createRouter() {
  const router = createTanStackRouter({
    routeTree,
    defaultPreload: 'intent',
    defaultErrorComponent: DefaultCatchBoundary,
    defaultNotFoundComponent: () => <NotFound />,
    scrollRestoration: true,
  })

  return router
}

declare module '@tanstack/react-router' {
  interface Register {
    router: ReturnType<typeof createRouter>
  }
}

================
File: src/routeTree.gen.ts
================
/* eslint-disable */

// @ts-nocheck

// noinspection JSUnusedGlobalSymbols

// This file was automatically generated by TanStack Router.
// You should NOT make any changes in this file as it will be overwritten.
// Additionally, you should also exclude this file from your linter and/or formatter to prevent it from being checked or modified.

// Import Routes

import { Route as rootRoute } from './routes/__root'
import { Route as SignupImport } from './routes/signup'
import { Route as SettingsImport } from './routes/settings'
import { Route as LogoutImport } from './routes/logout'
import { Route as LoginImport } from './routes/login'
import { Route as DeferredImport } from './routes/deferred'
import { Route as DashboardImport } from './routes/dashboard'
import { Route as PathlessLayoutImport } from './routes/_pathlessLayout'
import { Route as AuthedImport } from './routes/_authed'
import { Route as IndexImport } from './routes/index'
import { Route as VideoVideoIdImport } from './routes/video.$videoId'
import { Route as AuthedPostsImport } from './routes/_authed/posts'
import { Route as AuthedPostsIndexImport } from './routes/_authed/posts.index'
import { Route as AuthedPostsPostIdImport } from './routes/_authed/posts.$postId'

// Create/Update Routes

const SignupRoute = SignupImport.update({
  id: '/signup',
  path: '/signup',
  getParentRoute: () => rootRoute,
} as any)

const SettingsRoute = SettingsImport.update({
  id: '/settings',
  path: '/settings',
  getParentRoute: () => rootRoute,
} as any)

const LogoutRoute = LogoutImport.update({
  id: '/logout',
  path: '/logout',
  getParentRoute: () => rootRoute,
} as any)

const LoginRoute = LoginImport.update({
  id: '/login',
  path: '/login',
  getParentRoute: () => rootRoute,
} as any)

const DeferredRoute = DeferredImport.update({
  id: '/deferred',
  path: '/deferred',
  getParentRoute: () => rootRoute,
} as any)

const DashboardRoute = DashboardImport.update({
  id: '/dashboard',
  path: '/dashboard',
  getParentRoute: () => rootRoute,
} as any)

const PathlessLayoutRoute = PathlessLayoutImport.update({
  id: '/_pathlessLayout',
  getParentRoute: () => rootRoute,
} as any)

const AuthedRoute = AuthedImport.update({
  id: '/_authed',
  getParentRoute: () => rootRoute,
} as any)

const IndexRoute = IndexImport.update({
  id: '/',
  path: '/',
  getParentRoute: () => rootRoute,
} as any)

const VideoVideoIdRoute = VideoVideoIdImport.update({
  id: '/video/$videoId',
  path: '/video/$videoId',
  getParentRoute: () => rootRoute,
} as any)

const AuthedPostsRoute = AuthedPostsImport.update({
  id: '/posts',
  path: '/posts',
  getParentRoute: () => AuthedRoute,
} as any)

const AuthedPostsIndexRoute = AuthedPostsIndexImport.update({
  id: '/',
  path: '/',
  getParentRoute: () => AuthedPostsRoute,
} as any)

const AuthedPostsPostIdRoute = AuthedPostsPostIdImport.update({
  id: '/$postId',
  path: '/$postId',
  getParentRoute: () => AuthedPostsRoute,
} as any)

// Populate the FileRoutesByPath interface

declare module '@tanstack/react-router' {
  interface FileRoutesByPath {
    '/': {
      id: '/'
      path: '/'
      fullPath: '/'
      preLoaderRoute: typeof IndexImport
      parentRoute: typeof rootRoute
    }
    '/_authed': {
      id: '/_authed'
      path: ''
      fullPath: ''
      preLoaderRoute: typeof AuthedImport
      parentRoute: typeof rootRoute
    }
    '/_pathlessLayout': {
      id: '/_pathlessLayout'
      path: ''
      fullPath: ''
      preLoaderRoute: typeof PathlessLayoutImport
      parentRoute: typeof rootRoute
    }
    '/dashboard': {
      id: '/dashboard'
      path: '/dashboard'
      fullPath: '/dashboard'
      preLoaderRoute: typeof DashboardImport
      parentRoute: typeof rootRoute
    }
    '/deferred': {
      id: '/deferred'
      path: '/deferred'
      fullPath: '/deferred'
      preLoaderRoute: typeof DeferredImport
      parentRoute: typeof rootRoute
    }
    '/login': {
      id: '/login'
      path: '/login'
      fullPath: '/login'
      preLoaderRoute: typeof LoginImport
      parentRoute: typeof rootRoute
    }
    '/logout': {
      id: '/logout'
      path: '/logout'
      fullPath: '/logout'
      preLoaderRoute: typeof LogoutImport
      parentRoute: typeof rootRoute
    }
    '/settings': {
      id: '/settings'
      path: '/settings'
      fullPath: '/settings'
      preLoaderRoute: typeof SettingsImport
      parentRoute: typeof rootRoute
    }
    '/signup': {
      id: '/signup'
      path: '/signup'
      fullPath: '/signup'
      preLoaderRoute: typeof SignupImport
      parentRoute: typeof rootRoute
    }
    '/_authed/posts': {
      id: '/_authed/posts'
      path: '/posts'
      fullPath: '/posts'
      preLoaderRoute: typeof AuthedPostsImport
      parentRoute: typeof AuthedImport
    }
    '/video/$videoId': {
      id: '/video/$videoId'
      path: '/video/$videoId'
      fullPath: '/video/$videoId'
      preLoaderRoute: typeof VideoVideoIdImport
      parentRoute: typeof rootRoute
    }
    '/_authed/posts/$postId': {
      id: '/_authed/posts/$postId'
      path: '/$postId'
      fullPath: '/posts/$postId'
      preLoaderRoute: typeof AuthedPostsPostIdImport
      parentRoute: typeof AuthedPostsImport
    }
    '/_authed/posts/': {
      id: '/_authed/posts/'
      path: '/'
      fullPath: '/posts/'
      preLoaderRoute: typeof AuthedPostsIndexImport
      parentRoute: typeof AuthedPostsImport
    }
  }
}

// Create and export the route tree

interface AuthedPostsRouteChildren {
  AuthedPostsPostIdRoute: typeof AuthedPostsPostIdRoute
  AuthedPostsIndexRoute: typeof AuthedPostsIndexRoute
}

const AuthedPostsRouteChildren: AuthedPostsRouteChildren = {
  AuthedPostsPostIdRoute: AuthedPostsPostIdRoute,
  AuthedPostsIndexRoute: AuthedPostsIndexRoute,
}

const AuthedPostsRouteWithChildren = AuthedPostsRoute._addFileChildren(
  AuthedPostsRouteChildren,
)

interface AuthedRouteChildren {
  AuthedPostsRoute: typeof AuthedPostsRouteWithChildren
}

const AuthedRouteChildren: AuthedRouteChildren = {
  AuthedPostsRoute: AuthedPostsRouteWithChildren,
}

const AuthedRouteWithChildren =
  AuthedRoute._addFileChildren(AuthedRouteChildren)

export interface FileRoutesByFullPath {
  '/': typeof IndexRoute
  '': typeof PathlessLayoutRoute
  '/dashboard': typeof DashboardRoute
  '/deferred': typeof DeferredRoute
  '/login': typeof LoginRoute
  '/logout': typeof LogoutRoute
  '/settings': typeof SettingsRoute
  '/signup': typeof SignupRoute
  '/posts': typeof AuthedPostsRouteWithChildren
  '/video/$videoId': typeof VideoVideoIdRoute
  '/posts/$postId': typeof AuthedPostsPostIdRoute
  '/posts/': typeof AuthedPostsIndexRoute
}

export interface FileRoutesByTo {
  '/': typeof IndexRoute
  '': typeof PathlessLayoutRoute
  '/dashboard': typeof DashboardRoute
  '/deferred': typeof DeferredRoute
  '/login': typeof LoginRoute
  '/logout': typeof LogoutRoute
  '/settings': typeof SettingsRoute
  '/signup': typeof SignupRoute
  '/video/$videoId': typeof VideoVideoIdRoute
  '/posts/$postId': typeof AuthedPostsPostIdRoute
  '/posts': typeof AuthedPostsIndexRoute
}

export interface FileRoutesById {
  __root__: typeof rootRoute
  '/': typeof IndexRoute
  '/_authed': typeof AuthedRouteWithChildren
  '/_pathlessLayout': typeof PathlessLayoutRoute
  '/dashboard': typeof DashboardRoute
  '/deferred': typeof DeferredRoute
  '/login': typeof LoginRoute
  '/logout': typeof LogoutRoute
  '/settings': typeof SettingsRoute
  '/signup': typeof SignupRoute
  '/_authed/posts': typeof AuthedPostsRouteWithChildren
  '/video/$videoId': typeof VideoVideoIdRoute
  '/_authed/posts/$postId': typeof AuthedPostsPostIdRoute
  '/_authed/posts/': typeof AuthedPostsIndexRoute
}

export interface FileRouteTypes {
  fileRoutesByFullPath: FileRoutesByFullPath
  fullPaths:
    | '/'
    | ''
    | '/dashboard'
    | '/deferred'
    | '/login'
    | '/logout'
    | '/settings'
    | '/signup'
    | '/posts'
    | '/video/$videoId'
    | '/posts/$postId'
    | '/posts/'
  fileRoutesByTo: FileRoutesByTo
  to:
    | '/'
    | ''
    | '/dashboard'
    | '/deferred'
    | '/login'
    | '/logout'
    | '/settings'
    | '/signup'
    | '/video/$videoId'
    | '/posts/$postId'
    | '/posts'
  id:
    | '__root__'
    | '/'
    | '/_authed'
    | '/_pathlessLayout'
    | '/dashboard'
    | '/deferred'
    | '/login'
    | '/logout'
    | '/settings'
    | '/signup'
    | '/_authed/posts'
    | '/video/$videoId'
    | '/_authed/posts/$postId'
    | '/_authed/posts/'
  fileRoutesById: FileRoutesById
}

export interface RootRouteChildren {
  IndexRoute: typeof IndexRoute
  AuthedRoute: typeof AuthedRouteWithChildren
  PathlessLayoutRoute: typeof PathlessLayoutRoute
  DashboardRoute: typeof DashboardRoute
  DeferredRoute: typeof DeferredRoute
  LoginRoute: typeof LoginRoute
  LogoutRoute: typeof LogoutRoute
  SettingsRoute: typeof SettingsRoute
  SignupRoute: typeof SignupRoute
  VideoVideoIdRoute: typeof VideoVideoIdRoute
}

const rootRouteChildren: RootRouteChildren = {
  IndexRoute: IndexRoute,
  AuthedRoute: AuthedRouteWithChildren,
  PathlessLayoutRoute: PathlessLayoutRoute,
  DashboardRoute: DashboardRoute,
  DeferredRoute: DeferredRoute,
  LoginRoute: LoginRoute,
  LogoutRoute: LogoutRoute,
  SettingsRoute: SettingsRoute,
  SignupRoute: SignupRoute,
  VideoVideoIdRoute: VideoVideoIdRoute,
}

export const routeTree = rootRoute
  ._addFileChildren(rootRouteChildren)
  ._addFileTypes<FileRouteTypes>()

/* ROUTE_MANIFEST_START
{
  "routes": {
    "__root__": {
      "filePath": "__root.tsx",
      "children": [
        "/",
        "/_authed",
        "/_pathlessLayout",
        "/dashboard",
        "/deferred",
        "/login",
        "/logout",
        "/settings",
        "/signup",
        "/video/$videoId"
      ]
    },
    "/": {
      "filePath": "index.tsx"
    },
    "/_authed": {
      "filePath": "_authed.tsx",
      "children": [
        "/_authed/posts"
      ]
    },
    "/_pathlessLayout": {
      "filePath": "_pathlessLayout.tsx"
    },
    "/dashboard": {
      "filePath": "dashboard.tsx"
    },
    "/deferred": {
      "filePath": "deferred.tsx"
    },
    "/login": {
      "filePath": "login.tsx"
    },
    "/logout": {
      "filePath": "logout.tsx"
    },
    "/settings": {
      "filePath": "settings.tsx"
    },
    "/signup": {
      "filePath": "signup.tsx"
    },
    "/_authed/posts": {
      "filePath": "_authed/posts.tsx",
      "parent": "/_authed",
      "children": [
        "/_authed/posts/$postId",
        "/_authed/posts/"
      ]
    },
    "/video/$videoId": {
      "filePath": "video.$videoId.tsx"
    },
    "/_authed/posts/$postId": {
      "filePath": "_authed/posts.$postId.tsx",
      "parent": "/_authed/posts"
    },
    "/_authed/posts/": {
      "filePath": "_authed/posts.index.tsx",
      "parent": "/_authed/posts"
    }
  }
}
ROUTE_MANIFEST_END */

================
File: src/ssr.tsx
================
/// <reference types="vinxi/types/server" />
import {
	createStartHandler,
	defaultStreamHandler,
  } from "@tanstack/react-start/server";
  import { getRouterManifest } from "@tanstack/react-start/router-manifest";
  
  import { createRouter } from "./router";
  
  export default createStartHandler({
	createRouter,
	getRouterManifest,
  })(defaultStreamHandler);

================
File: web-memory-bank/examples/posts_.$postId.deep.tsx
================
import { Link, createFileRoute } from '@tanstack/react-router'
import { fetchPost } from '@/utils/posts'
import { PostErrorComponent } from '@/components/post-error'

export const Route = createFileRoute('/posts_/$postId/deep')({
  loader: async ({ params: { postId } }) =>
    fetchPost({
      data: postId,
    }),
  errorComponent: PostErrorComponent,
  component: PostDeepComponent,
})

function PostDeepComponent() {
  const post = Route.useLoaderData()

  return (
    <div className="p-2 space-y-2">
      <Link
        to="/posts"
        className="block py-1 text-blue-800 hover:text-blue-600"
      >
        ← All Posts
      </Link>
      <h4 className="text-xl font-bold underline">{post.title}</h4>
      <div className="text-sm">{post.body}</div>
    </div>
  )
}

================
File: web-memory-bank/examples/posts.$postId.tsx
================
import { Link, createFileRoute } from '@tanstack/react-router'
import { fetchPost } from '../utils/posts'
import { NotFound } from '@/components/not-found'
import { PostErrorComponent } from '@/components/post-error'

export const Route = createFileRoute('/posts/$postId')({
  loader: ({ params: { postId } }) => fetchPost({ data: postId }),
  errorComponent: PostErrorComponent,
  component: PostComponent,
  notFoundComponent: () => {
    return <NotFound>Post not found</NotFound>
  },
})

function PostComponent() {
  const post = Route.useLoaderData()

  return (
    <div className="space-y-2">
      <h4 className="text-xl font-bold underline">{post.title}</h4>
      <div className="text-sm">{post.body}</div>
      <Link
        to="/posts/$postId/deep"
        params={{
          postId: post.id,
        }}
        activeProps={{ className: 'text-black font-bold' }}
        className="block py-1 text-blue-800 hover:text-blue-600"
      >
        Deep View
      </Link>
    </div>
  )
}

================
File: web-memory-bank/examples/posts.index.tsx
================
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/posts/')({
  component: PostsIndexComponent,
})

function PostsIndexComponent() {
  return <div>Select a post.</div>
}

================
File: web-memory-bank/examples/posts.route.tsx
================
import { Link, Outlet, createFileRoute } from '@tanstack/react-router'
import { fetchPosts } from '../utils/posts'

export const Route = createFileRoute('/posts')({
  loader: async () => fetchPosts(),
  component: PostsLayoutComponent,
})

function PostsLayoutComponent() {
  const posts = Route.useLoaderData()

  return (
    <div className="p-2 flex gap-2">
      <ul className="list-disc pl-4">
        {[...posts, { id: 'i-do-not-exist', title: 'Non-existent Post' }].map(
          (post) => {
            return (
              <li key={post.id} className="whitespace-nowrap">
                <Link
                  to="/posts/$postId"
                  params={{
                    postId: post.id,
                  }}
                  className="block py-1 text-blue-800 hover:text-blue-600"
                  activeProps={{ className: 'text-black font-bold' }}
                >
                  <div>{post.title.substring(0, 20)}</div>
                </Link>
              </li>
            )
          },
        )}
      </ul>
      <hr />
      <Outlet />
    </div>
  )
}

================
File: web-memory-bank/examples/users.$userId.tsx
================
import { createFileRoute } from '@tanstack/react-router'
import type { User } from '@/utils/users'
import { DEPLOY_URL } from '@/utils/users'
import { NotFound } from '@/components/not-found'
import { UserErrorComponent } from '@/components/user-error'

export const Route = createFileRoute('/users/$userId')({
  loader: async ({ params: { userId } }) => {
    try {
      const res = await fetch(DEPLOY_URL + '/api/users/' + userId)
      if (!res.ok) {
        throw new Error('Unexpected status code')
      }

      const data = (await res.json()) as User

      return data
    } catch {
      throw new Error('Failed to fetch user')
    }
  },
  errorComponent: UserErrorComponent,
  component: UserComponent,
  notFoundComponent: () => {
    return <NotFound>User not found</NotFound>
  },
})

function UserComponent() {
  const user = Route.useLoaderData()

  return (
    <div className="space-y-2">
      <h4 className="text-xl font-bold underline">{user.name}</h4>
      <div className="text-sm">{user.email}</div>
    </div>
  )
}

================
File: web-memory-bank/examples/users.index.tsx
================
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/users/')({
  component: UsersIndexComponent,
})

function UsersIndexComponent() {
  return <div>Select a user.</div>
}

================
File: web-memory-bank/active-context.md
================
# Active Context

## Current Work Focus

The frontend is currently undergoing a significant migration with three main focus areas:

1. **Authentication Migration**: Replacing Firebase authentication with Supabase Google OAuth, including:
   - Creating a `GoogleLoginButton` component
   - Setting up Supabase client integration
   - Implementing authentication state management
   - Creating a protected route layout

2. **Real-time Updates**: Implementing WebSocket-based real-time updates to replace Firebase listeners, including:
   - Creating a `use-app-websocket` hook
   - Handling WebSocket connection lifecycle
   - Integrating WebSocket updates with TanStack Query cache
   - Updating components to handle WebSocket messages

3. **Cleanup & Refactoring**: Removing Firebase dependencies and unused example code, including:
   - Removing `firebase.ts` and related imports
   - Cleaning up unused routes and components
   - Refactoring dashboard and video detail views
   - Implementing proper error handling

## Recent Changes

- Identified Firebase dependencies and usage patterns throughout the codebase
- Created PRD and implementation plan for the migration
- Documented WebSocket message format expectations
- Defined standardized error handling patterns
- Outlined component structure for the refactored application

## Next Steps

1. **Initial Authentication Setup**:
   - Implement `GoogleLoginButton` component
   - Create `_authenticated.tsx` layout for protected routes
   - Set up Supabase session listener in `__root.tsx`
   - Update API client to include JWT in requests

2. **Core WebSocket Implementation**:
   - Create `use-app-websocket.ts` hook
   - Implement connection management and message handling
   - Define integration with TanStack Query

3. **Dashboard Refactoring**:
   - Update `dashboard.tsx` to fetch via API instead of Firebase
   - Integrate WebSocket updates for real-time status changes
   - Implement loading and error states

4. **Video Detail View Refactoring**:
   - Update `video.$videoId.tsx` to fetch from API
   - Implement or adapt thumbnail gallery
   - Create metadata editor with save functionality

5. **Removal of Firebase**:
   - Remove Firebase SDK from `package.json`
   - Clean up Firebase initialization and imports
   - Verify application functions without Firebase dependencies

## Active Decisions and Considerations

1. **WebSocket Message Handling**: Currently deciding between two approaches:
   - Direct TanStack Query cache manipulation based on message type
   - Query invalidation triggering refetch from API
   - Leaning toward a hybrid approach based on message type

2. **Authentication Flow**:
   - Considering best approach for handling authentication redirects
   - Evaluating use of TanStack Router's capabilities for route protection
   - Need to ensure Supabase session persistence works correctly

3. **Error Handling**:
   - Defining standardized error handling patterns
   - Creating appropriate error types for different failure scenarios
   - Determining retry strategies for network failures

4. **Thumbnail Gallery**:
   - Deciding between creating a new component or adapting existing UI
   - Considering interaction patterns for thumbnail selection
   - Planning for efficient rendering of potentially many thumbnails

## Important Patterns and Preferences

1. **Component Structure**:
   - Feature components (`/components/video/*`) should compose UI components (`/components/ui/*`)
   - Route components should primarily handle data fetching and composition
   - Common functionality should be extracted to hooks

2. **State Management**:
   - Server state should be managed with TanStack Query
   - Authentication state should be global using Supabase's auth state listener
   - UI-specific state should use local component state
   - WebSocket updates should integrate with the TanStack Query cache

3. **Code Organization**:
   - Group related components in folders
   - Keep routes flat and aligned with URL structure
   - Extract reusable logic to hooks
   - Use consistent naming patterns

## Learnings and Project Insights

1. **Transition Complexity**: Migration from Firebase to Supabase is more than just swapping libraries - it requires rethinking authentication flow, real-time updates, and error handling.

2. **WebSocket Integration**: Handling WebSocket messages efficiently requires careful integration with the application's state management strategy.

3. **Authentication Flow**: OAuth flows require careful handling of redirects and session management to ensure a smooth user experience.

4. **Real-time UX**: Users expect immediate feedback on long-running processes like video processing, making real-time updates critical to the experience.

================
File: web-memory-bank/error-handling.md
================
# Error Handling Standards

This document outlines the standardized error handling patterns to be implemented across the frontend application. It defines error types, user-facing feedback mechanisms, and recovery strategies.

## Error Types

The application defines several error types to categorize different failure scenarios:

```typescript
// api.ts or errors.ts
export class AppError extends Error {
  constructor(message: string) {
    super(message);
    this.name = 'AppError';
  }
}

export class AuthenticationError extends AppError {
  constructor(message = 'Authentication failed. Please log in again.') {
    super(message);
    this.name = 'AuthenticationError';
  }
}

export class NetworkError extends AppError {
  constructor(message = 'Network connection issue. Please check your internet connection.') {
    super(message);
    this.name = 'NetworkError';
  }
}

export class ValidationError extends AppError {
  constructor(message = 'Invalid input data. Please check your entries.') {
    super(message);
    this.name = 'ValidationError';
  }
}

export class ServerError extends AppError {
  constructor(message = 'Server error. Our team has been notified.') {
    super(message);
    this.name = 'ServerError';
  }
}

export class WebSocketError extends AppError {
  constructor(message = 'Real-time connection error. Updates may be delayed.') {
    super(message);
    this.name = 'WebSocketError';
  }
}
```

## API Error Handling

All API requests should use a standardized error handling approach:

```typescript
// Example API client function with error handling
async function fetchVideos() {
  try {
    const response = await fetch('/api/videos', {
      headers: {
        'Authorization': `Bearer ${getSupabaseToken()}`
      }
    });
    
    if (!response.ok) {
      // Handle different HTTP status codes
      if (response.status === 401 || response.status === 403) {
        throw new AuthenticationError();
      } else if (response.status === 400) {
        throw new ValidationError();
      } else if (response.status >= 500) {
        throw new ServerError();
      } else {
        throw new AppError(`Request failed with status: ${response.status}`);
      }
    }
    
    return await response.json();
  } catch (error) {
    // Categorize uncaught errors
    if (error instanceof AppError) {
      // Rethrow our custom errors
      throw error;
    } else if (error instanceof TypeError && error.message.includes('fetch')) {
      // Network errors
      throw new NetworkError();
    } else {
      // Unknown errors
      console.error('Unexpected error:', error);
      throw new AppError('An unexpected error occurred');
    }
  }
}
```

## User Feedback Mechanisms

### Toast Notifications

Use toast notifications for transient errors:

```typescript
// Example usage with shadcn/ui toast
import { useToast } from '@/components/ui/use-toast';

function ExampleComponent() {
  const { toast } = useToast();
  
  const handleAction = async () => {
    try {
      await someApiCall();
    } catch (error) {
      toast({
        variant: error instanceof ValidationError ? 'warning' : 'destructive',
        title: error.name,
        description: error.message,
        action: error instanceof NetworkError ? (
          <ToastAction altText="Retry" onClick={handleAction}>Retry</ToastAction>
        ) : undefined
      });
    }
  };
}
```

### Form Validation Errors

Display form validation errors inline:

```tsx
function FormExample() {
  const [errors, setErrors] = useState<Record<string, string>>({});
  
  const handleSubmit = async (data) => {
    try {
      setErrors({});
      await submitForm(data);
    } catch (error) {
      if (error instanceof ValidationError && error.fieldErrors) {
        setErrors(error.fieldErrors);
      } else {
        // Handle other errors with toast
      }
    }
  };
  
  return (
    <form onSubmit={handleSubmit}>
      <div>
        <Label htmlFor="title">Title</Label>
        <Input id="title" />
        {errors.title && (
          <p className="text-sm text-red-500">{errors.title}</p>
        )}
      </div>
      {/* Other form fields */}
    </form>
  );
}
```

### Error States

Implement error states for failed data loading:

```tsx
function DataComponent() {
  const { data, isLoading, error, refetch } = useQuery({
    queryKey: ['data'],
    queryFn: fetchData
  });
  
  if (isLoading) {
    return <LoadingSpinner />;
  }
  
  if (error) {
    return (
      <div className="error-container">
        <p>Failed to load data: {error.message}</p>
        <Button onClick={() => refetch()}>Retry</Button>
      </div>
    );
  }
  
  return <DataDisplay data={data} />;
}
```

## Retry Strategies

### Automatic Retries

Implement automatic retries for network errors:

```typescript
// Example retry logic for API calls
async function fetchWithRetry(url, options, maxRetries = 3) {
  let retries = 0;
  
  while (retries < maxRetries) {
    try {
      const response = await fetch(url, options);
      if (response.ok) return response.json();
      
      // Don't retry for client errors (except 429 too many requests)
      if (response.status >= 400 && response.status < 500 && response.status !== 429) {
        handleErrorByStatus(response);
      }
      
      // For 5xx and 429 errors, retry
      throw new NetworkError(`Request failed with status: ${response.status}`);
    } catch (error) {
      retries += 1;
      
      if (retries >= maxRetries) {
        throw error;
      }
      
      // Exponential backoff
      const delay = Math.min(1000 * (2 ** retries) + Math.random() * 1000, 10000);
      await new Promise(resolve => setTimeout(resolve, delay));
    }
  }
}
```

### TanStack Query Configuration

Configure TanStack Query for automatic retries:

```typescript
// Configure in QueryClient setup
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: (failureCount, error) => {
        // Don't retry for authentication or validation errors
        if (error instanceof AuthenticationError || error instanceof ValidationError) {
          return false;
        }
        // Retry network errors up to 3 times
        if (error instanceof NetworkError) {
          return failureCount < 3;
        }
        // Default retry logic
        return failureCount < 2;
      },
      retryDelay: attemptIndex => Math.min(1000 * (2 ** attemptIndex), 30000),
    },
  },
});
```

## Error Handling for WebSockets

The WebSocket hook should include specific error handling:

```typescript
function useAppWebSocket() {
  const [connectionStatus, setConnectionStatus] = useState('disconnected');
  const [error, setError] = useState<Error | null>(null);
  
  // Connection logic with error handling
  useEffect(() => {
    let ws: WebSocket | null = null;
    let reconnectAttempts = 0;
    let reconnectTimeout: NodeJS.Timeout | null = null;
    
    const connect = () => {
      try {
        ws = new WebSocket(`${WEBSOCKET_URL}?token=${getSupabaseToken()}`);
        
        ws.onopen = () => {
          setConnectionStatus('connected');
          setError(null);
          reconnectAttempts = 0;
        };
        
        ws.onclose = (event) => {
          setConnectionStatus('disconnected');
          
          // Don't reconnect if closed cleanly (code 1000)
          if (event.code !== 1000) {
            reconnect();
          }
        };
        
        ws.onerror = (event) => {
          setError(new WebSocketError('Connection error occurred'));
          ws?.close();
        };
        
        // Message handling logic
      } catch (err) {
        setError(new WebSocketError('Failed to establish connection'));
        reconnect();
      }
    };
    
    const reconnect = () => {
      if (reconnectTimeout) {
        clearTimeout(reconnectTimeout);
      }
      
      reconnectAttempts += 1;
      setConnectionStatus('reconnecting');
      
      // Exponential backoff with max delay
      const delay = Math.min(1000 * (2 ** reconnectAttempts), 30000);
      
      reconnectTimeout = setTimeout(() => {
        connect();
      }, delay);
    };
    
    connect();
    
    return () => {
      if (reconnectTimeout) {
        clearTimeout(reconnectTimeout);
      }
      if (ws) {
        ws.close(1000, 'Component unmounting');
      }
    };
  }, []);
  
  // Rest of the hook implementation
}
```

## Authentication Error Handling

For authentication errors, implement automatic redirection to login:

```typescript
// Global error handler for authentication errors
function AuthErrorHandler({ children }) {
  const navigate = useNavigate();
  
  // Set up a global error boundary or listener
  useEffect(() => {
    const handleUnauthorized = (error) => {
      if (error instanceof AuthenticationError) {
        // Clear local auth state
        // Redirect to login
        navigate('/login', { 
          state: { 
            from: window.location.pathname,
            reason: 'session_expired' 
          } 
        });
      }
    };
    
    // Listen to custom error events
    window.addEventListener('app:error', (e) => handleUnauthorized(e.detail));
    
    return () => {
      window.removeEventListener('app:error', (e) => handleUnauthorized(e.detail));
    };
  }, [navigate]);
  
  return children;
}
```

## Error Logging

Implement consistent error logging:

```typescript
// Error logger utility
export function logError(error: Error, context?: Record<string, any>) {
  console.error('Application error:', {
    name: error.name,
    message: error.message,
    stack: error.stack,
    context,
    timestamp: new Date().toISOString(),
  });
  
  // In production, could send to error monitoring service
  if (import.meta.env.PROD) {
    // Send to monitoring service
  }
}
```

================
File: web-memory-bank/file-trees.md
================
# Frontend File Structure Comparison: Current vs. Proposed

This document compares the current frontend file structure with the proposed structure after refactoring to integrate Supabase authentication, FastAPI WebSockets, and removing legacy Firebase code and unused examples.

## Current Frontend Structure (Before Refactor)

```
frontend
├── app.config.ts
├── biome.json
├── components.json
├── Dockerfile
├── docs
│   ├── fe-prd.txt
│   └── overview.md
├── firebase.ts                     # <-- To be removed
├── package.json
├── pnpm-lock.yaml
├── postcss.config.mjs
├── public
│   ├── fonts
│   │   └── ... (font files)
│   └── vite.svg
├── README.md
├── src
│   ├── api.ts                      # <-- To be refactored (add JWT)
│   ├── client.tsx                  # (Entry point)
│   ├── components
│   │   ├── auth.tsx                # <-- To be refactored (Supabase)
│   │   ├── default-catch-boundary.tsx
│   │   ├── home
│   │   │   └── hero.tsx
│   │   ├── login.tsx               # <-- To be refactored (Supabase OAuth)
│   │   ├── not-found.tsx
│   │   ├── post-error.tsx          # <-- To be removed (example)
│   │   ├── shared
│   │   │   ├── container.tsx
│   │   │   └── navbar.tsx          # <-- Needs logout integration
│   │   ├── ui
│   │   │   ├── ... (shadcn components)
│   │   │   └── dropzone.tsx        # <-- To be adapted (GCS Upload)
│   │   ├── user-error.tsx          # <-- To be removed (example)
│   │   └── video                   # (Core video components)
│   │       ├── content-editor.tsx  # <-- To be adapted (Metadata save)
│   │       ├── processing-dashboard.tsx # <-- Needs WebSocket integration
│   │       ├── processing-steps.ts # <-- Needs backend alignment
│   │       ├── thumbnail-gallery.tsx # <-- To be adapted/implemented
│   │       ├── title-selector.tsx  # <-- Likely merged/adapted
│   │       ├── video-detail.tsx    # <-- Needs WebSocket integration
│   │       └── video-progress-card.tsx # <-- Needs WebSocket integration
│   ├── global-middleware.ts      # <-- Review usage
│   ├── hooks
│   │   ├── use-mobile.ts
│   │   └── useMutation.ts        # <-- Review/adapt for TanStack Query/API client
│   ├── lib
│   │   └── utils.ts              # (General utils)
│   ├── router.tsx                # (TanStack Router setup)
│   ├── routes
│   │   ├── __root.tsx            # <-- Potentially add global auth listener
│   │   ├── _authed               # <-- Folder likely removed/refactored
│   │   │   ├── posts.$postId.tsx # <-- To be removed (example)
│   │   │   ├── posts.index.tsx   # <-- To be removed (example)
│   │   │   └── posts.tsx         # <-- To be removed (example)
│   │   ├── _authed.tsx           # <-- Needs Supabase session check
│   │   ├── _pathlessLayout       # <-- Review usage/remove if unused examples
│   │   │   └── ...
│   │   ├── api                   # <-- Folder likely removed (backend API exists)
│   │   │   ├── users.$id.ts      # <-- To be removed (example)
│   │   │   └── users.ts          # <-- To be removed (example)
│   │   ├── dashboard.tsx         # <-- Needs refactoring (API Fetch + WebSocket)
│   │   ├── deferred.tsx          # <-- Review usage
│   │   ├── index.tsx             # (Home page)
│   │   ├── login.tsx             # <-- Needs refactoring (Supabase OAuth)
│   │   ├── logout.tsx            # <-- Needs Supabase signout
│   │   ├── posts.$postId.tsx     # <-- To be moved to examples
│   │   ├── posts.index.tsx       # <-- To be moved to examples
│   │   ├── posts.route.tsx       # <-- To be moved to examples
│   │   ├── posts_.$postId.deep.tsx # <-- To be moved to examples
│   │   ├── redirect.tsx          # <-- Review usage
│   │   ├── settings.tsx          # <-- Needs refactoring if user settings exist
│   │   ├── signup.tsx            # <-- Needs refactoring/removal (Using Google OAuth)
│   │   ├── users.$userId.tsx     # <-- To be moved to examples
│   │   ├── users.index.tsx       # <-- To be moved to examples
│   │   ├── users.route.tsx       # <-- Needs removal (example)
│   │   └── video.$videoId.tsx    # <-- Needs refactoring (API Fetch + WebSocket)
│   ├── routeTree.gen.ts          # (Auto-generated by TanStack Router)
│   ├── services
│   │   └── gcs-content.ts        # <-- Likely removed (Backend handles GCS directly)
│   ├── ssr.tsx                   # (Server-side rendering entry)
│   ├── styles
│   │   └── app.css
│   └── utils
│       ├── loggingMiddleware.ts  # <-- Review usage
│       ├── posts.tsx             # <-- To be removed (example)
│       ├── seo.ts
│       ├── supabase.ts           # <-- Likely removed (Use db/supabase/clients)
│       └── users.tsx             # <-- To be removed (example)
├── tsconfig.json
└── vitest.config.ts
```

## Proposed Frontend Structure (Post Refactor)

This structure reflects the integration with Supabase/FastAPI, removal of Firebase, and cleanup of examples.

```
frontend
├── app.config.ts
├── biome.json
├── components.json
├── Dockerfile
├── docs                          # <-- Contains examples now
│   ├── examples                  # <-- Moved example files here
│   │   ├── posts.$postId.deep.tsx
│   │   ├── posts.$postId.tsx
│   │   ├── posts.index.tsx
│   │   ├── posts.route.tsx
│   │   ├── users.$userId.tsx
│   │   └── users.index.tsx
│   ├── fe-prd.txt                # (PRD - This file)
│   ├── file-structure-comparison.md # (This file)
│   ├── implementation-tasks-frontend.md # (New tasks doc)
│   └── overview.md
├── package.json                  # <-- Firebase removed from deps
├── pnpm-lock.yaml
├── postcss.config.mjs
├── public
│   ├── fonts
│   │   └── ... (font files)
│   └── vite.svg
├── README.md
├── src
│   ├── api.ts                    # <-- Refactored (Handles JWT)
│   ├── client.tsx
│   ├── components
│   │   ├── auth                  # <-- New or refactored auth components
│   │   │   └── GoogleLoginButton.tsx # (Example)
│   │   ├── default-catch-boundary.tsx
│   │   ├── home
│   │   │   └── hero.tsx
│   │   ├── shared
│   │   │   ├── container.tsx
│   │   │   └── navbar.tsx        # <-- Updated with Supabase logout
│   │   ├── ui
│   │   │   ├── ... (shadcn components)
│   │   │   └── dropzone.tsx      # <-- Adapted for GCS Signed URL Upload
│   │   └── video
│   │       ├── content-editor.tsx # <-- Adapted for API Save
│   │       ├── processing-dashboard.tsx # <-- Uses API + WebSocket
│   │       ├── thumbnail-gallery.tsx # <-- Displays generated thumbs
│   │       ├── video-detail.tsx    # <-- Uses API + WebSocket
│   │       └── video-progress-card.tsx # <-- Uses API + WebSocket
│   ├── hooks
│   │   ├── use-app-websocket.ts  # <-- New: Manages WebSocket connection
│   │   └── use-mobile.ts
│   ├── lib
│   │   └── utils.ts
│   ├── router.tsx                # (TanStack Router setup)
│   ├── routes
│   │   ├── __root.tsx            # <-- Includes Supabase auth listener
│   │   ├── _authenticated.tsx    # <-- New/Refactored guard using Supabase session
│   │   ├── dashboard.tsx         # <-- Uses API + WebSocket
│   │   ├── index.tsx             # (Home page)
│   │   ├── login.tsx             # <-- Simplified for OAuth trigger
│   │   └── video.$videoId.tsx    # <-- Uses API + WebSocket
│   ├── routeTree.gen.ts          # (Auto-generated)
│   ├── styles
│   │   └── app.css
│   └── utils
│       └── seo.ts
├── tsconfig.json
└── vitest.config.ts

# Note: Also depends on ../db/supabase/clients/client.ts for Supabase interaction
```

## Key Changes and Benefits

1.  **Authentication Shift:** Firebase Auth (`firebase.ts`, `utils/supabase.ts`?) is replaced by Supabase Auth (`db/supabase/clients/client.ts`). Authentication components (`auth.tsx`, `login.tsx`) and route guards (`_authed.tsx`) are refactored.
    *   *Benefit:* Centralized authentication using Supabase, leveraging its Google OAuth integration.
2.  **Real-time Shift:** Firebase listeners are replaced by a dedicated WebSocket hook (`hooks/use-app-websocket.ts`) connecting to the FastAPI backend. Components (`processing-dashboard.tsx`, `video-detail.tsx`) are updated to consume WebSocket data via state management (TanStack Query).
    *   *Benefit:* Direct real-time communication with the application backend, removing third-party dependency for this core feature.
3.  **API Client Enhancement:** The API client (`api.ts`) is updated to handle Supabase JWT authentication for communicating with the FastAPI backend.
    *   *Benefit:* Secure communication with the backend API.
4.  **Upload Mechanism Change:** Uploads now target GCS via signed URLs obtained from the backend, adapting components like `dropzone.tsx`.
    *   *Benefit:* Scalable direct-to-cloud storage uploads, reducing load on the backend application server.
5.  **Example Code Removal:** Unused routes and components related to 'posts' and 'users' are removed from the main `src` directory, cleaning up the codebase. Relevant examples are archived in `docs/docs-frontend/examples`.
    *   *Benefit:* Reduced codebase size and complexity, focusing only on video processing functionality.
6.  **Dependency Cleanup:** Firebase SDK is removed from `package.json`.
    *   *Benefit:* Fewer dependencies, smaller bundle size, simplified build process.
7.  **Clearer Data Flow:** Frontend primarily interacts with the backend API for data, which abstracts the underlying Supabase DB and GCS storage details. Direct Supabase client usage is mainly for authentication.
    *   *Benefit:* Better separation of concerns, frontend is less coupled to specific backend storage implementations.

================
File: web-memory-bank/overview.md
================
# Frontend Overview

This document provides a high-level overview of the frontend application for the Video Processing Pipeline project.

## Purpose

The frontend serves as the user interface for content creators and administrators to:
*   Upload video files for processing.
*   Monitor the real-time progress of video analysis and metadata generation.
*   Review, edit, and approve AI-generated metadata (titles, descriptions, tags, transcripts, chapters).
*   Trigger the final publishing process (e.g., to YouTube).

## Technology Stack

*   **Framework:** React (using Vite for development and build)
*   **Language:** TypeScript
*   **Routing:** TanStack Router
*   **UI Components:** shadcn/ui library, supplemented with custom components.
*   **API Communication:** A custom client wrapper (`src/api.ts`) interacts with the backend FastAPI.
*   **Real-time:** FastAPI WebSockets (currently migrating away from a legacy Firebase implementation).
*   **State Management:** To be defined/implemented (potential candidates: Zustand, Jotai, TanStack Query).
*   **Package Management:** PNPM

## Project Structure Highlights

*   `src/`: Contains all source code.
    *   `components/`: Reusable React components, including UI elements (`ui/`) and feature-specific components (`video/`, `home/`, `shared/`).
    *   `routes/`: Defines application routes using TanStack Router's file-based routing convention. Includes authentication layout (`_authed/`) and placeholder routes.
    *   `lib/`: Utility functions (`utils.ts`).
    *   `hooks/`: Custom React hooks.
    *   `services/`: Potential location for business logic services (e.g., WebSocket client, GCS interactions).
    *   `api.ts`: Wrapper for making backend API calls.
    *   `router.tsx`: TanStack Router setup.
    *   `client.tsx`/`ssr.tsx`: Application entry points for client/server.
*   `public/`: Static assets.
*   `docs/`: Project documentation, including this overview, PRD (`fe-prd.txt`), and implementation tasks (`fe-implementation-tasks.md`).
*   `firebase.ts`: Legacy Firebase configuration (to be removed).

## Current Status

The frontend is undergoing a migration from Firebase-based real-time updates to a FastAPI WebSocket architecture, integrating with a new backend API. Many core components and routes exist, but some are placeholders or require refactoring to align with the new architecture as detailed in `fe-implementation-tasks.md`.

================
File: web-memory-bank/prd.txt
================
# FRONTEND - PRODUCT REQUIREMENTS DOCUMENT (PRD) - V2

## 1. Overview

This Product Requirements Document (PRD) outlines the specifications for the frontend application of the Video Processing Pipeline system. The frontend provides users (primarily Content Creators) with an interface to authenticate using Google via Supabase, upload videos directly to Google Cloud Storage (GCS), monitor processing progress in real-time via FastAPI WebSockets, review and edit AI-generated metadata (including selecting a final thumbnail from multiple generated options), and manage the video publishing workflow. This document focuses on the core requirements for migrating the frontend to integrate seamlessly with the backend FastAPI API and Supabase (for authentication and non-file metadata persistence), removing legacy Firebase dependencies (e.g., `frontend/firebase.ts`) and unused example code (e.g., various files under `frontend/src/routes/posts*`, `frontend/src/routes/users*`).

## 2. Project goals

### 2.1 Primary goals

-   Provide an intuitive user interface, evolving from existing components (e.g., `frontend/src/components/video/*`, `frontend/src/components/shared/*`) for interacting with the video processing pipeline, authenticated via Supabase Google OAuth.
-   Integrate seamlessly with Supabase for user authentication and session management, utilizing the client setup in `db/supabase/clients/client.ts`.
-   Implement video uploads directly to GCS using signed URLs from the backend, potentially adapting existing upload UI components like `frontend/src/components/ui/dropzone.tsx`.
-   Display real-time updates on video processing status and generated metadata using FastAPI WebSockets, updating components like `frontend/src/components/video/processing-dashboard.tsx` and `frontend/src/components/video/video-detail.tsx`.
-   Allow users to review and edit generated video metadata (fetching/saving via backend API), including selecting a final thumbnail from a gallery (e.g., a new or adapted `frontend/src/components/video/thumbnail-gallery.tsx`), using editor components like `frontend/src/components/video/content-editor.tsx`.
-   Ensure secure communication between the frontend, Supabase (auth), GCS (uploads), and the backend FastAPI API (metadata, job control, signed URLs, WebSocket).
-   Completely remove all Firebase dependencies and listeners (from `frontend/package.json`, `frontend/firebase.ts`, etc.).
-   Remove unused example routes and components related to 'posts' and 'users' (e.g., `frontend/src/routes/posts.*`, `frontend/src/routes/_authed/*`, `frontend/src/utils/posts.tsx`, etc.).
-   Maintain a responsive and modern user experience using React (via `frontend/src/client.tsx`), TanStack Router (configured in `frontend/src/router.tsx`), and shadcn/ui components (from `frontend/src/components/ui/*`).

### 2.2 Success metrics

-   Successful user authentication via Supabase Google OAuth flow.
-   Successful video uploads to GCS via signed URLs.
-   Real-time status updates appear within 1 second of backend events via WebSockets.
-   API interactions (metadata fetch/update, signed URL request) complete within 500ms (p95) after authentication, measured using API client (`frontend/src/api.ts` or replacement).
-   User satisfaction score of 4.5/5 or higher for interface usability, authentication, upload, and real-time feedback.
-   Successful implementation and stability of FastAPI WebSocket connection and message handling.
-   Backend API endpoints are correctly protected and accessible using the Supabase JWT passed from the frontend.
-   Zero data inconsistencies reported related to real-time updates vs. API fetches.
-   Complete removal of Firebase SDK and example routes/components confirmed via code review and dependency analysis.

## 3. Frontend architecture

The frontend is built using:

-   **Framework:** React (with Vite, entry point `frontend/src/client.tsx`)
-   **Routing:** TanStack Router (setup in `frontend/src/router.tsx`, routes defined under `frontend/src/routes/`)
-   **UI Components:** shadcn/ui (`frontend/src/components/ui/*`) & custom application components (e.g., `frontend/src/components/video/*`, `frontend/src/components/shared/*`)
-   **Authentication:** Supabase client library (`@supabase/supabase-js`) via `db/supabase/clients/client.ts` for Google OAuth flow and session management.
-   **API Communication:** Custom API client wrapper (likely evolving `frontend/src/api.ts`) sending the Supabase JWT to the backend FastAPI API.
-   **Database Interaction (Client-side):** Minimal. Primarily interacts with the backend API. Direct Supabase client interaction via `db/supabase/clients/client.ts` likely limited to auth state.
-   **File Storage:** Interaction with GCS via signed URLs obtained from the backend API for uploads.
-   **Real-time:** Native WebSocket API or lightweight library (e.g., `useWebSocket`) connecting to the backend FastAPI WebSocket endpoint, likely managed via a custom hook (e.g., `frontend/src/hooks/useAppWebSocket.ts` - TBC).
-   **State Management:** TanStack Query for server state caching/synchronization (backend API data), Zustand or Jotai for local UI state (e.g., holding temporary thumbnail URLs during editing).

## 4. Key features & requirements

### 4.1 Core user interface & functionality

**REQ-FE-001: User Authentication via Supabase**
-   **Priority:** High - Foundational for application access.
-   Adapt existing login UI (`frontend/src/routes/login.tsx`, `frontend/src/components/login.tsx`) to provide a "Login with Google" button.
-   Initiate the Supabase Google OAuth flow using the Supabase client configured in `db/supabase/clients/client.ts`.
-   Handle the OAuth callback and manage the Supabase session.
-   Obtain the Supabase JWT upon successful login.
-   Implement logic (likely within API client `frontend/src/api.ts`) to attach the Supabase JWT to authenticated requests made to the backend FastAPI API.
-   Implement logout functionality (e.g., in `frontend/src/routes/logout.tsx` or navbar component `frontend/src/components/shared/navbar.tsx`) using `supabase.auth.signOut()`, clearing local session state and redirecting.
-   Protect routes requiring authentication using TanStack Router features (potentially adapting logic from `frontend/src/routes/_authed.tsx`), checking for an active Supabase session.
-   Handle Supabase session changes globally (e.g., in `frontend/src/routes/__root.tsx` or a dedicated context) using `supabase.auth.onAuthStateChange`.

**REQ-FE-002: Video Upload Interface (Direct GCS)**
-   Provide a mechanism (e.g., adapting `frontend/src/components/ui/dropzone.tsx`) within an authenticated view (e.g., `frontend/src/routes/dashboard.tsx` or a dedicated upload route) for users to select video files.
-   Implement client-side validation.
-   Request a GCS signed upload URL from the backend API.
-   Perform a PUT request directly to the GCS signed URL, displaying upload progress (e.g., using `frontend/src/components/ui/progress.tsx`).
-   Upon successful GCS upload, notify the backend API to initiate processing.
-   Display success/error messages (e.g., using `frontend/src/components/ui/use-toast.ts`).

**REQ-FE-003: Processing Dashboard**
-   Refactor the existing dashboard route (`frontend/src/routes/dashboard.tsx`) and potentially the component (`frontend/src/components/video/processing-dashboard.tsx`).
-   Fetch and display a list/grid of the authenticated user's video processing jobs via the backend API.
-   Use card components (e.g., `frontend/src/components/video/video-progress-card.tsx`) to show key information: thumbnail, title, status, timestamp.
-   Establish a WebSocket connection upon dashboard load.
-   Update job statuses and potentially thumbnails/titles in real-time via WebSocket messages, synchronizing with TanStack Query cache.
-   Handle loading (`frontend/src/components/ui/skeleton.tsx`?) and empty states.
-   Allow navigation to detail view (`frontend/src/routes/video.$videoId.tsx`).
-   Implement pagination (`frontend/src/components/ui/pagination.tsx`?) or infinite scrolling.

**REQ-FE-004: Video Detail View**
-   Refactor the existing video detail route (`frontend/src/routes/video.$videoId.tsx`) and component (`frontend/src/components/video/video-detail.tsx`).
-   Fetch detailed job information via the backend API.
-   Display video details and overall job status.
-   Display detailed processing stage statuses (potentially using `frontend/src/components/ui/progress-steps.tsx` or similar, data defined in `frontend/src/components/video/processing-steps.ts` needs backend alignment).
-   Subscribe to WebSocket updates for this `job_id`.
-   Update processing stage statuses in real-time via WebSocket messages.
-   Display generated metadata as available.
-   Display a gallery of *all* generated thumbnail URLs (see REQ-FE-005).
-   Provide navigation/links to the metadata editor section (within the same component or separate).
-   Display error messages clearly.

**REQ-FE-005: Metadata Editor & Thumbnail Selection**
-   Integrate editing capabilities within the detail view or a dedicated component (potentially adapting `frontend/src/components/video/content-editor.tsx`).
-   Provide UI sections using standard inputs (`frontend/src/components/ui/input.tsx`, `frontend/src/components/ui/textarea.tsx`, etc.) for editing title, description, tags.
-   Provide sections for viewing/copying transcript, subtitles, chapters.
-   Implement or adapt a thumbnail gallery component (`frontend/src/components/video/thumbnail-gallery.tsx`?) to display all generated thumbnails (URLs from GCS via backend). Hold these URLs in local component state during editing.
-   Allow selection of one thumbnail from the gallery.
-   Implement a "Save" button (`frontend/src/components/ui/button.tsx`).
-   On save, send edited metadata and the *selected* thumbnail GCS URL to the backend API.
-   Provide feedback on save success/error (e.g., using toasts).
-   Ensure editor reflects latest data.

**REQ-FE-006: Publishing Interface** (Optional - Depends on backend readiness)
-   Add a "Publish" button to the detail view/editor.
-   Enable button only when processing is complete and required metadata is saved.
-   Click triggers backend API call.
-   Display feedback on initiation/status.

### 4.2 Technical requirements

**REQ-FE-TECH-001: Supabase Client Integration**
-   **Priority:** High.
-   Integrate `@supabase/supabase-js` client using the setup from `db/supabase/clients/client.ts`.
-   Implement Google OAuth flow and session management.
-   Implement retrieval/handling of the Supabase JWT.
-   Remove client-side Firebase initialization (`frontend/firebase.ts`) and related utilities (`frontend/src/utils/supabase.ts` unless adapted for SSR).

**REQ-FE-TECH-002: WebSocket Client Implementation**
-   Implement a reusable service or hook (e.g., create `frontend/src/hooks/useAppWebSocket.ts`).
-   Handle connection lifecycle, message parsing, reconnection.
-   Integrate with TanStack Query cache.
-   Ensure `wss://`.

**REQ-FE-TECH-003: Complete Firebase Removal**
-   Identify and refactor all code using Firebase services.
-   Replace Firebase Auth with Supabase Auth flow (adapting `frontend/src/components/auth.tsx`, `frontend/src/routes/login.tsx`).
-   Replace Firestore interactions with backend API calls.
-   Remove Firebase SDK from `frontend/package.json` and config files.
-   Verify removal.

**REQ-FE-TECH-004: API Client Configuration**
-   Refactor `frontend/src/api.ts` or create a new wrapper.
-   Configure client to automatically include the Supabase JWT.
-   Implement robust error handling.
-   Integrate with TanStack Query.

**REQ-FE-TECH-005: State Management Strategy**
-   Utilize TanStack Query for backend API server state.
-   Use WebSocket messages to invalidate/update TanStack Query cache.
-   Employ Zustand or Jotai for local UI state (e.g., thumbnail URL list in `frontend/src/components/video/thumbnail-gallery.tsx`).

**REQ-FE-TECH-006: Responsive Design**
-   Ensure UI adapts gracefully using existing structure (`frontend/src/styles/app.css`, shadcn components).
-   Test layout and usability.

**REQ-FE-TECH-007: Comprehensive Testing**
-   Unit tests (Vitest setup in `frontend/vitest.config.ts`).
-   Integration tests (mocking backend/Supabase).
-   End-to-end tests covering core flows.

**REQ-FE-TECH-008: Cleanup Unused Routes/Components**
-   Identify and remove unused routes (`frontend/src/routes/posts.*`, `frontend/src/routes/users.*`, etc.) and associated components/utils (`frontend/src/utils/posts.tsx`, etc.). Move necessary examples to `docs/docs-frontend/examples`.

## 5. User stories (frontend focus)

*(Mostly unchanged from previous draft, but context implies use of existing/adapted components)*

**US-FE-001: User Authentication with Google via Supabase**
-   As a user, I want to log in securely using my Google account via Supabase, so that I can access the video processing application.
-   *Acceptance Criteria:* ... (Uses adapted `login.tsx`) ...

**US-FE-002: Video Upload Initiation (Direct GCS)**
-   As a content creator, I want a simple interface (like the `dropzone.tsx` component) to select my video file and upload it directly to GCS...
-   *Acceptance Criteria:* ...

**US-FE-003: Real-time Dashboard Monitoring**
-   As a content creator, I want my dashboard (`dashboard.tsx`) to show my videos (`video-progress-card.tsx`) and their current processing status, updating automatically via WebSockets.
-   *Acceptance Criteria:* ...

**US-FE-004: Real-time Detail View Monitoring & Thumbnail Gallery**
-   As a content creator viewing a specific video's details (`video-detail.tsx`), I want to see individual processing steps update their status in real-time, and view all generated thumbnails in a gallery (`thumbnail-gallery.tsx`).
-   *Acceptance Criteria:* ...

**US-FE-005: Metadata Review Interface**
-   As a content creator, I want a clear interface (within `video-detail.tsx` or `content-editor.tsx`) to review all AI-generated metadata...
-   *Acceptance Criteria:* ...

**US-FE-006: Metadata Editing and Thumbnail Selection/Saving**
-   As a content creator, I want to edit generated metadata, select my preferred thumbnail from the gallery, and save these choices via the backend API.
-   *Acceptance Criteria:* ... (Uses `input.tsx`, gallery component, `button.tsx`) ...

**US-FE-007: Publishing Trigger**
-   As a content creator, I want a button (`button.tsx`) to initiate publishing... via the backend API...
-   *Acceptance Criteria:* ...

## 6. Backend dependencies / assumptions

*(Unchanged from previous draft)*

-   **Authentication:** Backend API endpoints requiring authentication can verify a Supabase JWT sent by the frontend.
-   **Signed URLs:** A backend API endpoint (e.g., `POST /api/videos/upload-url`) exists to provide GCS signed URLs for video uploads.
-   **Job Initiation:** A backend API endpoint (e.g., `POST /api/videos`) exists to notify the backend after a GCS upload is complete, triggering the processing pipeline.
-   **Data Fetching:** Backend API endpoints (e.g., `GET /api/videos`, `GET /api/videos/{job_id}`) exist to provide job lists and detailed job information, including status, generated metadata, and GCS URLs for *all* generated thumbnails.
-   **Metadata Update:** A backend API endpoint (e.g., `PUT /api/videos/{job_id}/metadata`) exists to receive and persist edited metadata, including the *selected* thumbnail GCS URL.
-   **Publishing:** (Optional) A backend API endpoint (e.g., `POST /api/videos/{job_id}/publish`) exists to trigger the publishing workflow.
-   **WebSockets:** A backend WebSocket endpoint exists, capable of broadcasting or sending targeted updates regarding job status, stage progress, and newly generated metadata/thumbnail URLs.
-   **Database Schema:** The Supabase database schema (managed by backend/DB team) supports storing user information, job details (including status, stages), GCS URL references for the original video and the *selected* thumbnail, and potentially other generated metadata.
-   **GCS Storage:** A GCS bucket is configured for video uploads and thumbnail storage. Generated thumbnails (selected and unselected) persist in GCS for retrieval during the editing phase.

## 7. Migration plan (frontend focus)

**Priority:** Focus initially on setting up Supabase client and authentication (REQ-FE-001, REQ-FE-TECH-001) before tackling other features.

1.  **Setup Supabase Client & Auth:** Implement client using `db/supabase/clients/client.ts`. Setup Google OAuth, session management (`onAuthStateChange` in `__root.tsx`?), route protection (`_authed.tsx` adaptation?), logout. Adapt `frontend/src/api.ts` to send JWT.
2.  **Refactor Auth Screens:** Adapt `frontend/src/routes/login.tsx` / `frontend/src/components/login.tsx`.
3.  **Implement Upload Flow:** Adapt `frontend/src/components/ui/dropzone.tsx` for GCS Signed URL flow (REQ-FE-002).
4.  **Implement WebSocket Client:** Create `frontend/src/hooks/useAppWebSocket.ts` (REQ-FE-TECH-002).
5.  **Refactor Core Data Fetching:** Replace Firestore reads in `frontend/src/routes/dashboard.tsx`, `frontend/src/routes/video.$videoId.tsx` with TanStack Query hooks hitting backend API endpoints.
6.  **Integrate Real-time Updates:** Connect WebSocket updates to TanStack Query cache in dashboard/detail components.
7.  **Implement Detail View & Editor:** Refactor `frontend/src/components/video/video-detail.tsx`, `frontend/src/components/video/content-editor.tsx`. Implement/Adapt `frontend/src/components/video/thumbnail-gallery.tsx` (REQ-FE-004 & REQ-FE-005).
8.  **Update Data Mutations:** Implement metadata saving via backend API (REQ-FE-005).
9.  **Testing:** Implement comprehensive tests (REQ-FE-TECH-007).
10. **Cleanup:** Remove Firebase (`frontend/firebase.ts`, deps), unused examples (`frontend/src/routes/posts.*`, `users.*`, utils, etc.) (REQ-FE-TECH-003, REQ-FE-TECH-008).

## 8. Risks and mitigations (frontend)

*(Unchanged from previous draft)*

**Risk: Backend API Authentication Strategy Implementation**
-   *Impact:* Frontend unable to securely call backend API.
-   *Mitigation:* Close collaboration with backend team to ensure Supabase JWT verification is correctly implemented on the backend. Thorough integration testing.

**Risk: GCS Signed URL Generation/Handling**
-   *Impact:* Uploads fail due to incorrect URL generation, permissions, or expiry.
-   *Mitigation:* Backend provides correctly configured URLs. Frontend handles potential errors during the PUT request to GCS.

**Risk: WebSocket Connection Instability**
-   *Mitigation:* Robust client reconnection logic; monitor backend WebSocket stability.

**Risk: State Synchronization Complexity (API/WebSockets/Local)**
-   *Impact:* Inconsistent UI state, especially with temporary thumbnail URLs.
-   *Mitigation:* Clear separation of server state (TanStack Query) and local UI state (Zustand/Jotai). Careful management of thumbnail URL list during editing session. Thorough testing.

**Risk: Backend API / WebSocket Contract Changes**
-   *Impact:* Frontend breaks.
-   *Mitigation:* Clear contracts; OpenAPI/Swagger; define WebSocket message schema; integration tests.

**Risk: Supabase Rate Limiting/Quotas**
-   *Impact:* Authentication failures.
-   *Mitigation:* Monitor Supabase usage; handle potential rate limit errors.

**Risk: Google OAuth Configuration Issues**
-   *Impact:* Users cannot log in.
-   *Mitigation:* Double-check configurations; test thoroughly.

================
File: web-memory-bank/product-context.md
================
# Product Context

## Purpose
The Video Processing Pipeline frontend serves as the user interface for content creators who need to efficiently process and publish video content. It streamlines what would otherwise be a complex, multi-step workflow involving multiple tools and manual interventions.

## Problems Solved

1. **Complexity Reduction**: Content creators typically need multiple specialized tools to prepare videos for publishing (transcription, metadata generation, thumbnail creation). Our application centralizes this into a single workflow.

2. **Time Efficiency**: Manual metadata creation, thumbnail selection, and video optimization are time-consuming. The AI-powered automation saves creators significant preparation time.

3. **Consistency**: By using AI to suggest metadata based on video content, creators achieve more consistent and contextually relevant descriptions, titles, and tags.

4. **Real-time Visibility**: The application provides immediate feedback on processing status, eliminating uncertainty about when assets will be ready.

5. **Quality Control**: The interface allows creators to review and refine AI-generated content before publishing, maintaining creative control while benefiting from automation.

## User Experience Goals

1. **Intuitive Flow**: The interface should guide users naturally through the upload → process → review → publish workflow.

2. **Responsive Feedback**: Users should receive immediate visual feedback about processing status and generated assets.

3. **Minimal Friction**: Authentication, uploads, and editing should require minimal steps with clear guidance.

4. **Creative Control**: While leveraging AI automation, the interface should emphasize user agency in final decisions.

5. **Confidence**: Users should feel confident that their content is being processed correctly and securely.

## Target Users

1. **Content Creators**: Individuals or teams producing video content for online platforms.

2. **Marketing Teams**: Organizations creating video assets for promotional purposes.

3. **Educational Content Developers**: Instructors or institutions developing video-based learning materials.

4. **Social Media Managers**: Professionals managing video content across multiple platforms.

## Key User Journeys

1. **New Video Processing**: Upload → Monitor processing → Review metadata → Select thumbnail → Publish.

2. **Processing Status Check**: Log in → View dashboard of in-progress and completed videos → Check detailed status.

3. **Metadata Refinement**: Log in → Select processed video → Edit AI-generated metadata → Save changes.

4. **Publishing Management**: Review completed videos → Trigger publishing → Verify successful distribution.

================
File: web-memory-bank/progress.md
================
# Progress Tracking

## Current Status

The frontend application is in a transitional state, migrating from Firebase to Supabase authentication and implementing FastAPI WebSocket integration for real-time updates. Here's a breakdown of current status:

### What Works

- Basic application structure with React, TypeScript, and Vite
- TanStack Router setup with route configuration
- shadcn/ui components integrated for UI elements
- Firebase authentication (to be replaced)
- Basic video upload functionality (to be adapted for GCS)
- Dashboard view with video processing cards
- Video detail view (to be enhanced)

### What's In Progress

- Migration plan from Firebase to Supabase authentication
- WebSocket-based real-time updates design
- Removal of unused example code
- Definition of WebSocket message formats
- Error handling standardization
- API client refactoring for JWT integration

### What's Left to Build

1. **Authentication Implementation**
   - [ ] Google OAuth with Supabase
   - [ ] Protected route layout
   - [ ] Global session management
   - [ ] JWT handling in API client

2. **WebSocket Integration**
   - [ ] Custom WebSocket hook
   - [ ] Connection management
   - [ ] Message parsing
   - [ ] TanStack Query integration

3. **Dashboard Refactoring**
   - [ ] API-based data fetching
   - [ ] WebSocket update handling
   - [ ] Loading and error states
   - [ ] Pagination or infinite scrolling

4. **Video Detail View**
   - [ ] API-based data fetching
   - [ ] WebSocket update handling
   - [ ] Enhanced metadata display
   - [ ] Error states

5. **Thumbnail Gallery**
   - [ ] Gallery component for thumbnail display
   - [ ] Selection mechanism
   - [ ] Integration with metadata editor

6. **Metadata Editor**
   - [ ] Form inputs for editable fields
   - [ ] Save functionality
   - [ ] Validation
   - [ ] Success/error feedback

7. **Publishing Flow**
   - [ ] Publish button implementation
   - [ ] Status tracking
   - [ ] Success/error handling

8. **Cleanup & Optimization**
   - [ ] Firebase removal
   - [ ] Unused code elimination
   - [ ] Performance optimization
   - [ ] Responsive design verification

## Known Issues

1. **Firebase Dependency**: Current authentication relies on Firebase, which needs to be completely replaced.

2. **Example Code**: Unused example routes and components create confusion and bloat.

3. **Real-time Updates**: Firebase listeners need to be replaced with WebSocket integration.

4. **Upload Flow**: Current upload mechanism needs adaptation for direct-to-GCS uploads.

5. **Error Handling**: Inconsistent error handling across components.

6. **State Management**: Mix of approaches to state management needs consolidation.

## Evolution of Project Decisions

### Authentication Strategy
- **Initial**: Firebase Authentication for simplicity and quick start
- **Current**: Planning migration to Supabase for better integration with backend
- **Reasoning**: Aligns with backend authentication strategy, reduces dependencies

### Real-time Updates
- **Initial**: Firebase Firestore listeners for real-time updates
- **Current**: Designing WebSocket-based solution
- **Reasoning**: Direct connection to backend, more control over message format, reduced dependency on third-party services

### State Management
- **Initial**: Mix of local state and Firebase listeners
- **Current**: Planning TanStack Query with WebSocket integration
- **Reasoning**: More structured approach to server state, better caching and synchronization

### File Uploads
- **Initial**: Direct uploads to Firebase Storage
- **Current**: Planning direct uploads to GCS via signed URLs
- **Reasoning**: Better alignment with backend storage strategy, more control over upload process

### Component Structure
- **Initial**: Minimal separation of concerns
- **Current**: Clearer separation between routes, feature components, and UI components
- **Reasoning**: Better maintainability, reusability, and clear responsibilities

## Next Milestone Goals

### Milestone 1: Authentication Migration
- Implement Supabase Google OAuth
- Create protected route layout
- Remove Firebase auth dependencies
- Ensure session persistence and JWT handling

### Milestone 2: WebSocket Integration
- Implement WebSocket hook
- Handle connection lifecycle
- Parse messages and update UI state
- Integrate with TanStack Query

### Milestone 3: Core UI Refactoring
- Refactor dashboard view
- Enhance video detail view
- Implement thumbnail gallery
- Create metadata editor

### Milestone 4: Cleanup & Optimization
- Remove all Firebase dependencies
- Eliminate unused example code
- Verify responsive design
- Performance optimization

================
File: web-memory-bank/project-brief.md
================
# Video Processing Pipeline - Frontend Project Brief

## Project Overview
The Video Processing Pipeline frontend provides content creators with an intuitive interface to upload videos, monitor AI-powered processing in real-time, review and edit generated metadata, and publish content to platforms like YouTube.

## Core Requirements

1. **Authentication**: Implement Supabase Google OAuth for user authentication, replacing Firebase.
2. **Video Upload**: Direct uploads to Google Cloud Storage via signed URLs from backend.
3. **Real-time Monitoring**: Display processing status and updates via FastAPI WebSockets.
4. **Metadata Management**: Allow users to review, edit, and save AI-generated metadata.
5. **Thumbnail Selection**: View gallery of AI-generated thumbnails and select preferred option.
6. **Publishing Control**: Trigger publishing process to distribution platforms.

## Key Deliverables

1. Complete migration from Firebase to Supabase for authentication
2. Implementation of WebSocket client for real-time updates
3. Refactored dashboard and video detail views
4. Enhanced metadata editor with thumbnail gallery
5. Responsive design for all core features
6. Removal of unused example code and Firebase dependencies

## Technical Constraints

- Must integrate with existing Supabase client setup in `db/supabase/clients/`
- Must communicate with FastAPI backend via authenticated API requests
- Must handle WebSocket connections for real-time updates
- Must support direct uploads to GCS via signed URLs

## Success Criteria

- Successful authentication via Supabase
- Real-time updates appearing within 1 second of backend events
- Complete Firebase removal
- Successful uploads, metadata editing, and publishing functionality
- High user satisfaction with interface usability (4.5/5 target)

================
File: web-memory-bank/system-patterns.md
================
# System Patterns

## Architecture Overview

The frontend application follows a modern React single-page application architecture with a focus on real-time updates and state management.

```
┌─────────────────────────────────────┐
│            React Frontend           │
├─────────────┬───────────┬───────────┤
│  TanStack   │  shadcn/  │  Custom   │
│   Router    │    UI     │Components │
├─────────────┴───────────┴───────────┤
│       State Management Layer        │
│  (TanStack Query + Local State)     │
├─────────────┬───────────┬───────────┤
│  API Client │ WebSocket │ Supabase  │
│   (HTTP)    │  Client   │  Auth     │
├─────────────┴───────────┴───────────┤
│         External Services           │
│  FastAPI Backend  │  GCS Storage    │
└─────────────────────────────────────┘
```

## Key Technical Decisions

1. **Authentication**: Supabase Google OAuth integration replaces Firebase for both simplicity and alignment with the backend authentication strategy.

2. **Real-time Updates**: FastAPI WebSockets provide real-time processing updates, replacing Firebase listeners. This creates a direct connection to our own backend.

3. **State Management**: TanStack Query handles server state and caching, with WebSocket updates triggering cache invalidation or updates. Local component state handles UI-specific state.

4. **Uploads**: Direct-to-GCS uploads via signed URLs reduce backend load and improve scalability for large video files.

5. **Component Structure**: Modular component design with separation between UI components (shadcn/ui), feature components, and route components.

## Component Relationships

- **Routes (`/routes`)**: Route components handle data fetching, URL parameters, and compose feature components.
  
- **Feature Components (`/components/video`, etc.)**: Implement specific application features combining UI components and business logic.
  
- **UI Components (`/components/ui`)**: Reusable, presentational components from shadcn/ui providing consistent styling.

- **Shared Components (`/components/shared`)**: Cross-cutting components like navbar, containers used across multiple routes.

- **Hooks (`/hooks`)**: Custom React hooks encapsulating reusable logic, such as WebSocket connection management.

## Critical Implementation Paths

1. **Authentication Flow**:
   ```
   Login Page → Supabase OAuth → JWT Token → Protected Routes
   ```

2. **Video Upload Flow**:
   ```
   Dropzone → API request for signed URL → Direct GCS upload → 
   API notification → WebSocket status updates
   ```

3. **Real-time Updates Flow**:
   ```
   WebSocket connection → Message parsing → TanStack Query cache update → 
   Component re-render
   ```

4. **Metadata Editing Flow**:
   ```
   Fetch metadata → Display in editor → User edits → 
   Save via API → Update local state
   ```

## Current File Structure

The frontend application is currently undergoing migration from Firebase to Supabase and cleanup of example code. The proposed file structure after refactoring:

```
frontend
├── app.config.ts
├── biome.json
├── components.json
├── Dockerfile
├── docs                          
│   └── examples                  # Archived example files
├── package.json                  # Firebase removed from deps
├── public
│   ├── fonts
│   └── vite.svg
├── src
│   ├── api.ts                    # Refactored for JWT handling
│   ├── client.tsx                # Application entry point
│   ├── components
│   │   ├── auth                  # Supabase auth components
│   │   │   └── GoogleLoginButton.tsx
│   │   ├── shared
│   │   │   ├── container.tsx
│   │   │   └── navbar.tsx        # With Supabase logout
│   │   ├── ui                    # shadcn/ui components
│   │   └── video                 # Core video components
│   │       ├── content-editor.tsx
│   │       ├── processing-dashboard.tsx 
│   │       ├── thumbnail-gallery.tsx
│   │       ├── video-detail.tsx    
│   │       └── video-progress-card.tsx
│   ├── hooks
│   │   ├── use-app-websocket.ts  # WebSocket connection management
│   │   └── use-mobile.ts
│   ├── lib
│   │   └── utils.ts
│   ├── router.tsx                # TanStack Router setup
│   ├── routes
│   │   ├── __root.tsx            # With Supabase auth listener
│   │   ├── _authenticated.tsx    # Auth guard
│   │   ├── dashboard.tsx         # Video listing
│   │   ├── index.tsx             # Home page
│   │   ├── login.tsx             # OAuth trigger
│   │   └── video.$videoId.tsx    # Video details
│   ├── routeTree.gen.ts          # Auto-generated
│   ├── styles
│   │   └── app.css
│   └── utils
│       └── seo.ts
└── tsconfig.json
```

================
File: web-memory-bank/tasks.md
================
# FRONTEND - PRODUCT REQUIREMENTS DOCUMENT (PRD) - V3

## 1. Overview

This Product Requirements Document (PRD) outlines the specifications for the frontend application of the Video Processing Pipeline system. The frontend provides users (primarily Content Creators) with an interface to authenticate using Google via Supabase, upload videos directly to Google Cloud Storage (GCS), monitor processing progress in real-time via FastAPI WebSockets, review and edit AI-generated metadata (including selecting a final thumbnail from multiple generated options), and manage the video publishing workflow. This document focuses on the core requirements for migrating the frontend to integrate seamlessly with the backend FastAPI API and Supabase (for authentication and non-file metadata persistence), removing legacy Firebase dependencies (e.g., `frontend/firebase.ts`) and unused example code (e.g., various files under `frontend/src/routes/posts*`, `frontend/src/routes/users*`).

## 2. Project goals

### 2.1 Primary goals

-   Provide an intuitive user interface, evolving from existing components (e.g., `frontend/src/components/video/*`, `frontend/src/components/shared/*`) for interacting with the video processing pipeline, authenticated via Supabase Google OAuth.
-   Integrate seamlessly with Supabase for user authentication and session management, utilizing the existing client setup in `db/supabase/clients/client.ts` for browser contexts and `db/supabase/clients/server.ts` for server-side operations.
-   Implement video uploads directly to GCS using signed URLs from the backend, adapting existing upload UI components like `frontend/src/components/ui/dropzone.tsx`.
-   Display real-time updates on video processing status and generated metadata using FastAPI WebSockets, updating components like `frontend/src/components/video/processing-dashboard.tsx` and `frontend/src/components/video/video-detail.tsx`.
-   Allow users to review and edit generated video metadata (fetching/saving via backend API), including selecting a final thumbnail from a gallery (e.g., a new or adapted `frontend/src/components/video/thumbnail-gallery.tsx`), using editor components like `frontend/src/components/video/content-editor.tsx`.
-   Ensure secure communication between the frontend, Supabase (auth), GCS (uploads), and the backend FastAPI API (metadata, job control, signed URLs, WebSocket).
-   Completely remove all Firebase dependencies and listeners (from `frontend/package.json`, `frontend/firebase.ts`, etc.).
-   Remove unused example routes and components related to 'posts' and 'users', moving essential examples to `docs/frontend/examples/`.
-   Maintain a responsive and modern user experience using React (via `frontend/src/client.tsx`), TanStack Router (configured in `frontend/src/router.tsx`), and shadcn/ui components (from `frontend/src/components/ui/*`).

### 2.2 Success metrics

-   Successful user authentication via Supabase Google OAuth flow.
-   Successful video uploads to GCS via signed URLs.
-   Real-time status updates appear within 1 second of backend events via WebSockets.
-   API interactions (metadata fetch/update, signed URL request) complete within 500ms (p95) after authentication, measured using API client (`frontend/src/api.ts` or replacement).
-   User satisfaction score of 4.5/5 or higher for interface usability, authentication, upload, and real-time feedback.
-   Successful implementation and stability of FastAPI WebSocket connection and message handling.
-   Backend API endpoints are correctly protected and accessible using the Supabase JWT passed from the frontend.
-   Zero data inconsistencies reported related to real-time updates vs. API fetches.
-   Complete removal of Firebase SDK and example routes/components confirmed via code review and dependency analysis.

## 3. Frontend architecture

The frontend is built using:

-   **Framework:** React (with Vite, entry point `frontend/src/client.tsx`)
-   **Routing:** TanStack Router (setup in `frontend/src/router.tsx`, routes defined under `frontend/src/routes/`)
-   **UI Components:** shadcn/ui (`frontend/src/components/ui/*`) & custom application components (e.g., `frontend/src/components/video/*`, `frontend/src/components/shared/*`)
-   **Authentication:** Supabase client library (`@supabase/supabase-js`) via `db/supabase/clients/client.ts` for Google OAuth flow and session management in browser contexts, and `db/supabase/clients/server.ts` for server-side operations.
-   **API Communication:** Custom API client wrapper (likely evolving `frontend/src/api.ts`) sending the Supabase JWT to the backend FastAPI API.
-   **Database Interaction (Client-side):** Minimal. Primarily interacts with the backend API. Direct Supabase client interaction via `db/supabase/clients/client.ts` limited to auth state.
-   **File Storage:** Interaction with GCS via signed URLs obtained from the backend API for uploads.
-   **Real-time:** Native WebSocket API connecting to the backend FastAPI WebSocket endpoint, managed via a custom hook (`frontend/src/hooks/use-app-websocket.ts`).
-   **State Management:** TanStack Query for server state caching/synchronization (backend API data) and local component state for UI elements like temporary thumbnail selection.

## 4. Key features & requirements

### 4.1 Core user interface & functionality

**REQ-FE-001: User Authentication via Supabase**
-   **Priority:** High - Foundational for application access.
-   Adapt existing login UI to provide a "Login with Google" button by creating a dedicated component (`frontend/src/components/auth/GoogleLoginButton.tsx`).
-   Initiate the Supabase Google OAuth flow using the Supabase client configured in `db/supabase/clients/client.ts`.
-   Handle the OAuth callback and manage the Supabase session.
-   Obtain the Supabase JWT upon successful login.
-   Implement logic (within API client `frontend/src/api.ts`) to attach the Supabase JWT to authenticated requests made to the backend FastAPI API.
-   Implement logout functionality (in navbar component `frontend/src/components/shared/navbar.tsx`) using `supabase.auth.signOut()`, clearing local session state and redirecting.
-   Protect routes requiring authentication using TanStack Router features by creating a dedicated layout component (`frontend/src/routes/_authenticated.tsx`), checking for an active Supabase session.
-   Handle Supabase session changes globally (in `frontend/src/routes/__root.tsx`) using `supabase.auth.onAuthStateChange`.

**REQ-FE-002: Video Upload Interface (Direct GCS)**
-   Adapt `frontend/src/components/ui/dropzone.tsx` within an authenticated view (e.g., `frontend/src/routes/dashboard.tsx`) for users to select video files.
-   Implement client-side validation for file type and size.
-   Request a GCS signed upload URL from the backend API.
-   Perform a PUT request directly to the GCS signed URL, displaying upload progress using `frontend/src/components/ui/progress.tsx`.
-   Upon successful GCS upload, notify the backend API to initiate processing.
-   Implement standardized error handling for upload failures.
-   Display success/error messages using `frontend/src/components/ui/use-toast.ts`.

**REQ-FE-003: Processing Dashboard**
-   Refactor the existing dashboard route (`frontend/src/routes/dashboard.tsx`) and the component (`frontend/src/components/video/processing-dashboard.tsx`).
-   Fetch and display a list/grid of the authenticated user's video processing jobs via the backend API using TanStack Query.
-   Use card components (`frontend/src/components/video/video-progress-card.tsx`) to show key information: thumbnail, title, status, timestamp.
-   Establish a WebSocket connection upon dashboard load via the `use-app-websocket.ts` hook.
-   Update job statuses and potentially thumbnails/titles in real-time via WebSocket messages, synchronizing with TanStack Query cache through cache updates or invalidation.
-   Handle loading states with `frontend/src/components/ui/skeleton.tsx` and empty states.
-   Allow navigation to detail view (`frontend/src/routes/video.$videoId.tsx`).
-   Implement pagination (`frontend/src/components/ui/pagination.tsx`) for large job lists.

**REQ-FE-004: Video Detail View**
-   Refactor the existing video detail route (`frontend/src/routes/video.$videoId.tsx`) and component (`frontend/src/components/video/video-detail.tsx`).
-   Fetch detailed job information via the backend API using TanStack Query.
-   Display video details and overall job status.
-   Display detailed processing stage statuses using appropriate UI components, aligning with backend processing stages.
-   Subscribe to WebSocket updates for this `job_id` using the `use-app-websocket.ts` hook.
-   Process incoming WebSocket messages and update the TanStack Query cache accordingly.
-   Display generated metadata as available.
-   Display a gallery of *all* generated thumbnail URLs.
-   Provide navigation/links to the metadata editor section (within the same component or separate).
-   Display error messages clearly with standardized error handling.

**REQ-FE-005: Metadata Editor & Thumbnail Selection**
-   Integrate editing capabilities within the detail view by adapting `frontend/src/components/video/content-editor.tsx`.
-   Provide UI sections using standard inputs (`frontend/src/components/ui/input.tsx`, `frontend/src/components/ui/textarea.tsx`, etc.) for editing title, description, tags.
-   Provide sections for viewing/copying transcript, subtitles, chapters.
-   Implement or adapt a thumbnail gallery component (`frontend/src/components/video/thumbnail-gallery.tsx`) to display all generated thumbnails (URLs from GCS via backend). Hold these URLs in local component state during editing.
-   Allow selection of one thumbnail from the gallery with clear visual indication of selection.
-   Implement a "Save" button using `frontend/src/components/ui/button.tsx`.
-   On save, send edited metadata and the *selected* thumbnail GCS URL to the backend API.
-   Provide feedback on save success/error using toast notifications.
-   Ensure editor reflects latest data after saving.

**REQ-FE-006: Publishing Interface** (Optional - Depends on backend readiness)
-   Add a "Publish" button to the detail view/editor.
-   Enable button only when processing is complete and required metadata is saved.
-   Click triggers backend API call.
-   Display feedback on initiation/status.
-   Handle potential publishing errors with standardized error messages.

### 4.2 Technical requirements

**REQ-FE-TECH-001: Supabase Client Integration**
-   **Priority:** High.
-   Use existing Supabase client configuration from `db/supabase/clients/client.ts` for browser contexts and `db/supabase/clients/server.ts` for server-side operations.
-   Implement Google OAuth flow and session management.
-   Implement retrieval/handling of the Supabase JWT.
-   Remove client-side Firebase initialization (`frontend/firebase.ts`) and related utilities.

**REQ-FE-TECH-002: WebSocket Client Implementation**
-   Implement a reusable hook `frontend/src/hooks/use-app-websocket.ts`.
-   Handle connection lifecycle (connection, disconnection, reconnection with exponential backoff).
-   Implement message parsing with appropriate typing.
-   Integrate with TanStack Query cache through direct cache updates or invalidation.
-   Ensure secure WebSocket connections (`wss://`).
-   Define message handling patterns for different update types (job updates, metadata updates, thumbnail generation).

**REQ-FE-TECH-003: Complete Firebase Removal**
-   Identify and refactor all code using Firebase services.
-   Replace Firebase Auth with Supabase Auth flow (adapting authentication components).
-   Replace Firestore interactions with backend API calls.
-   Remove Firebase SDK from `frontend/package.json` and config files.
-   Verify removal through dependency analysis.

**REQ-FE-TECH-004: API Client Configuration**
-   Refactor `frontend/src/api.ts` to create a reusable client wrapper.
-   Configure client to automatically include the Supabase JWT in all backend API requests.
-   Implement standardized error handling with appropriate error types.
-   Integrate with TanStack Query for data fetching and caching.

**REQ-FE-TECH-005: State Management Strategy**
-   Utilize TanStack Query for all backend API server state.
-   Use WebSocket messages to trigger cache updates or invalidation for real-time data changes.
-   Use local React component state for UI-specific state (e.g., form inputs, selected thumbnail).
-   Establish clear patterns for when to use each approach.

**REQ-FE-TECH-006: Responsive Design**
-   Ensure UI adapts gracefully using existing structure (`frontend/src/styles/app.css`, shadcn components).
-   Test layout and usability on desktop, tablet, and mobile viewports.
-   Focus on usability of critical features (upload, dashboard, editing) on mobile.

**REQ-FE-TECH-007: Testing**
-   Implement basic unit tests for critical utility functions and hooks.
-   Create integration tests for key components mocking backend/Supabase interactions.
-   Write end-to-end tests for core user flows: authentication, upload, editing metadata.
-   Utilize Vitest setup in `frontend/vitest.config.ts` for test implementation.

**REQ-FE-TECH-008: Cleanup Unused Routes/Components**
-   Identify and remove unused routes (`frontend/src/routes/posts.*`, `frontend/src/routes/users.*`, etc.) and associated components/utils.
-   Move necessary examples to `docs/frontend/examples/` for reference.
-   Update route configuration in `frontend/src/router.tsx`.
-   Regenerate route definitions using TanStack Router's generator.

**REQ-FE-TECH-009: Error Handling Standards**
-   Implement consistent error handling patterns across the application.
-   Define standard error types for different categories: API errors, validation errors, authentication errors.
-   Use toast notifications (`frontend/src/components/ui/use-toast.ts`) for user-facing error messages.
-   Log technical errors for debugging.
-   Implement appropriate retry logic for network operations where applicable.

**REQ-FE-TECH-010: Documentation**
-   Document key components and hooks within the frontend directory.
-   Create usage examples for reusable components.
-   Document WebSocket message formats and handling patterns.
-   Include setup instructions for development environment.
-   Maintain TypeScript types for all APIs and data structures.

## 5. User stories

**US-FE-001: User Authentication with Google via Supabase**
-   As a user, I want to log in securely using my Google account via Supabase, so that I can access the video processing application.
-   *Acceptance Criteria:*
    -   The login page displays a prominent "Login with Google" button.
    -   Clicking the button initiates the Supabase Google OAuth flow.
    -   After successful authentication, I am redirected to the dashboard page.
    -   My session persists across page reloads until I explicitly log out.
    -   I can log out by clicking a logout button in the navigation bar.
    -   After logging out, I am redirected to the login page.
    -   Attempting to access protected routes without authentication redirects me to the login page.

**US-FE-002: Video Upload Initiation (Direct GCS)**
-   As a content creator, I want to select and upload my video file directly to GCS, so that I can begin the processing workflow.
-   *Acceptance Criteria:*
    -   The dashboard provides a clear upload area with drag-and-drop functionality.
    -   I can browse and select a video file from my device.
    -   Invalid file types are rejected with clear error messages.
    -   I can see upload progress in real-time.
    -   After successful upload, I receive confirmation that processing has started.
    -   The newly uploaded video appears in my dashboard with a "processing" status.
    -   If an error occurs during upload, I receive a clear error message explaining the issue.

**US-FE-003: Real-time Dashboard Monitoring**
-   As a content creator, I want my dashboard to show my videos and their current processing status, updating automatically via WebSockets.
-   *Acceptance Criteria:*
    -   The dashboard displays a grid/list of my video processing jobs.
    -   Each video card shows a thumbnail (if available), title, status, and timestamp.
    -   Video status updates appear in real-time without page refresh.
    -   Videos in different states (processing, completed, error) are visually distinct.
    -   I can click on a video card to navigate to its detailed view.
    -   The dashboard displays an appropriate loading state while fetching initial data.
    -   The dashboard shows an appropriate empty state when I have no videos.
    -   The dashboard handles WebSocket connection issues gracefully without disrupting the UI.

**US-FE-004: Real-time Detail View Monitoring & Thumbnail Gallery**
-   As a content creator viewing a specific video's details, I want to see individual processing steps update their status in real-time, and view all generated thumbnails in a gallery.
-   *Acceptance Criteria:*
    -   The detail view shows basic video information (title, overall status, duration).
    -   Individual processing stages are displayed with their current status.
    -   Processing stage statuses update in real-time via WebSocket.
    -   As thumbnails are generated, they appear in a gallery without page refresh.
    -   The detail view handles WebSocket connection issues gracefully.
    -   Error states for failed processing are clearly indicated.
    -   Navigation back to the dashboard is easily accessible.

**US-FE-005: Metadata Review Interface**
-   As a content creator, I want to review all AI-generated metadata for my video, so that I can ensure it's accurate before publishing.
-   *Acceptance Criteria:*
    -   The detail view or a dedicated section displays all generated metadata.
    -   Metadata categories (title suggestions, description, tags, transcript, chapters) are clearly organized.
    -   Long-form content (transcript, chapters) is displayed in a readable format.
    -   I can easily navigate between different metadata sections.
    -   Metadata updates via WebSocket appear without page refresh.
    -   The interface handles incomplete or missing metadata gracefully.
    -   The interface is responsive and readable on different device sizes.

**US-FE-006: Metadata Editing and Thumbnail Selection/Saving**
-   As a content creator, I want to edit generated metadata, select my preferred thumbnail from the gallery, and save these choices via the backend API.
-   *Acceptance Criteria:*
    -   I can edit the title, description, and tags in form fields.
    -   I can view and potentially copy/download transcript and subtitles.
    -   The thumbnail gallery displays all generated thumbnail options.
    -   I can select a thumbnail with a clear visual indication of my selection.
    -   A prominent "Save" button is available to submit my changes.
    -   After saving, I receive confirmation that my changes were saved successfully.
    -   If save fails, I receive a clear error message without losing my edits.
    -   After saving, the interface reflects my saved choices.

**US-FE-007: Publishing Trigger**
-   As a content creator, I want to initiate the publishing process for my processed video, so that it can be distributed to its intended platform.
-   *Acceptance Criteria:*
    -   A "Publish" button is visible when video processing is complete and required metadata is saved.
    -   The button is disabled with explanation if prerequisites aren't met.
    -   Clicking the button triggers the publishing process via the backend API.
    -   I receive confirmation that publishing has started.
    -   The interface reflects the current publishing status.
    -   If publishing fails, I receive a clear error message with potential remediation steps.

## 6. Backend dependencies / assumptions

-   **Authentication:** Backend API endpoints requiring authentication can verify a Supabase JWT sent by the frontend.
-   **Signed URLs:** A backend API endpoint (e.g., `POST /api/videos/upload-url`) exists to provide GCS signed URLs for video uploads.
-   **Job Initiation:** A backend API endpoint (e.g., `POST /api/videos`) exists to notify the backend after a GCS upload is complete, triggering the processing pipeline.
-   **Data Fetching:** Backend API endpoints (e.g., `GET /api/videos`, `GET /api/videos/{job_id}`) exist to provide job lists and detailed job information, including status, generated metadata, and GCS URLs for *all* generated thumbnails.
-   **Metadata Update:** A backend API endpoint (e.g., `PUT /api/videos/{job_id}/metadata`) exists to receive and persist edited metadata, including the *selected* thumbnail GCS URL.
-   **Publishing:** (Optional) A backend API endpoint (e.g., `POST /api/videos/{job_id}/publish`) exists to trigger the publishing workflow.
-   **WebSockets:** A backend WebSocket endpoint exists, capable of broadcasting or sending targeted updates regarding job status, stage progress, and newly generated metadata/thumbnail URLs.
-   **Database Schema:** The Supabase database schema (managed by backend/DB team) supports storing user information, job details (including status, stages), GCS URL references for the original video and the *selected* thumbnail, and potentially other generated metadata.
-   **GCS Storage:** A GCS bucket is configured for video uploads and thumbnail storage. Generated thumbnails (selected and unselected) persist in GCS for retrieval during the editing phase.

## 7. WebSocket message format

The frontend will expect WebSocket messages from the backend in the following JSON format:

```json
{
  "type": "JOB_UPDATE" | "STAGE_UPDATE" | "METADATA_UPDATE" | "THUMBNAIL_GENERATED" | "ERROR",
  "job_id": "string",
  "data": {
    // Type-specific payload
  },
  "timestamp": "ISO-8601 string"
}
```

Specific message types will contain:

**JOB_UPDATE**
```json
{
  "type": "JOB_UPDATE",
  "job_id": "123",
  "data": {
    "status": "PROCESSING" | "COMPLETED" | "FAILED",
    "progress_percent": 75,
    "error_message": "Optional error details if status is FAILED"
  },
  "timestamp": "2023-04-15T12:34:56Z"
}
```

**STAGE_UPDATE**
```json
{
  "type": "STAGE_UPDATE",
  "job_id": "123",
  "data": {
    "stage_id": "THUMBNAIL_GENERATION",
    "status": "PENDING" | "PROCESSING" | "COMPLETED" | "FAILED",
    "progress_percent": 50,
    "error_message": "Optional error details if status is FAILED"
  },
  "timestamp": "2023-04-15T12:34:56Z"
}
```

**METADATA_UPDATE**
```json
{
  "type": "METADATA_UPDATE",
  "job_id": "123",
  "data": {
    "metadata_type": "TITLE" | "DESCRIPTION" | "TAGS" | "TRANSCRIPT" | "CHAPTERS",
    "content": "The actual metadata content"
  },
  "timestamp": "2023-04-15T12:34:56Z"
}
```

**THUMBNAIL_GENERATED**
```json
{
  "type": "THUMBNAIL_GENERATED",
  "job_id": "123",
  "data": {
    "thumbnail_url": "https://storage.googleapis.com/bucket/path/to/thumbnail.jpg",
    "thumbnail_id": "unique_id",
    "width": 1280,
    "height": 720
  },
  "timestamp": "2023-04-15T12:34:56Z"
}
```

**ERROR**
```json
{
  "type": "ERROR",
  "job_id": "123",
  "data": {
    "error_code": "PROCESSING_ERROR",
    "error_message": "Detailed error message",
    "recoverable": false
  },
  "timestamp": "2023-04-15T12:34:56Z"
}
```

## 8. Error handling standards

The frontend will implement the following error handling patterns:

**API Request Errors**
- All API requests will use the API client wrapper that includes error handling.
- Errors will be categorized as:
  - `AuthenticationError`: For 401/403 responses (invalid or expired JWT)
  - `NetworkError`: For connection issues
  - `ValidationError`: For 400 responses (invalid input)
  - `ServerError`: For 500 responses (backend failures)
  - `UnknownError`: For uncategorized errors

**User-Facing Error Messages**
- Use toast notifications for transient errors
- Display inline error messages for form validation errors
- Show error states for failed operations directly in the UI
- Use friendly, actionable error messages that suggest next steps

**Error Recovery**
- Implement automatic retry (with exponential backoff) for network errors
- Redirect to login page for authentication errors
- Preserve user input when form submission fails
- Include refresh/retry actions for failed data loading

**WebSocket Connection Errors**
- Implement reconnection with exponential backoff
- Provide visual indication of connection status
- Fall back to polling API if WebSocket connection fails repeatedly

## 9. Migration plan

**Priority:** Focus initially on setting up Supabase client and authentication (REQ-FE-001, REQ-FE-TECH-001) before tackling other features.

1.  **Setup Supabase Auth & Route Protection:** Utilize existing client from `db/supabase/clients/client.ts`. Implement OAuth flow and session management. Create protected route layout with `_authenticated.tsx`.
2.  **Refactor Auth Screens:** Create `GoogleLoginButton.tsx` component for the login page.
3.  **Configure API Client:** Update `api.ts` to automatically include Supabase JWT with requests.
4.  **Implement Upload Flow:** Adapt `dropzone.tsx` for GCS Signed URL flow.
5.  **Implement WebSocket Hook:** Create `use-app-websocket.ts` with connection management and message handling.
6.  **Refactor Dashboard:** Update dashboard to fetch data via API and handle WebSocket updates.
7.  **Refactor Detail View:** Update video detail page to fetch data via API and handle WebSocket updates.
8.  **Implement Thumbnail Gallery & Editor:** Create or adapt thumbnail gallery and metadata editor components.
9.  **Implement Save/Publish:** Add functionality to save metadata and trigger publishing.
10. **Testing:** Implement basic tests for critical functionality.
11. **Cleanup:** Remove Firebase and unused example code.

## 10. Risks and mitigations

**Risk: Backend API Authentication Strategy Implementation**
-   *Impact:* Frontend unable to securely call backend API.
-   *Mitigation:* Close collaboration with backend team to ensure Supabase JWT verification is correctly implemented on the backend. Thorough integration testing.

**Risk: GCS Signed URL Generation/Handling**
-   *Impact:* Uploads fail due to incorrect URL generation, permissions, or expiry.
-   *Mitigation:* Backend provides correctly configured URLs. Frontend handles potential errors during the PUT request to GCS. Implement clear error messages for users.

**Risk: WebSocket Connection Instability**
-   *Impact:* Real-time updates fail to reach the frontend.
-   *Mitigation:* Robust client reconnection logic with exponential backoff. Clear indication of connection status. Fallback to polling API endpoints if necessary.

**Risk: State Synchronization Complexity (API/WebSockets)**
-   *Impact:* Inconsistent UI state, especially with temporary thumbnail URLs.
-   *Mitigation:* Clear approach to TanStack Query cache updates from WebSocket messages. Thorough testing of real-time update scenarios.

**Risk: Backend API / WebSocket Contract Changes**
-   *Impact:* Frontend breaks due to unexpected message formats or endpoint changes.
-   *Mitigation:* Define clear contracts for WebSocket message formats. Implement defensive parsing of incoming messages. Regular communication with backend team.

**Risk: Supabase Rate Limiting/Quotas**
-   *Impact:* Authentication failures due to service limitations.
-   *Mitigation:* Monitor Supabase usage. Implement appropriate error handling and user feedback for rate limit situations.

**Risk: Google OAuth Configuration Issues**
-   *Impact:* Users cannot log in.
-   *Mitigation:* Double-check OAuth configurations. Provide clear troubleshooting guidance in documentation.

================
File: web-memory-bank/tech-context.md
================
# Technical Context

## Core Technologies

### Frontend Framework
- **React**: The application is built with React, providing component-based architecture and efficient rendering.
- **TypeScript**: Used throughout for type safety and better developer experience.
- **Vite**: Used as the build tool and development server for fast refresh and optimized builds.

### Routing
- **TanStack Router**: Handles application routing with file-based route definitions and type-safe route params.

### UI Components
- **shadcn/ui**: Provides a set of accessible, customizable UI components built on Radix UI.
- **Tailwind CSS**: Used for styling through shadcn/ui components and custom styling.

### Authentication
- **Supabase Auth**: Handles Google OAuth authentication, JWT management, and session persistence.
- **JWT**: Used for securing API requests to the backend.

### State Management
- **TanStack Query**: Manages server state with caching, background updates, and optimistic UI.
- **React Context**: Used where global state needs to be shared (like authentication state).
- **Local Component State**: Handles UI-specific state that doesn't need to be shared.

### API Communication
- **Fetch API**: Wrapped in a custom API client for backend communication.
- **WebSocket API**: For real-time updates during video processing.

### Storage
- **Google Cloud Storage**: For video file and thumbnail storage, accessed via signed URLs.

### Development Tooling
- **Biome**: Modern JavaScript/TypeScript toolchain for linting and formatting.
- **Vitest**: Used for unit and integration testing.
- **pnpm**: Fast, disk space efficient package manager.

## Development Setup

### Environment Setup
1. Node.js and pnpm installed locally
2. Supabase project with Google OAuth configured
3. Google Cloud Storage bucket access
4. FastAPI backend running locally or accessible via URL

### Local Development
1. Clone the repository
2. Create `.env` file with required environment variables:
   ```
   VITE_SUPABASE_URL=https://your-project.supabase.co
   VITE_SUPABASE_ANON_KEY=your-anon-key
   VITE_API_URL=http://localhost:8000
   VITE_WEBSOCKET_URL=ws://localhost:8000/ws
   ```
3. Run `pnpm install` to install dependencies
4. Run `pnpm dev` to start the development server

### Build Process
1. Run `pnpm build` to create an optimized production build
2. The built files are output to the `/dist` directory

## Technical Constraints

### Browser Support
- Modern evergreen browsers (Chrome, Firefox, Safari, Edge)
- No IE11 support required

### Performance Targets
- Initial page load under 2 seconds
- Time to interactive under 3 seconds
- Real-time updates displayed within 1 second of backend events

### API Dependencies
- Backend FastAPI endpoints for authentication, video processing, and metadata management
- Supabase project for authentication
- GCS buckets for storage

### Security Requirements
- All API requests must include valid Supabase JWT
- Direct user access to GCS must be via signed URLs only
- WebSocket connections must be secured (wss://)

## Integration Points

### Backend API Integration
- RESTful API endpoints for CRUD operations on videos and metadata
- Authentication via Supabase JWT in Authorization header
- Custom error handling and retry logic

### Supabase Integration
- Authentication flow using Supabase client from `db/supabase/clients/client.ts`
- Session management and JWT handling

### WebSocket Integration
- Connection to FastAPI WebSocket endpoint
- Handling of connection lifecycle (connect, disconnect, reconnect)
- Message parsing and integration with UI state

### GCS Integration
- Direct uploads to GCS using signed URLs
- Retrieval of video and thumbnail assets from GCS URLs

## Tool Usage Patterns

### State Management Pattern
```tsx
// Using TanStack Query for server state
const { data, isLoading, error } = useQuery({
  queryKey: ['videos'],
  queryFn: () => api.getVideos()
});

// Using local state for UI-specific state
const [selectedThumbnail, setSelectedThumbnail] = useState<string | null>(null);
```

### API Client Pattern
```tsx
// api.ts
const api = {
  async getVideos() {
    const response = await fetch('/api/videos', {
      headers: {
        'Authorization': `Bearer ${getSupabaseToken()}`
      }
    });
    if (!response.ok) throw new ApiError(response.statusText);
    return response.json();
  }
};
```

### WebSocket Pattern
```tsx
// Using custom WebSocket hook
const { messages, connectionStatus } = useAppWebSocket();

// React to new messages
useEffect(() => {
  if (messages.length > 0) {
    const latestMessage = messages[messages.length - 1];
    if (latestMessage.type === 'JOB_UPDATE') {
      // Update UI or invalidate queries
    }
  }
}, [messages]);
```

================
File: web-memory-bank/websocket-messages.md
================
# WebSocket Message Format Documentation

This document outlines the expected WebSocket message formats for communication between the frontend and the FastAPI backend. These messages are used to provide real-time updates on video processing status, metadata generation, and error conditions.

## Message Structure

All WebSocket messages follow a consistent JSON structure:

```typescript
interface BaseWebSocketMessage {
  type: string;          // Message type identifier
  job_id: string;        // Unique identifier for the video job
  data: unknown;         // Type-specific payload
  timestamp: string;     // ISO-8601 timestamp
}
```

## Message Types

### 1. JOB_UPDATE

Provides updates on the overall status of a video processing job.

```typescript
interface JobUpdateMessage extends BaseWebSocketMessage {
  type: "JOB_UPDATE";
  data: {
    status: "PENDING" | "PROCESSING" | "COMPLETED" | "FAILED";
    progress_percent: number;  // 0-100
    error_message?: string;    // Present only if status is FAILED
  };
}
```

**Usage Example:**
- Dashboard UI updates job status card
- Video detail view updates overall progress indicator
- If status is "FAILED", display error message

### 2. STAGE_UPDATE

Provides updates on a specific processing stage within a job.

```typescript
interface StageUpdateMessage extends BaseWebSocketMessage {
  type: "STAGE_UPDATE";
  data: {
    stage_id: string;    // E.g., "THUMBNAIL_GENERATION", "TRANSCRIPTION", etc.
    status: "PENDING" | "PROCESSING" | "COMPLETED" | "FAILED";
    progress_percent: number;  // 0-100
    error_message?: string;    // Present only if status is FAILED
  };
}
```

**Usage Example:**
- Video detail view updates specific stage progress
- If stage fails, display specific error for that stage

### 3. METADATA_UPDATE

Notifies when new or updated metadata is available for a video.

```typescript
interface MetadataUpdateMessage extends BaseWebSocketMessage {
  type: "METADATA_UPDATE";
  data: {
    metadata_type: "TITLE" | "DESCRIPTION" | "TAGS" | "TRANSCRIPT" | "CHAPTERS";
    content: string | string[] | object;  // Depends on metadata_type
  };
}
```

**Usage Example:**
- Video detail view updates specific metadata field
- Enable editing if processing of that metadata type is complete

### 4. THUMBNAIL_GENERATED

Notifies when a new thumbnail has been generated.

```typescript
interface ThumbnailGeneratedMessage extends BaseWebSocketMessage {
  type: "THUMBNAIL_GENERATED";
  data: {
    thumbnail_url: string;    // Full GCS URL to the thumbnail
    thumbnail_id: string;     // Unique identifier for the thumbnail
    width: number;            // Width in pixels
    height: number;           // Height in pixels
    timestamp_seconds?: number; // Optional: Video timestamp this thumbnail represents
  };
}
```

**Usage Example:**
- Thumbnail gallery adds new thumbnail to the display
- If first thumbnail, update job card with thumbnail preview

### 5. ERROR

Provides information about errors that occurred during processing.

```typescript
interface ErrorMessage extends BaseWebSocketMessage {
  type: "ERROR";
  data: {
    error_code: string;        // Machine-readable error code
    error_message: string;     // Human-readable error message
    recoverable: boolean;      // Whether the error allows processing to continue
    affected_stage?: string;   // Optional: The specific stage affected by this error
  };
}
```

**Usage Example:**
- Display error message to user
- If non-recoverable, show job as failed
- If recoverable, show warning but allow continued interaction

## WebSocket Connection Management

### Connection Lifecycle

1. **Initial Connection**:
   - Connect to `wss://[backend-url]/ws` with Supabase JWT for authentication
   - Upon successful connection, send a message to subscribe to specific job updates (if applicable)

2. **Reconnection Strategy**:
   - Implement exponential backoff for reconnection attempts
   - Start with 1 second delay, double until reaching a maximum of 30 seconds
   - Reset backoff counter after successful reconnection

3. **Heartbeat**:
   - Expect backend to send periodic heartbeat messages (every 30 seconds)
   - If no heartbeat received for 60 seconds, attempt reconnection
   - Send heartbeat responses to keep connection alive

### Subscription Message

To subscribe to updates for specific jobs:

```typescript
interface SubscriptionMessage {
  action: "subscribe";
  job_ids: string[];  // Array of job IDs to subscribe to
}
```

## Integration with TanStack Query

The WebSocket hook should integrate with TanStack Query in the following ways:

1. **Direct Cache Updates**:
   For incremental updates like new thumbnails or metadata changes, directly modify the cache:

   ```typescript
   queryClient.setQueryData(['video', jobId], (oldData) => {
     // Update only the relevant portion of the data
     return {
       ...oldData,
       thumbnails: [...oldData.thumbnails, newThumbnailData]
     };
   });
   ```

2. **Cache Invalidation**:
   For major status changes that affect multiple aspects of the data:

   ```typescript
   // For significant changes, invalidate the query to trigger a refetch
   queryClient.invalidateQueries(['video', jobId]);
   ```

3. **Optimistic Updates**:
   For user actions with immediate feedback needs:

   ```typescript
   // When saving metadata
   queryClient.setQueryData(['video', jobId], (oldData) => {
     return {
       ...oldData,
       metadata: {
         ...oldData.metadata,
         title: newTitle
       }
     };
   });
   ```

## Error Handling

WebSocket-specific error handling should include:

1. **Connection Errors**:
   - Display connection status indicator
   - Attempt reconnection with backoff
   - Fall back to polling API if connection fails repeatedly

2. **Message Parsing Errors**:
   - Log invalid messages for debugging
   - Implement defensive parsing with fallbacks
   - Continue processing valid messages

3. **Authentication Errors**:
   - Redirect to login if authentication fails
   - Attempt to refresh token if expired
   - Provide clear feedback about connection status

================
File: .gitignore
================
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

================
File: biome.json
================
{
	"$schema": "https://biomejs.dev/schemas/1.9.4/schema.json",
	"vcs": {
		"enabled": false,
		"clientKind": "git",
		"useIgnoreFile": false
	},
	"files": {
		"ignoreUnknown": false,
		"ignore": []
	},
	"formatter": {
		"enabled": true,
		"indentStyle": "tab",
		"indentWidth": 2,
		"lineWidth": 80
	},
	"organizeImports": {
		"enabled": true
	},
	"linter": {
		"enabled": true,
		"rules": {
			"recommended": true,
			"a11y": {
				"useSemanticElements": "off"
			}
		}
	},
	"javascript": {
		"formatter": {
			"quoteStyle": "double",
			"trailingCommas": "all"
		}
	}
}

================
File: components.json
================
{
	"$schema": "https://ui.shadcn.com/schema.json",
	"style": "new-york",
	"rsc": false,
	"tsx": true,
	"tailwind": {
		"config": "tailwind.config.mjs",
		"css": "src/styles/app.css",
		"baseColor": "zinc",
		"cssVariables": true,
		"prefix": ""
	},
	"aliases": {
		"components": "@/components",
		"utils": "@/lib/utils",
		"ui": "@/components/ui",
		"lib": "@/lib",
		"hooks": "@/hooks"
	},
	"iconLibrary": "lucide"
}

================
File: Dockerfile
================
# Use Node.js as the base image
FROM node:20-slim

# Install pnpm
RUN npm install -g pnpm

# Set working directory
WORKDIR /app

# Copy package files
COPY package.json pnpm-lock.yaml ./

# Install dependencies
RUN pnpm install

# Copy the rest of the application
COPY . .

# Expose the default Vite port
EXPOSE 3000

# Command to run the development server
CMD ["pnpm", "dev", "--host", "0.0.0.0"]

================
File: firebase.ts
================
import { getApps, initializeApp } from "firebase/app";
import type { FirebaseApp } from "firebase/app";
import { type Firestore, getFirestore } from "firebase/firestore";

// Firebase configuration
const firebaseConfig = {
	apiKey: "AIzaSyAHQ-vpHkanz4zMdMBteX73vq63vWTP9iQ",
	authDomain: "automations-457120.firebaseapp.com",
	projectId: "automations-457120",
	storageBucket: "automations-457120.appspot.com",
	messagingSenderId: "598863037291",
	appId: "1:598863037291:web:bfb205598a28ef5312c22e",
};

let app: FirebaseApp;
if (!getApps().length) {
	app = initializeApp(firebaseConfig);
} else {
	app = getApps()[0];
}

const db: Firestore = getFirestore(app);

export { db };

================
File: package.json
================
{
	"name": "echo",
	"version": "1.0.0",
	"main": "index.js",
	"type": "module",
	"sideEffects": false,
	"scripts": {
		"test": "vitest run",
		"dev": "vinxi dev",
		"build": "vinxi build",
		"start": "vinxi start",
		"lint": "biome check --write --unsafe",
		"format": "biome format --write --unsafe",
		"check": "biome check --write"
	},
	"keywords": [],
	"author": "",
	"license": "ISC",
	"description": "",
	"dependencies": {
		"@hookform/resolvers": "^5.0.1",
		"@radix-ui/react-accordion": "^1.2.8",
		"@radix-ui/react-alert-dialog": "^1.1.11",
		"@radix-ui/react-aspect-ratio": "^1.1.4",
		"@radix-ui/react-avatar": "^1.1.7",
		"@radix-ui/react-checkbox": "^1.2.3",
		"@radix-ui/react-collapsible": "^1.1.8",
		"@radix-ui/react-context-menu": "^2.2.12",
		"@radix-ui/react-dialog": "^1.1.11",
		"@radix-ui/react-dropdown-menu": "^2.1.12",
		"@radix-ui/react-hover-card": "^1.1.11",
		"@radix-ui/react-label": "^2.1.2",
		"@radix-ui/react-menubar": "^1.1.12",
		"@radix-ui/react-navigation-menu": "^1.2.10",
		"@radix-ui/react-popover": "^1.1.11",
		"@radix-ui/react-progress": "^1.1.4",
		"@radix-ui/react-radio-group": "^1.3.4",
		"@radix-ui/react-scroll-area": "^1.2.6",
		"@radix-ui/react-select": "^2.1.6",
		"@radix-ui/react-separator": "^1.1.4",
		"@radix-ui/react-slider": "^1.2.3",
		"@radix-ui/react-slot": "^1.1.2",
		"@radix-ui/react-switch": "^1.1.3",
		"@radix-ui/react-tabs": "^1.1.8",
		"@radix-ui/react-toast": "^1.2.11",
		"@radix-ui/react-toggle": "^1.1.6",
		"@radix-ui/react-toggle-group": "^1.1.7",
		"@radix-ui/react-tooltip": "^1.2.4",
		"@supabase/ssr": "^0.5.2",
		"@supabase/supabase-js": "^2.48.1",
		"@tailwindcss/postcss": "^4.1.4",
		"@tailwindcss/vite": "^4.0.6",
		"@tanstack/react-form": "^1.0.0",
		"@tanstack/react-router": "^1.116.0",
		"@tanstack/react-router-devtools": "^1.116.0",
		"@tanstack/react-router-with-query": "^1.116.0",
		"@tanstack/react-table": "^8.21.3",
		"@tanstack/router-plugin": "^1.114.3",
		"boxen": "^8.0.1",
		"chalk": "^4.1.2",
		"class-variance-authority": "^0.7.1",
		"cli-table3": "^0.6.5",
		"clsx": "^2.1.1",
		"lucide-react": "^0.488.0",
		"cmdk": "^1.1.1",
		"commander": "^11.1.0",
		"cors": "^2.8.5",
		"date-fns": "^4.1.0",
		"dotenv": "^16.5.0",
		"embla-carousel-react": "^8.6.0",
		"express": "^4.21.2",
		"fastmcp": "^1.23.2",
		"figlet": "^1.8.1",
		"firebase": "^11.6.1",
		"fuse.js": "^7.1.0",
		"googleapis": "^148.0.0",
		"gradient-string": "^3.0.0",
		"helmet": "^8.1.0",
		"input-otp": "^1.4.2",
		"inquirer": "^12.6.0",
		"jsonwebtoken": "^9.0.2",
		"lru-cache": "^10.4.3",
		"next-themes": "^0.4.6",
		"openai": "^4.96.2",
		"ora": "^8.2.0",
		"react": "^19.1.0",
		"react-day-picker": "8.10.1",
		"react-dom": "^19.1.0",
		"react-hook-form": "^7.56.1",
		"react-resizable-panels": "^3.0.0",
		"recharts": "^2.15.3",
		"sonner": "^2.0.3",
		"tailwind-merge": "3.2.0",
		"tailwindcss-animate": "^1.0.7",
		"vaul": "^1.1.2",
		"vinxi": "^0.5.6",
		"zod": "^3.24.3"
	},
	"devDependencies": {
		"@biomejs/biome": "1.9.4",
		"@testing-library/dom": "^10.4.0",
		"@testing-library/react": "^16.3.0",
		"@types/node": "^22.5.4",
		"@types/react": "^19.0.8",
		"@types/react-dom": "^19.0.3",
		"@vitejs/plugin-react": "^4.4.1",
		"@vitest/ui": "^3.1.2",
		"autoprefixer": "^10.4.20",
		"jsdom": "^26.1.0",
		"postcss": "^8.5.3",
		"tailwindcss": "^4.1.4",
		"typescript": "^5.7.2",
		"vite-tsconfig-paths": "^5.1.4",
		"vitest": "^3.1.2",
		"web-vitals": "^4.2.4"
	},
	"overrides": {
		"react-is": "^19.0.0-rc-69d4b800-20241021"
	}
}

================
File: postcss.config.mjs
================
export default {
	plugins: {
	  "@tailwindcss/postcss": {},
	},
  };

================
File: README.md
================
# Frontend (Live-Tracking UI)

This directory contains the React (Vite) app for the live-tracking, metadata-rich UI for the Video Upload + AI Metadata Pipeline.

---

## UI Goals

- **Live dashboard:** Real-time status for each video as it moves through pipeline stages
- **Drag-and-drop upload:** Users can drag and drop videos to initiate processing
- **Editable metadata:** Inline editing for all YouTube metadata (title, description, tags, chapters, scheduled time, privacy, etc.)
- **Thumbnail gallery:** View, edit prompts, and regenerate thumbnails (10 per video, generated via Gemini + Imagen3 + Pillow)
- **Scheduling controls:** Set scheduled publish time for each video
- **Channel selection:** Choose which YouTube channel to upload to
- **Error/status display:** Show errors, warnings, and progress for each stage
- **No authentication required** for initial local use

---

## Tech Stack

- **React** (Vite)
- **TanStack Router** (`@tanstack/react-router`)
- **TanStack Query** (`@tanstack/react-query`)
- **Firebase JS SDK** (for direct Firestore integration, to be added)
- **TypeScript** (optional, recommended for future maintainability)

---

## Setup Instructions

1. **Install dependencies**
   ```bash
   cd frontend
   npm install
   ```

2. **Start the development server**
   ```bash
   npm run dev
   ```

3. **Open the app**
   - Visit [http://localhost:5173](http://localhost:5173) in your browser.

---

## Next Steps

- Scaffold the main dashboard and routes using TanStack Router
- Integrate Firestore for real-time data
- Build out UI components for video list, metadata editing, thumbnail gallery, and upload
- Connect UI actions to backend pipeline via Firestore triggers

---

================
File: tsconfig.json
================
{
	"include": [
		"**/*.ts",
		"**/*.tsx"
	],
	"compilerOptions": {
		"strict": true,
		"esModuleInterop": true,
		"jsx": "react-jsx",
		"module": "ESNext",
		"moduleResolution": "Bundler",
		"lib": [
			"DOM",
			"DOM.Iterable",
			"ES2022"
		],
		"isolatedModules": true,
		"resolveJsonModule": true,
		"skipLibCheck": true,
		"target": "ES2022",
		"allowJs": true,
		"forceConsistentCasingInFileNames": true,
		"baseUrl": "./src",
		"paths": {
			"@/*": [
				"./*"
			]
		},
		"noEmit": true
	}
}

================
File: vite.config.ts
================
// vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import { TanStackRouterVite } from '@tanstack/router-plugin/vite'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [
    // Please make sure that '@tanstack/router-plugin' is passed before '@vitejs/plugin-react'
    TanStackRouterVite({ target: 'react', autoCodeSplitting: true }),
    react(),
    // ...,
  ],
})

================
File: vitest.config.ts
================
import react from "@vitejs/plugin-react";
import { defineConfig } from "vitest/config";

export default defineConfig({
	plugins: [react()],
	test: {
		environment: "jsdom",
		globals: true,
		setupFiles: [],
		coverage: {
			reporter: ["text", "html"],
		},
		include: ["app/components/**/*.test.{ts,tsx}"],
	},
});
