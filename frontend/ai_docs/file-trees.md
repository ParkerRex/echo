# Frontend File Structure Comparison: Current vs. Proposed

This document compares the current frontend file structure with the proposed structure after refactoring to integrate Supabase authentication, FastAPI WebSockets, and removing legacy Firebase code and unused examples.

## Current Frontend Structure (Before Refactor)

```
frontend
├── app.config.ts
├── biome.json
├── components.json
├── Dockerfile
├── docs
│   ├── fe-prd.txt
│   └── overview.md
├── firebase.ts                     # <-- To be removed
├── package.json
├── pnpm-lock.yaml
├── postcss.config.mjs
├── public
│   ├── fonts
│   │   └── ... (font files)
│   └── vite.svg
├── README.md
├── src
│   ├── api.ts                      # <-- To be refactored (add JWT)
│   ├── client.tsx                  # (Entry point)
│   ├── components
│   │   ├── auth.tsx                # <-- To be refactored (Supabase)
│   │   ├── default-catch-boundary.tsx
│   │   ├── home
│   │   │   └── hero.tsx
│   │   ├── login.tsx               # <-- To be refactored (Supabase OAuth)
│   │   ├── not-found.tsx
│   │   ├── post-error.tsx          # <-- To be removed (example)
│   │   ├── shared
│   │   │   ├── container.tsx
│   │   │   └── navbar.tsx          # <-- Needs logout integration
│   │   ├── ui
│   │   │   ├── ... (shadcn components)
│   │   │   └── dropzone.tsx        # <-- To be adapted (GCS Upload)
│   │   ├── user-error.tsx          # <-- To be removed (example)
│   │   └── video                   # (Core video components)
│   │       ├── content-editor.tsx  # <-- To be adapted (Metadata save)
│   │       ├── processing-dashboard.tsx # <-- Needs WebSocket integration
│   │       ├── processing-steps.ts # <-- Needs backend alignment
│   │       ├── thumbnail-gallery.tsx # <-- To be adapted/implemented
│   │       ├── title-selector.tsx  # <-- Likely merged/adapted
│   │       ├── video-detail.tsx    # <-- Needs WebSocket integration
│   │       └── video-progress-card.tsx # <-- Needs WebSocket integration
│   ├── global-middleware.ts      # <-- Review usage
│   ├── hooks
│   │   ├── use-mobile.ts
│   │   └── useMutation.ts        # <-- Review/adapt for TanStack Query/API client
│   ├── lib
│   │   └── utils.ts              # (General utils)
│   ├── router.tsx                # (TanStack Router setup)
│   ├── routes
│   │   ├── __root.tsx            # <-- Potentially add global auth listener
│   │   ├── _authed               # <-- Folder likely removed/refactored
│   │   │   ├── posts.$postId.tsx # <-- To be removed (example)
│   │   │   ├── posts.index.tsx   # <-- To be removed (example)
│   │   │   └── posts.tsx         # <-- To be removed (example)
│   │   ├── _authed.tsx           # <-- Needs Supabase session check
│   │   ├── _pathlessLayout       # <-- Review usage/remove if unused examples
│   │   │   └── ...
│   │   ├── api                   # <-- Folder likely removed (backend API exists)
│   │   │   ├── users.$id.ts      # <-- To be removed (example)
│   │   │   └── users.ts          # <-- To be removed (example)
│   │   ├── dashboard.tsx         # <-- Needs refactoring (API Fetch + WebSocket)
│   │   ├── deferred.tsx          # <-- Review usage
│   │   ├── index.tsx             # (Home page)
│   │   ├── login.tsx             # <-- Needs refactoring (Supabase OAuth)
│   │   ├── logout.tsx            # <-- Needs Supabase signout
│   │   ├── posts.$postId.tsx     # <-- To be moved to examples
│   │   ├── posts.index.tsx       # <-- To be moved to examples
│   │   ├── posts.route.tsx       # <-- To be moved to examples
│   │   ├── posts_.$postId.deep.tsx # <-- To be moved to examples
│   │   ├── redirect.tsx          # <-- Review usage
│   │   ├── settings.tsx          # <-- Needs refactoring if user settings exist
│   │   ├── signup.tsx            # <-- Needs refactoring/removal (Using Google OAuth)
│   │   ├── users.$userId.tsx     # <-- To be moved to examples
│   │   ├── users.index.tsx       # <-- To be moved to examples
│   │   ├── users.route.tsx       # <-- Needs removal (example)
│   │   └── video.$videoId.tsx    # <-- Needs refactoring (API Fetch + WebSocket)
│   ├── routeTree.gen.ts          # (Auto-generated by TanStack Router)
│   ├── services
│   │   └── gcs-content.ts        # <-- Likely removed (Backend handles GCS directly)
│   ├── ssr.tsx                   # (Server-side rendering entry)
│   ├── styles
│   │   └── app.css
│   └── utils
│       ├── loggingMiddleware.ts  # <-- Review usage
│       ├── posts.tsx             # <-- To be removed (example)
│       ├── seo.ts
│       ├── supabase.ts           # <-- Likely removed (Use db/supabase/clients)
│       └── users.tsx             # <-- To be removed (example)
├── tsconfig.json
└── vitest.config.ts
```

## Proposed Frontend Structure (Post Refactor)

This structure reflects the integration with Supabase/FastAPI, removal of Firebase, and cleanup of examples.

```
frontend
├── app.config.ts
├── biome.json
├── components.json
├── Dockerfile
├── docs                          # <-- Contains examples now
│   ├── examples                  # <-- Moved example files here
│   │   ├── posts.$postId.deep.tsx
│   │   ├── posts.$postId.tsx
│   │   ├── posts.index.tsx
│   │   ├── posts.route.tsx
│   │   ├── users.$userId.tsx
│   │   └── users.index.tsx
│   ├── fe-prd.txt                # (PRD - This file)
│   ├── file-structure-comparison.md # (This file)
│   ├── implementation-tasks-frontend.md # (New tasks doc)
│   └── overview.md
├── package.json                  # <-- Firebase removed from deps
├── pnpm-lock.yaml
├── postcss.config.mjs
├── public
│   ├── fonts
│   │   └── ... (font files)
│   └── vite.svg
├── README.md
├── src
│   ├── api.ts                    # <-- Refactored (Handles JWT)
│   ├── client.tsx
│   ├── components
│   │   ├── auth                  # <-- New or refactored auth components
│   │   │   └── GoogleLoginButton.tsx # (Example)
│   │   ├── default-catch-boundary.tsx
│   │   ├── home
│   │   │   └── hero.tsx
│   │   ├── shared
│   │   │   ├── container.tsx
│   │   │   └── navbar.tsx        # <-- Updated with Supabase logout
│   │   ├── ui
│   │   │   ├── ... (shadcn components)
│   │   │   └── dropzone.tsx      # <-- Adapted for GCS Signed URL Upload
│   │   └── video
│   │       ├── content-editor.tsx # <-- Adapted for API Save
│   │       ├── processing-dashboard.tsx # <-- Uses API + WebSocket
│   │       ├── thumbnail-gallery.tsx # <-- Displays generated thumbs
│   │       ├── video-detail.tsx    # <-- Uses API + WebSocket
│   │       └── video-progress-card.tsx # <-- Uses API + WebSocket
│   ├── hooks
│   │   ├── use-app-websocket.ts  # <-- New: Manages WebSocket connection
│   │   └── use-mobile.ts
│   ├── lib
│   │   └── utils.ts
│   ├── router.tsx                # (TanStack Router setup)
│   ├── routes
│   │   ├── __root.tsx            # <-- Includes Supabase auth listener
│   │   ├── _authenticated.tsx    # <-- New/Refactored guard using Supabase session
│   │   ├── dashboard.tsx         # <-- Uses API + WebSocket
│   │   ├── index.tsx             # (Home page)
│   │   ├── login.tsx             # <-- Simplified for OAuth trigger
│   │   └── video.$videoId.tsx    # <-- Uses API + WebSocket
│   ├── routeTree.gen.ts          # (Auto-generated)
│   ├── styles
│   │   └── app.css
│   └── utils
│       └── seo.ts
├── tsconfig.json
└── vitest.config.ts

# Note: Also depends on ../db/supabase/clients/client.ts for Supabase interaction
```

## Key Changes and Benefits

1.  **Authentication Shift:** Firebase Auth (`firebase.ts`, `utils/supabase.ts`?) is replaced by Supabase Auth (`db/supabase/clients/client.ts`). Authentication components (`auth.tsx`, `login.tsx`) and route guards (`_authed.tsx`) are refactored.
    *   *Benefit:* Centralized authentication using Supabase, leveraging its Google OAuth integration.
2.  **Real-time Shift:** Firebase listeners are replaced by a dedicated WebSocket hook (`hooks/use-app-websocket.ts`) connecting to the FastAPI backend. Components (`processing-dashboard.tsx`, `video-detail.tsx`) are updated to consume WebSocket data via state management (TanStack Query).
    *   *Benefit:* Direct real-time communication with the application backend, removing third-party dependency for this core feature.
3.  **API Client Enhancement:** The API client (`api.ts`) is updated to handle Supabase JWT authentication for communicating with the FastAPI backend.
    *   *Benefit:* Secure communication with the backend API.
4.  **Upload Mechanism Change:** Uploads now target GCS via signed URLs obtained from the backend, adapting components like `dropzone.tsx`.
    *   *Benefit:* Scalable direct-to-cloud storage uploads, reducing load on the backend application server.
5.  **Example Code Removal:** Unused routes and components related to 'posts' and 'users' are removed from the main `src` directory, cleaning up the codebase. Relevant examples are archived in `docs/docs-frontend/examples`.
    *   *Benefit:* Reduced codebase size and complexity, focusing only on video processing functionality.
6.  **Dependency Cleanup:** Firebase SDK is removed from `package.json`.
    *   *Benefit:* Fewer dependencies, smaller bundle size, simplified build process.
7.  **Clearer Data Flow:** Frontend primarily interacts with the backend API for data, which abstracts the underlying Supabase DB and GCS storage details. Direct Supabase client usage is mainly for authentication.
    *   *Benefit:* Better separation of concerns, frontend is less coupled to specific backend storage implementations.
