# Product Requirements Document (PRD): Video Upload Flow & Channel Selection Overhaul

## Core Features Implementation

### 1. Authentication Migration
* Location: Move upload authentication to Dashboard
* Implementation:
    - Utilize Firebase authentication (frontend/firebase/)
    - Display upload controls only to authenticated users
    - Implement sign-in prompt for unauthenticated users

### 2. Channel Selection
* Feature: Add channel selection to upload flow
* Technical Details:
    - Data Source: Firestore (users/{uid}/channels)
    - Selection Logic:
        → Multiple channels: Display selection list
        → Single channel: Auto-select
    - Requirements: 
        → Channel selection mandatory for upload
        → Include channel_id in upload request

### 3. Backend Updates
* Endpoint Modifications:
    - Accept channel_id field (multipart/form-data or JSON)
    - Map channel_id to GCS prefix (daily-raw, main-raw)
    - Implement validation for channel_id

## Testing & Validation

### Local Integration Testing
1. Environment Setup
     - Run full stack locally (docker-compose up)
     
2. Test Flow
     - User authentication
     - Video upload via dashboard
     - Channel selection process
     - GCS prefix verification
     - Pipeline trigger confirmation
     - Dashboard status updates

3. Success Criteria
     - Complete flow works for all user types
     - Correct file handling and storage
     - Proper status tracking

## Outstanding Questions
1. User Experience
     - Channel selection persistence
     - Error handling approach
     - Upload metadata requirements

2. Marketing & Analytics
     - Demo/walkthrough needs
     - Upload tracking requirements
     - Channel selection analytics

## Implementation Sequence
1. Frontend routing cleanup
2. Marketing page updates
3. Authentication migration
4. Channel selection implementation
5. Backend updates
6. Integration testing
7. Documentation updates

## Project Success Metrics
✓ Legacy upload route removed
✓ Public marketing page implemented
✓ Authentication working
✓ Channel selection functional
✓ Correct GCS routing
✓ Documentation complete
